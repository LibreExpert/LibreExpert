var t1=Object.defineProperty;var n1=(r,e,t)=>e in r?t1(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Sr=(r,e,t)=>n1(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function Ya(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ff={exports:{}},ao={},Uf={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tv;function r1(){if(Tv)return Te;Tv=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.iterator;function g(O){return O===null||typeof O!="object"?null:(O=y&&O[y]||O["@@iterator"],typeof O=="function"?O:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,S={};function b(O,$,J){this.props=O,this.context=$,this.refs=S,this.updater=J||w}b.prototype.isReactComponent={},b.prototype.setState=function(O,$){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,$,"setState")},b.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function k(){}k.prototype=b.prototype;function E(O,$,J){this.props=O,this.context=$,this.refs=S,this.updater=J||w}var P=E.prototype=new k;P.constructor=E,_(P,b.prototype),P.isPureReactComponent=!0;var N=Array.isArray,j=Object.prototype.hasOwnProperty,D={current:null},z={key:!0,ref:!0,__self:!0,__source:!0};function q(O,$,J){var re,ie={},xe=null,ve=null;if($!=null)for(re in $.ref!==void 0&&(ve=$.ref),$.key!==void 0&&(xe=""+$.key),$)j.call($,re)&&!z.hasOwnProperty(re)&&(ie[re]=$[re]);var Ie=arguments.length-2;if(Ie===1)ie.children=J;else if(1<Ie){for(var Le=Array(Ie),nt=0;nt<Ie;nt++)Le[nt]=arguments[nt+2];ie.children=Le}if(O&&O.defaultProps)for(re in Ie=O.defaultProps,Ie)ie[re]===void 0&&(ie[re]=Ie[re]);return{$$typeof:r,type:O,key:xe,ref:ve,props:ie,_owner:D.current}}function K(O,$){return{$$typeof:r,type:O.type,key:$,ref:O.ref,props:O.props,_owner:O._owner}}function oe(O){return typeof O=="object"&&O!==null&&O.$$typeof===r}function he(O){var $={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(J){return $[J]})}var me=/\/+/g;function Ue(O,$){return typeof O=="object"&&O!==null&&O.key!=null?he(""+O.key):$.toString(36)}function Y(O,$,J,re,ie){var xe=typeof O;(xe==="undefined"||xe==="boolean")&&(O=null);var ve=!1;if(O===null)ve=!0;else switch(xe){case"string":case"number":ve=!0;break;case"object":switch(O.$$typeof){case r:case e:ve=!0}}if(ve)return ve=O,ie=ie(ve),O=re===""?"."+Ue(ve,0):re,N(ie)?(J="",O!=null&&(J=O.replace(me,"$&/")+"/"),Y(ie,$,J,"",function(nt){return nt})):ie!=null&&(oe(ie)&&(ie=K(ie,J+(!ie.key||ve&&ve.key===ie.key?"":(""+ie.key).replace(me,"$&/")+"/")+O)),$.push(ie)),1;if(ve=0,re=re===""?".":re+":",N(O))for(var Ie=0;Ie<O.length;Ie++){xe=O[Ie];var Le=re+Ue(xe,Ie);ve+=Y(xe,$,J,Le,ie)}else if(Le=g(O),typeof Le=="function")for(O=Le.call(O),Ie=0;!(xe=O.next()).done;)xe=xe.value,Le=re+Ue(xe,Ie++),ve+=Y(xe,$,J,Le,ie);else if(xe==="object")throw $=String(O),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return ve}function G(O,$,J){if(O==null)return O;var re=[],ie=0;return Y(O,re,"","",function(xe){return $.call(J,xe,ie++)}),re}function ne(O){if(O._status===-1){var $=O._result;$=$(),$.then(function(J){(O._status===0||O._status===-1)&&(O._status=1,O._result=J)},function(J){(O._status===0||O._status===-1)&&(O._status=2,O._result=J)}),O._status===-1&&(O._status=0,O._result=$)}if(O._status===1)return O._result.default;throw O._result}var Q={current:null},B={transition:null},F={ReactCurrentDispatcher:Q,ReactCurrentBatchConfig:B,ReactCurrentOwner:D};function V(){throw Error("act(...) is not supported in production builds of React.")}return Te.Children={map:G,forEach:function(O,$,J){G(O,function(){$.apply(this,arguments)},J)},count:function(O){var $=0;return G(O,function(){$++}),$},toArray:function(O){return G(O,function($){return $})||[]},only:function(O){if(!oe(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},Te.Component=b,Te.Fragment=t,Te.Profiler=a,Te.PureComponent=E,Te.StrictMode=n,Te.Suspense=d,Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,Te.act=V,Te.cloneElement=function(O,$,J){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var re=_({},O.props),ie=O.key,xe=O.ref,ve=O._owner;if($!=null){if($.ref!==void 0&&(xe=$.ref,ve=D.current),$.key!==void 0&&(ie=""+$.key),O.type&&O.type.defaultProps)var Ie=O.type.defaultProps;for(Le in $)j.call($,Le)&&!z.hasOwnProperty(Le)&&(re[Le]=$[Le]===void 0&&Ie!==void 0?Ie[Le]:$[Le])}var Le=arguments.length-2;if(Le===1)re.children=J;else if(1<Le){Ie=Array(Le);for(var nt=0;nt<Le;nt++)Ie[nt]=arguments[nt+2];re.children=Ie}return{$$typeof:r,type:O.type,key:ie,ref:xe,props:re,_owner:ve}},Te.createContext=function(O){return O={$$typeof:l,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:o,_context:O},O.Consumer=O},Te.createElement=q,Te.createFactory=function(O){var $=q.bind(null,O);return $.type=O,$},Te.createRef=function(){return{current:null}},Te.forwardRef=function(O){return{$$typeof:c,render:O}},Te.isValidElement=oe,Te.lazy=function(O){return{$$typeof:p,_payload:{_status:-1,_result:O},_init:ne}},Te.memo=function(O,$){return{$$typeof:f,type:O,compare:$===void 0?null:$}},Te.startTransition=function(O){var $=B.transition;B.transition={};try{O()}finally{B.transition=$}},Te.unstable_act=V,Te.useCallback=function(O,$){return Q.current.useCallback(O,$)},Te.useContext=function(O){return Q.current.useContext(O)},Te.useDebugValue=function(){},Te.useDeferredValue=function(O){return Q.current.useDeferredValue(O)},Te.useEffect=function(O,$){return Q.current.useEffect(O,$)},Te.useId=function(){return Q.current.useId()},Te.useImperativeHandle=function(O,$,J){return Q.current.useImperativeHandle(O,$,J)},Te.useInsertionEffect=function(O,$){return Q.current.useInsertionEffect(O,$)},Te.useLayoutEffect=function(O,$){return Q.current.useLayoutEffect(O,$)},Te.useMemo=function(O,$){return Q.current.useMemo(O,$)},Te.useReducer=function(O,$,J){return Q.current.useReducer(O,$,J)},Te.useRef=function(O){return Q.current.useRef(O)},Te.useState=function(O){return Q.current.useState(O)},Te.useSyncExternalStore=function(O,$,J){return Q.current.useSyncExternalStore(O,$,J)},Te.useTransition=function(){return Q.current.useTransition()},Te.version="18.3.1",Te}var Av;function em(){return Av||(Av=1,Uf.exports=r1()),Uf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iv;function a1(){if(Iv)return ao;Iv=1;var r=em(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,d,f){var p,y={},g=null,w=null;f!==void 0&&(g=""+f),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(w=d.ref);for(p in d)n.call(d,p)&&!o.hasOwnProperty(p)&&(y[p]=d[p]);if(c&&c.defaultProps)for(p in d=c.defaultProps,d)y[p]===void 0&&(y[p]=d[p]);return{$$typeof:e,type:c,key:g,ref:w,props:y,_owner:a.current}}return ao.Fragment=t,ao.jsx=l,ao.jsxs=l,ao}var Nv;function s1(){return Nv||(Nv=1,Ff.exports=a1()),Ff.exports}var I=s1(),R=em();const ae=Ya(R);var Ru={},zf={exports:{}},Xt={},Bf={exports:{}},Hf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $v;function i1(){return $v||($v=1,function(r){function e(B,F){var V=B.length;B.push(F);e:for(;0<V;){var O=V-1>>>1,$=B[O];if(0<a($,F))B[O]=F,B[V]=$,V=O;else break e}}function t(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var F=B[0],V=B.pop();if(V!==F){B[0]=V;e:for(var O=0,$=B.length,J=$>>>1;O<J;){var re=2*(O+1)-1,ie=B[re],xe=re+1,ve=B[xe];if(0>a(ie,V))xe<$&&0>a(ve,ie)?(B[O]=ve,B[xe]=V,O=xe):(B[O]=ie,B[re]=V,O=re);else if(xe<$&&0>a(ve,V))B[O]=ve,B[xe]=V,O=xe;else break e}}return F}function a(B,F){var V=B.sortIndex-F.sortIndex;return V!==0?V:B.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();r.unstable_now=function(){return l.now()-c}}var d=[],f=[],p=1,y=null,g=3,w=!1,_=!1,S=!1,b=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(B){for(var F=t(f);F!==null;){if(F.callback===null)n(f);else if(F.startTime<=B)n(f),F.sortIndex=F.expirationTime,e(d,F);else break;F=t(f)}}function N(B){if(S=!1,P(B),!_)if(t(d)!==null)_=!0,ne(j);else{var F=t(f);F!==null&&Q(N,F.startTime-B)}}function j(B,F){_=!1,S&&(S=!1,k(q),q=-1),w=!0;var V=g;try{for(P(F),y=t(d);y!==null&&(!(y.expirationTime>F)||B&&!he());){var O=y.callback;if(typeof O=="function"){y.callback=null,g=y.priorityLevel;var $=O(y.expirationTime<=F);F=r.unstable_now(),typeof $=="function"?y.callback=$:y===t(d)&&n(d),P(F)}else n(d);y=t(d)}if(y!==null)var J=!0;else{var re=t(f);re!==null&&Q(N,re.startTime-F),J=!1}return J}finally{y=null,g=V,w=!1}}var D=!1,z=null,q=-1,K=5,oe=-1;function he(){return!(r.unstable_now()-oe<K)}function me(){if(z!==null){var B=r.unstable_now();oe=B;var F=!0;try{F=z(!0,B)}finally{F?Ue():(D=!1,z=null)}}else D=!1}var Ue;if(typeof E=="function")Ue=function(){E(me)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,G=Y.port2;Y.port1.onmessage=me,Ue=function(){G.postMessage(null)}}else Ue=function(){b(me,0)};function ne(B){z=B,D||(D=!0,Ue())}function Q(B,F){q=b(function(){B(r.unstable_now())},F)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(B){B.callback=null},r.unstable_continueExecution=function(){_||w||(_=!0,ne(j))},r.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<B?Math.floor(1e3/B):5},r.unstable_getCurrentPriorityLevel=function(){return g},r.unstable_getFirstCallbackNode=function(){return t(d)},r.unstable_next=function(B){switch(g){case 1:case 2:case 3:var F=3;break;default:F=g}var V=g;g=F;try{return B()}finally{g=V}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(B,F){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var V=g;g=B;try{return F()}finally{g=V}},r.unstable_scheduleCallback=function(B,F,V){var O=r.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?O+V:O):V=O,B){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=V+$,B={id:p++,callback:F,priorityLevel:B,startTime:V,expirationTime:$,sortIndex:-1},V>O?(B.sortIndex=V,e(f,B),t(d)===null&&B===t(f)&&(S?(k(q),q=-1):S=!0,Q(N,V-O))):(B.sortIndex=$,e(d,B),_||w||(_=!0,ne(j))),B},r.unstable_shouldYield=he,r.unstable_wrapCallback=function(B){var F=g;return function(){var V=g;g=F;try{return B.apply(this,arguments)}finally{g=V}}}}(Hf)),Hf}var jv;function o1(){return jv||(jv=1,Bf.exports=i1()),Bf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lv;function l1(){if(Lv)return Xt;Lv=1;var r=em(),e=o1();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function o(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(a[s]=i,s=0;s<i.length;s++)n.add(i[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},y={};function g(s){return d.call(y,s)?!0:d.call(p,s)?!1:f.test(s)?y[s]=!0:(p[s]=!0,!1)}function w(s,i,u,h){if(u!==null&&u.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function _(s,i,u,h){if(i===null||typeof i>"u"||w(s,i,u,h))return!0;if(h)return!1;if(u!==null)switch(u.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function S(s,i,u,h,m,v,x){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=m,this.mustUseProperty=u,this.propertyName=s,this.type=i,this.sanitizeURL=v,this.removeEmptyString=x}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){b[s]=new S(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];b[i]=new S(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){b[s]=new S(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){b[s]=new S(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){b[s]=new S(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){b[s]=new S(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){b[s]=new S(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){b[s]=new S(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){b[s]=new S(s,5,!1,s.toLowerCase(),null,!1,!1)});var k=/[\-:]([a-z])/g;function E(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(k,E);b[i]=new S(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(k,E);b[i]=new S(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(k,E);b[i]=new S(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){b[s]=new S(s,1,!1,s.toLowerCase(),null,!1,!1)}),b.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){b[s]=new S(s,1,!1,s.toLowerCase(),null,!0,!0)});function P(s,i,u,h){var m=b.hasOwnProperty(i)?b[i]:null;(m!==null?m.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(_(i,u,m,h)&&(u=null),h||m===null?g(i)&&(u===null?s.removeAttribute(i):s.setAttribute(i,""+u)):m.mustUseProperty?s[m.propertyName]=u===null?m.type===3?!1:"":u:(i=m.attributeName,h=m.attributeNamespace,u===null?s.removeAttribute(i):(m=m.type,u=m===3||m===4&&u===!0?"":""+u,h?s.setAttributeNS(h,i,u):s.setAttribute(i,u))))}var N=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),D=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),oe=Symbol.for("react.provider"),he=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),Ue=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),ne=Symbol.for("react.lazy"),Q=Symbol.for("react.offscreen"),B=Symbol.iterator;function F(s){return s===null||typeof s!="object"?null:(s=B&&s[B]||s["@@iterator"],typeof s=="function"?s:null)}var V=Object.assign,O;function $(s){if(O===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);O=i&&i[1]||""}return`
`+O+s}var J=!1;function re(s,i){if(!s||J)return"";J=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(U){var h=U}Reflect.construct(s,[],i)}else{try{i.call()}catch(U){h=U}s.call(i.prototype)}else{try{throw Error()}catch(U){h=U}s()}}catch(U){if(U&&h&&typeof U.stack=="string"){for(var m=U.stack.split(`
`),v=h.stack.split(`
`),x=m.length-1,C=v.length-1;1<=x&&0<=C&&m[x]!==v[C];)C--;for(;1<=x&&0<=C;x--,C--)if(m[x]!==v[C]){if(x!==1||C!==1)do if(x--,C--,0>C||m[x]!==v[C]){var T=`
`+m[x].replace(" at new "," at ");return s.displayName&&T.includes("<anonymous>")&&(T=T.replace("<anonymous>",s.displayName)),T}while(1<=x&&0<=C);break}}}finally{J=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?$(s):""}function ie(s){switch(s.tag){case 5:return $(s.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return s=re(s.type,!1),s;case 11:return s=re(s.type.render,!1),s;case 1:return s=re(s.type,!0),s;default:return""}}function xe(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case z:return"Fragment";case D:return"Portal";case K:return"Profiler";case q:return"StrictMode";case Ue:return"Suspense";case Y:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case he:return(s.displayName||"Context")+".Consumer";case oe:return(s._context.displayName||"Context")+".Provider";case me:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case G:return i=s.displayName||null,i!==null?i:xe(s.type)||"Memo";case ne:i=s._payload,s=s._init;try{return xe(s(i))}catch{}}return null}function ve(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xe(i);case 8:return i===q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Ie(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Le(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function nt(s){var i=Le(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),h=""+s[i];if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var m=u.get,v=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return m.call(this)},set:function(x){h=""+x,v.call(this,x)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return h},setValue:function(x){h=""+x},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function yn(s){s._valueTracker||(s._valueTracker=nt(s))}function hl(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var u=i.getValue(),h="";return s&&(h=Le(s)?s.checked?"true":"false":s.value),s=h,s!==u?(i.setValue(s),!0):!1}function Sa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function vi(s,i){var u=i.checked;return V({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function as(s,i){var u=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;u=Ie(i.value!=null?i.value:u),s._wrapperState={initialChecked:h,initialValue:u,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function pl(s,i){i=i.checked,i!=null&&P(s,"checked",i,!1)}function ss(s,i){pl(s,i);var u=Ie(i.value),h=i.type;if(u!=null)h==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(h==="submit"||h==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?is(s,i.type,u):i.hasOwnProperty("defaultValue")&&is(s,i.type,Ie(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function Ea(s,i,u){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,u||i===s.value||(s.value=i),s.defaultValue=i}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function is(s,i,u){(i!=="number"||Sa(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var tn=Array.isArray;function Mr(s,i,u,h){if(s=s.options,i){i={};for(var m=0;m<u.length;m++)i["$"+u[m]]=!0;for(u=0;u<s.length;u++)m=i.hasOwnProperty("$"+s[u].value),s[u].selected!==m&&(s[u].selected=m),m&&h&&(s[u].defaultSelected=!0)}else{for(u=""+Ie(u),i=null,m=0;m<s.length;m++){if(s[m].value===u){s[m].selected=!0,h&&(s[m].defaultSelected=!0);return}i!==null||s[m].disabled||(i=s[m])}i!==null&&(i.selected=!0)}}function wi(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return V({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Mt(s,i){var u=i.value;if(u==null){if(u=i.children,i=i.defaultValue,u!=null){if(i!=null)throw Error(t(92));if(tn(u)){if(1<u.length)throw Error(t(93));u=u[0]}i=u}i==null&&(i=""),u=i}s._wrapperState={initialValue:Ie(u)}}function pr(s,i){var u=Ie(i.value),h=Ie(i.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),i.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),h!=null&&(s.defaultValue=""+h)}function ml(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function gl(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dr(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?gl(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var os,ls=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,u,h,m){MSApp.execUnsafeLocalFunction(function(){return s(i,u,h,m)})}:s}(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(os=os||document.createElement("div"),os.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=os.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function vn(s,i){if(i){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=i;return}}s.textContent=i}var Fr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},us=["Webkit","ms","Moz","O"];Object.keys(Fr).forEach(function(s){us.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),Fr[i]=Fr[s]})});function yl(s,i,u){return i==null||typeof i=="boolean"||i===""?"":u||typeof i!="number"||i===0||Fr.hasOwnProperty(s)&&Fr[s]?(""+i).trim():i+"px"}function vl(s,i){s=s.style;for(var u in i)if(i.hasOwnProperty(u)){var h=u.indexOf("--")===0,m=yl(u,i[u],h);u==="float"&&(u="cssFloat"),h?s.setProperty(u,m):s[u]=m}}var wl=V({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cs(s,i){if(i){if(wl[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function _i(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ka=null;function wn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var bi=null,Se=null,je=null;function Ke(s){if(s=Hi(s)){if(typeof bi!="function")throw Error(t(280));var i=s.stateNode;i&&(i=Hl(i),bi(s.stateNode,s.type,i))}}function qt(s){Se?je?je.push(s):je=[s]:Se=s}function nn(){if(Se){var s=Se,i=je;if(je=Se=null,Ke(s),i)for(s=0;s<i.length;s++)Ke(i[s])}}function ds(s,i){return s(i)}function _l(){}var td=!1;function Qm(s,i,u){if(td)return s(i,u);td=!0;try{return ds(s,i,u)}finally{td=!1,(Se!==null||je!==null)&&(_l(),nn())}}function xi(s,i){var u=s.stateNode;if(u===null)return null;var h=Hl(u);if(h===null)return null;u=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(t(231,i,typeof u));return u}var nd=!1;if(c)try{var Si={};Object.defineProperty(Si,"passive",{get:function(){nd=!0}}),window.addEventListener("test",Si,Si),window.removeEventListener("test",Si,Si)}catch{nd=!1}function oS(s,i,u,h,m,v,x,C,T){var U=Array.prototype.slice.call(arguments,3);try{i.apply(u,U)}catch(Z){this.onError(Z)}}var Ei=!1,bl=null,xl=!1,rd=null,lS={onError:function(s){Ei=!0,bl=s}};function uS(s,i,u,h,m,v,x,C,T){Ei=!1,bl=null,oS.apply(lS,arguments)}function cS(s,i,u,h,m,v,x,C,T){if(uS.apply(this,arguments),Ei){if(Ei){var U=bl;Ei=!1,bl=null}else throw Error(t(198));xl||(xl=!0,rd=U)}}function Ca(s){var i=s,u=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,i.flags&4098&&(u=i.return),s=i.return;while(s)}return i.tag===3?u:null}function Ym(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function eg(s){if(Ca(s)!==s)throw Error(t(188))}function dS(s){var i=s.alternate;if(!i){if(i=Ca(s),i===null)throw Error(t(188));return i!==s?null:s}for(var u=s,h=i;;){var m=u.return;if(m===null)break;var v=m.alternate;if(v===null){if(h=m.return,h!==null){u=h;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===u)return eg(m),s;if(v===h)return eg(m),i;v=v.sibling}throw Error(t(188))}if(u.return!==h.return)u=m,h=v;else{for(var x=!1,C=m.child;C;){if(C===u){x=!0,u=m,h=v;break}if(C===h){x=!0,h=m,u=v;break}C=C.sibling}if(!x){for(C=v.child;C;){if(C===u){x=!0,u=v,h=m;break}if(C===h){x=!0,h=v,u=m;break}C=C.sibling}if(!x)throw Error(t(189))}}if(u.alternate!==h)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?s:i}function tg(s){return s=dS(s),s!==null?ng(s):null}function ng(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=ng(s);if(i!==null)return i;s=s.sibling}return null}var rg=e.unstable_scheduleCallback,ag=e.unstable_cancelCallback,fS=e.unstable_shouldYield,hS=e.unstable_requestPaint,ut=e.unstable_now,pS=e.unstable_getCurrentPriorityLevel,ad=e.unstable_ImmediatePriority,sg=e.unstable_UserBlockingPriority,Sl=e.unstable_NormalPriority,mS=e.unstable_LowPriority,ig=e.unstable_IdlePriority,El=null,Yn=null;function gS(s){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(El,s,void 0,(s.current.flags&128)===128)}catch{}}var On=Math.clz32?Math.clz32:wS,yS=Math.log,vS=Math.LN2;function wS(s){return s>>>=0,s===0?32:31-(yS(s)/vS|0)|0}var kl=64,Cl=4194304;function ki(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Pl(s,i){var u=s.pendingLanes;if(u===0)return 0;var h=0,m=s.suspendedLanes,v=s.pingedLanes,x=u&268435455;if(x!==0){var C=x&~m;C!==0?h=ki(C):(v&=x,v!==0&&(h=ki(v)))}else x=u&~m,x!==0?h=ki(x):v!==0&&(h=ki(v));if(h===0)return 0;if(i!==0&&i!==h&&!(i&m)&&(m=h&-h,v=i&-i,m>=v||m===16&&(v&4194240)!==0))return i;if(h&4&&(h|=u&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=h;0<i;)u=31-On(i),m=1<<u,h|=s[u],i&=~m;return h}function _S(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bS(s,i){for(var u=s.suspendedLanes,h=s.pingedLanes,m=s.expirationTimes,v=s.pendingLanes;0<v;){var x=31-On(v),C=1<<x,T=m[x];T===-1?(!(C&u)||C&h)&&(m[x]=_S(C,i)):T<=i&&(s.expiredLanes|=C),v&=~C}}function sd(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function og(){var s=kl;return kl<<=1,!(kl&4194240)&&(kl=64),s}function id(s){for(var i=[],u=0;31>u;u++)i.push(s);return i}function Ci(s,i,u){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-On(i),s[i]=u}function xS(s,i){var u=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var h=s.eventTimes;for(s=s.expirationTimes;0<u;){var m=31-On(u),v=1<<m;i[m]=0,h[m]=-1,s[m]=-1,u&=~v}}function od(s,i){var u=s.entangledLanes|=i;for(s=s.entanglements;u;){var h=31-On(u),m=1<<h;m&i|s[h]&i&&(s[h]|=i),u&=~m}}var qe=0;function lg(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var ug,ld,cg,dg,fg,ud=!1,Rl=[],Ur=null,zr=null,Br=null,Pi=new Map,Ri=new Map,Hr=[],SS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hg(s,i){switch(s){case"focusin":case"focusout":Ur=null;break;case"dragenter":case"dragleave":zr=null;break;case"mouseover":case"mouseout":Br=null;break;case"pointerover":case"pointerout":Pi.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ri.delete(i.pointerId)}}function Oi(s,i,u,h,m,v){return s===null||s.nativeEvent!==v?(s={blockedOn:i,domEventName:u,eventSystemFlags:h,nativeEvent:v,targetContainers:[m]},i!==null&&(i=Hi(i),i!==null&&ld(i)),s):(s.eventSystemFlags|=h,i=s.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),s)}function ES(s,i,u,h,m){switch(i){case"focusin":return Ur=Oi(Ur,s,i,u,h,m),!0;case"dragenter":return zr=Oi(zr,s,i,u,h,m),!0;case"mouseover":return Br=Oi(Br,s,i,u,h,m),!0;case"pointerover":var v=m.pointerId;return Pi.set(v,Oi(Pi.get(v)||null,s,i,u,h,m)),!0;case"gotpointercapture":return v=m.pointerId,Ri.set(v,Oi(Ri.get(v)||null,s,i,u,h,m)),!0}return!1}function pg(s){var i=Pa(s.target);if(i!==null){var u=Ca(i);if(u!==null){if(i=u.tag,i===13){if(i=Ym(u),i!==null){s.blockedOn=i,fg(s.priority,function(){cg(u)});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ol(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var u=dd(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var h=new u.constructor(u.type,u);ka=h,u.target.dispatchEvent(h),ka=null}else return i=Hi(u),i!==null&&ld(i),s.blockedOn=u,!1;i.shift()}return!0}function mg(s,i,u){Ol(s)&&u.delete(i)}function kS(){ud=!1,Ur!==null&&Ol(Ur)&&(Ur=null),zr!==null&&Ol(zr)&&(zr=null),Br!==null&&Ol(Br)&&(Br=null),Pi.forEach(mg),Ri.forEach(mg)}function Ti(s,i){s.blockedOn===i&&(s.blockedOn=null,ud||(ud=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,kS)))}function Ai(s){function i(m){return Ti(m,s)}if(0<Rl.length){Ti(Rl[0],s);for(var u=1;u<Rl.length;u++){var h=Rl[u];h.blockedOn===s&&(h.blockedOn=null)}}for(Ur!==null&&Ti(Ur,s),zr!==null&&Ti(zr,s),Br!==null&&Ti(Br,s),Pi.forEach(i),Ri.forEach(i),u=0;u<Hr.length;u++)h=Hr[u],h.blockedOn===s&&(h.blockedOn=null);for(;0<Hr.length&&(u=Hr[0],u.blockedOn===null);)pg(u),u.blockedOn===null&&Hr.shift()}var fs=N.ReactCurrentBatchConfig,Tl=!0;function CS(s,i,u,h){var m=qe,v=fs.transition;fs.transition=null;try{qe=1,cd(s,i,u,h)}finally{qe=m,fs.transition=v}}function PS(s,i,u,h){var m=qe,v=fs.transition;fs.transition=null;try{qe=4,cd(s,i,u,h)}finally{qe=m,fs.transition=v}}function cd(s,i,u,h){if(Tl){var m=dd(s,i,u,h);if(m===null)Rd(s,i,h,Al,u),hg(s,h);else if(ES(m,s,i,u,h))h.stopPropagation();else if(hg(s,h),i&4&&-1<SS.indexOf(s)){for(;m!==null;){var v=Hi(m);if(v!==null&&ug(v),v=dd(s,i,u,h),v===null&&Rd(s,i,h,Al,u),v===m)break;m=v}m!==null&&h.stopPropagation()}else Rd(s,i,h,null,u)}}var Al=null;function dd(s,i,u,h){if(Al=null,s=wn(h),s=Pa(s),s!==null)if(i=Ca(s),i===null)s=null;else if(u=i.tag,u===13){if(s=Ym(i),s!==null)return s;s=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return Al=s,null}function gg(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pS()){case ad:return 1;case sg:return 4;case Sl:case mS:return 16;case ig:return 536870912;default:return 16}default:return 16}}var Vr=null,fd=null,Il=null;function yg(){if(Il)return Il;var s,i=fd,u=i.length,h,m="value"in Vr?Vr.value:Vr.textContent,v=m.length;for(s=0;s<u&&i[s]===m[s];s++);var x=u-s;for(h=1;h<=x&&i[u-h]===m[v-h];h++);return Il=m.slice(s,1<h?1-h:void 0)}function Nl(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function $l(){return!0}function vg(){return!1}function rn(s){function i(u,h,m,v,x){this._reactName=u,this._targetInst=m,this.type=h,this.nativeEvent=v,this.target=x,this.currentTarget=null;for(var C in s)s.hasOwnProperty(C)&&(u=s[C],this[C]=u?u(v):v[C]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?$l:vg,this.isPropagationStopped=vg,this}return V(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=$l)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=$l)},persist:function(){},isPersistent:$l}),i}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hd=rn(hs),Ii=V({},hs,{view:0,detail:0}),RS=rn(Ii),pd,md,Ni,jl=V({},Ii,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ni&&(Ni&&s.type==="mousemove"?(pd=s.screenX-Ni.screenX,md=s.screenY-Ni.screenY):md=pd=0,Ni=s),pd)},movementY:function(s){return"movementY"in s?s.movementY:md}}),wg=rn(jl),OS=V({},jl,{dataTransfer:0}),TS=rn(OS),AS=V({},Ii,{relatedTarget:0}),gd=rn(AS),IS=V({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),NS=rn(IS),$S=V({},hs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),jS=rn($S),LS=V({},hs,{data:0}),_g=rn(LS),MS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},FS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function US(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=FS[s])?!!i[s]:!1}function yd(){return US}var zS=V({},Ii,{key:function(s){if(s.key){var i=MS[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Nl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?DS[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yd,charCode:function(s){return s.type==="keypress"?Nl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Nl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),BS=rn(zS),HS=V({},jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bg=rn(HS),VS=V({},Ii,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yd}),qS=rn(VS),WS=V({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZS=rn(WS),GS=V({},jl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),JS=rn(GS),KS=[9,13,27,32],vd=c&&"CompositionEvent"in window,$i=null;c&&"documentMode"in document&&($i=document.documentMode);var XS=c&&"TextEvent"in window&&!$i,xg=c&&(!vd||$i&&8<$i&&11>=$i),Sg=" ",Eg=!1;function kg(s,i){switch(s){case"keyup":return KS.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cg(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ps=!1;function QS(s,i){switch(s){case"compositionend":return Cg(i);case"keypress":return i.which!==32?null:(Eg=!0,Sg);case"textInput":return s=i.data,s===Sg&&Eg?null:s;default:return null}}function YS(s,i){if(ps)return s==="compositionend"||!vd&&kg(s,i)?(s=yg(),Il=fd=Vr=null,ps=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return xg&&i.locale!=="ko"?null:i.data;default:return null}}var eE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pg(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!eE[s.type]:i==="textarea"}function Rg(s,i,u,h){qt(h),i=Ul(i,"onChange"),0<i.length&&(u=new hd("onChange","change",null,u,h),s.push({event:u,listeners:i}))}var ji=null,Li=null;function tE(s){Wg(s,0)}function Ll(s){var i=ws(s);if(hl(i))return s}function nE(s,i){if(s==="change")return i}var Og=!1;if(c){var wd;if(c){var _d="oninput"in document;if(!_d){var Tg=document.createElement("div");Tg.setAttribute("oninput","return;"),_d=typeof Tg.oninput=="function"}wd=_d}else wd=!1;Og=wd&&(!document.documentMode||9<document.documentMode)}function Ag(){ji&&(ji.detachEvent("onpropertychange",Ig),Li=ji=null)}function Ig(s){if(s.propertyName==="value"&&Ll(Li)){var i=[];Rg(i,Li,s,wn(s)),Qm(tE,i)}}function rE(s,i,u){s==="focusin"?(Ag(),ji=i,Li=u,ji.attachEvent("onpropertychange",Ig)):s==="focusout"&&Ag()}function aE(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ll(Li)}function sE(s,i){if(s==="click")return Ll(i)}function iE(s,i){if(s==="input"||s==="change")return Ll(i)}function oE(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Tn=typeof Object.is=="function"?Object.is:oE;function Mi(s,i){if(Tn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var u=Object.keys(s),h=Object.keys(i);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var m=u[h];if(!d.call(i,m)||!Tn(s[m],i[m]))return!1}return!0}function Ng(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function $g(s,i){var u=Ng(s);s=0;for(var h;u;){if(u.nodeType===3){if(h=s+u.textContent.length,s<=i&&h>=i)return{node:u,offset:i-s};s=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Ng(u)}}function jg(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?jg(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Lg(){for(var s=window,i=Sa();i instanceof s.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)s=i.contentWindow;else break;i=Sa(s.document)}return i}function bd(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function lE(s){var i=Lg(),u=s.focusedElem,h=s.selectionRange;if(i!==u&&u&&u.ownerDocument&&jg(u.ownerDocument.documentElement,u)){if(h!==null&&bd(u)){if(i=h.start,s=h.end,s===void 0&&(s=i),"selectionStart"in u)u.selectionStart=i,u.selectionEnd=Math.min(s,u.value.length);else if(s=(i=u.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var m=u.textContent.length,v=Math.min(h.start,m);h=h.end===void 0?v:Math.min(h.end,m),!s.extend&&v>h&&(m=h,h=v,v=m),m=$g(u,v);var x=$g(u,h);m&&x&&(s.rangeCount!==1||s.anchorNode!==m.node||s.anchorOffset!==m.offset||s.focusNode!==x.node||s.focusOffset!==x.offset)&&(i=i.createRange(),i.setStart(m.node,m.offset),s.removeAllRanges(),v>h?(s.addRange(i),s.extend(x.node,x.offset)):(i.setEnd(x.node,x.offset),s.addRange(i)))}}for(i=[],s=u;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<i.length;u++)s=i[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var uE=c&&"documentMode"in document&&11>=document.documentMode,ms=null,xd=null,Di=null,Sd=!1;function Mg(s,i,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Sd||ms==null||ms!==Sa(h)||(h=ms,"selectionStart"in h&&bd(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Di&&Mi(Di,h)||(Di=h,h=Ul(xd,"onSelect"),0<h.length&&(i=new hd("onSelect","select",null,i,u),s.push({event:i,listeners:h}),i.target=ms)))}function Ml(s,i){var u={};return u[s.toLowerCase()]=i.toLowerCase(),u["Webkit"+s]="webkit"+i,u["Moz"+s]="moz"+i,u}var gs={animationend:Ml("Animation","AnimationEnd"),animationiteration:Ml("Animation","AnimationIteration"),animationstart:Ml("Animation","AnimationStart"),transitionend:Ml("Transition","TransitionEnd")},Ed={},Dg={};c&&(Dg=document.createElement("div").style,"AnimationEvent"in window||(delete gs.animationend.animation,delete gs.animationiteration.animation,delete gs.animationstart.animation),"TransitionEvent"in window||delete gs.transitionend.transition);function Dl(s){if(Ed[s])return Ed[s];if(!gs[s])return s;var i=gs[s],u;for(u in i)if(i.hasOwnProperty(u)&&u in Dg)return Ed[s]=i[u];return s}var Fg=Dl("animationend"),Ug=Dl("animationiteration"),zg=Dl("animationstart"),Bg=Dl("transitionend"),Hg=new Map,Vg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qr(s,i){Hg.set(s,i),o(i,[s])}for(var kd=0;kd<Vg.length;kd++){var Cd=Vg[kd],cE=Cd.toLowerCase(),dE=Cd[0].toUpperCase()+Cd.slice(1);qr(cE,"on"+dE)}qr(Fg,"onAnimationEnd"),qr(Ug,"onAnimationIteration"),qr(zg,"onAnimationStart"),qr("dblclick","onDoubleClick"),qr("focusin","onFocus"),qr("focusout","onBlur"),qr(Bg,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fi));function qg(s,i,u){var h=s.type||"unknown-event";s.currentTarget=u,cS(h,i,void 0,s),s.currentTarget=null}function Wg(s,i){i=(i&4)!==0;for(var u=0;u<s.length;u++){var h=s[u],m=h.event;h=h.listeners;e:{var v=void 0;if(i)for(var x=h.length-1;0<=x;x--){var C=h[x],T=C.instance,U=C.currentTarget;if(C=C.listener,T!==v&&m.isPropagationStopped())break e;qg(m,C,U),v=T}else for(x=0;x<h.length;x++){if(C=h[x],T=C.instance,U=C.currentTarget,C=C.listener,T!==v&&m.isPropagationStopped())break e;qg(m,C,U),v=T}}}if(xl)throw s=rd,xl=!1,rd=null,s}function Qe(s,i){var u=i[$d];u===void 0&&(u=i[$d]=new Set);var h=s+"__bubble";u.has(h)||(Zg(i,s,2,!1),u.add(h))}function Pd(s,i,u){var h=0;i&&(h|=4),Zg(u,s,h,i)}var Fl="_reactListening"+Math.random().toString(36).slice(2);function Ui(s){if(!s[Fl]){s[Fl]=!0,n.forEach(function(u){u!=="selectionchange"&&(fE.has(u)||Pd(u,!1,s),Pd(u,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Fl]||(i[Fl]=!0,Pd("selectionchange",!1,i))}}function Zg(s,i,u,h){switch(gg(i)){case 1:var m=CS;break;case 4:m=PS;break;default:m=cd}u=m.bind(null,i,u,s),m=void 0,!nd||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),h?m!==void 0?s.addEventListener(i,u,{capture:!0,passive:m}):s.addEventListener(i,u,!0):m!==void 0?s.addEventListener(i,u,{passive:m}):s.addEventListener(i,u,!1)}function Rd(s,i,u,h,m){var v=h;if(!(i&1)&&!(i&2)&&h!==null)e:for(;;){if(h===null)return;var x=h.tag;if(x===3||x===4){var C=h.stateNode.containerInfo;if(C===m||C.nodeType===8&&C.parentNode===m)break;if(x===4)for(x=h.return;x!==null;){var T=x.tag;if((T===3||T===4)&&(T=x.stateNode.containerInfo,T===m||T.nodeType===8&&T.parentNode===m))return;x=x.return}for(;C!==null;){if(x=Pa(C),x===null)return;if(T=x.tag,T===5||T===6){h=v=x;continue e}C=C.parentNode}}h=h.return}Qm(function(){var U=v,Z=wn(u),X=[];e:{var W=Hg.get(s);if(W!==void 0){var le=hd,de=s;switch(s){case"keypress":if(Nl(u)===0)break e;case"keydown":case"keyup":le=BS;break;case"focusin":de="focus",le=gd;break;case"focusout":de="blur",le=gd;break;case"beforeblur":case"afterblur":le=gd;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":le=wg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":le=TS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":le=qS;break;case Fg:case Ug:case zg:le=NS;break;case Bg:le=ZS;break;case"scroll":le=RS;break;case"wheel":le=JS;break;case"copy":case"cut":case"paste":le=jS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":le=bg}var fe=(i&4)!==0,ct=!fe&&s==="scroll",L=fe?W!==null?W+"Capture":null:W;fe=[];for(var A=U,M;A!==null;){M=A;var te=M.stateNode;if(M.tag===5&&te!==null&&(M=te,L!==null&&(te=xi(A,L),te!=null&&fe.push(zi(A,te,M)))),ct)break;A=A.return}0<fe.length&&(W=new le(W,de,null,u,Z),X.push({event:W,listeners:fe}))}}if(!(i&7)){e:{if(W=s==="mouseover"||s==="pointerover",le=s==="mouseout"||s==="pointerout",W&&u!==ka&&(de=u.relatedTarget||u.fromElement)&&(Pa(de)||de[mr]))break e;if((le||W)&&(W=Z.window===Z?Z:(W=Z.ownerDocument)?W.defaultView||W.parentWindow:window,le?(de=u.relatedTarget||u.toElement,le=U,de=de?Pa(de):null,de!==null&&(ct=Ca(de),de!==ct||de.tag!==5&&de.tag!==6)&&(de=null)):(le=null,de=U),le!==de)){if(fe=wg,te="onMouseLeave",L="onMouseEnter",A="mouse",(s==="pointerout"||s==="pointerover")&&(fe=bg,te="onPointerLeave",L="onPointerEnter",A="pointer"),ct=le==null?W:ws(le),M=de==null?W:ws(de),W=new fe(te,A+"leave",le,u,Z),W.target=ct,W.relatedTarget=M,te=null,Pa(Z)===U&&(fe=new fe(L,A+"enter",de,u,Z),fe.target=M,fe.relatedTarget=ct,te=fe),ct=te,le&&de)t:{for(fe=le,L=de,A=0,M=fe;M;M=ys(M))A++;for(M=0,te=L;te;te=ys(te))M++;for(;0<A-M;)fe=ys(fe),A--;for(;0<M-A;)L=ys(L),M--;for(;A--;){if(fe===L||L!==null&&fe===L.alternate)break t;fe=ys(fe),L=ys(L)}fe=null}else fe=null;le!==null&&Gg(X,W,le,fe,!1),de!==null&&ct!==null&&Gg(X,ct,de,fe,!0)}}e:{if(W=U?ws(U):window,le=W.nodeName&&W.nodeName.toLowerCase(),le==="select"||le==="input"&&W.type==="file")var pe=nE;else if(Pg(W))if(Og)pe=iE;else{pe=aE;var _e=rE}else(le=W.nodeName)&&le.toLowerCase()==="input"&&(W.type==="checkbox"||W.type==="radio")&&(pe=sE);if(pe&&(pe=pe(s,U))){Rg(X,pe,u,Z);break e}_e&&_e(s,W,U),s==="focusout"&&(_e=W._wrapperState)&&_e.controlled&&W.type==="number"&&is(W,"number",W.value)}switch(_e=U?ws(U):window,s){case"focusin":(Pg(_e)||_e.contentEditable==="true")&&(ms=_e,xd=U,Di=null);break;case"focusout":Di=xd=ms=null;break;case"mousedown":Sd=!0;break;case"contextmenu":case"mouseup":case"dragend":Sd=!1,Mg(X,u,Z);break;case"selectionchange":if(uE)break;case"keydown":case"keyup":Mg(X,u,Z)}var be;if(vd)e:{switch(s){case"compositionstart":var ke="onCompositionStart";break e;case"compositionend":ke="onCompositionEnd";break e;case"compositionupdate":ke="onCompositionUpdate";break e}ke=void 0}else ps?kg(s,u)&&(ke="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(ke="onCompositionStart");ke&&(xg&&u.locale!=="ko"&&(ps||ke!=="onCompositionStart"?ke==="onCompositionEnd"&&ps&&(be=yg()):(Vr=Z,fd="value"in Vr?Vr.value:Vr.textContent,ps=!0)),_e=Ul(U,ke),0<_e.length&&(ke=new _g(ke,s,null,u,Z),X.push({event:ke,listeners:_e}),be?ke.data=be:(be=Cg(u),be!==null&&(ke.data=be)))),(be=XS?QS(s,u):YS(s,u))&&(U=Ul(U,"onBeforeInput"),0<U.length&&(Z=new _g("onBeforeInput","beforeinput",null,u,Z),X.push({event:Z,listeners:U}),Z.data=be))}Wg(X,i)})}function zi(s,i,u){return{instance:s,listener:i,currentTarget:u}}function Ul(s,i){for(var u=i+"Capture",h=[];s!==null;){var m=s,v=m.stateNode;m.tag===5&&v!==null&&(m=v,v=xi(s,u),v!=null&&h.unshift(zi(s,v,m)),v=xi(s,i),v!=null&&h.push(zi(s,v,m))),s=s.return}return h}function ys(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Gg(s,i,u,h,m){for(var v=i._reactName,x=[];u!==null&&u!==h;){var C=u,T=C.alternate,U=C.stateNode;if(T!==null&&T===h)break;C.tag===5&&U!==null&&(C=U,m?(T=xi(u,v),T!=null&&x.unshift(zi(u,T,C))):m||(T=xi(u,v),T!=null&&x.push(zi(u,T,C)))),u=u.return}x.length!==0&&s.push({event:i,listeners:x})}var hE=/\r\n?/g,pE=/\u0000|\uFFFD/g;function Jg(s){return(typeof s=="string"?s:""+s).replace(hE,`
`).replace(pE,"")}function zl(s,i,u){if(i=Jg(i),Jg(s)!==i&&u)throw Error(t(425))}function Bl(){}var Od=null,Td=null;function Ad(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Id=typeof setTimeout=="function"?setTimeout:void 0,mE=typeof clearTimeout=="function"?clearTimeout:void 0,Kg=typeof Promise=="function"?Promise:void 0,gE=typeof queueMicrotask=="function"?queueMicrotask:typeof Kg<"u"?function(s){return Kg.resolve(null).then(s).catch(yE)}:Id;function yE(s){setTimeout(function(){throw s})}function Nd(s,i){var u=i,h=0;do{var m=u.nextSibling;if(s.removeChild(u),m&&m.nodeType===8)if(u=m.data,u==="/$"){if(h===0){s.removeChild(m),Ai(i);return}h--}else u!=="$"&&u!=="$?"&&u!=="$!"||h++;u=m}while(u);Ai(i)}function Wr(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Xg(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(i===0)return s;i--}else u==="/$"&&i++}s=s.previousSibling}return null}var vs=Math.random().toString(36).slice(2),er="__reactFiber$"+vs,Bi="__reactProps$"+vs,mr="__reactContainer$"+vs,$d="__reactEvents$"+vs,vE="__reactListeners$"+vs,wE="__reactHandles$"+vs;function Pa(s){var i=s[er];if(i)return i;for(var u=s.parentNode;u;){if(i=u[mr]||u[er]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(s=Xg(s);s!==null;){if(u=s[er])return u;s=Xg(s)}return i}s=u,u=s.parentNode}return null}function Hi(s){return s=s[er]||s[mr],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function ws(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function Hl(s){return s[Bi]||null}var jd=[],_s=-1;function Zr(s){return{current:s}}function Ye(s){0>_s||(s.current=jd[_s],jd[_s]=null,_s--)}function Xe(s,i){_s++,jd[_s]=s.current,s.current=i}var Gr={},Tt=Zr(Gr),Wt=Zr(!1),Ra=Gr;function bs(s,i){var u=s.type.contextTypes;if(!u)return Gr;var h=s.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var m={},v;for(v in u)m[v]=i[v];return h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=m),m}function Zt(s){return s=s.childContextTypes,s!=null}function Vl(){Ye(Wt),Ye(Tt)}function Qg(s,i,u){if(Tt.current!==Gr)throw Error(t(168));Xe(Tt,i),Xe(Wt,u)}function Yg(s,i,u){var h=s.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return u;h=h.getChildContext();for(var m in h)if(!(m in i))throw Error(t(108,ve(s)||"Unknown",m));return V({},u,h)}function ql(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Gr,Ra=Tt.current,Xe(Tt,s),Xe(Wt,Wt.current),!0}function ey(s,i,u){var h=s.stateNode;if(!h)throw Error(t(169));u?(s=Yg(s,i,Ra),h.__reactInternalMemoizedMergedChildContext=s,Ye(Wt),Ye(Tt),Xe(Tt,s)):Ye(Wt),Xe(Wt,u)}var gr=null,Wl=!1,Ld=!1;function ty(s){gr===null?gr=[s]:gr.push(s)}function _E(s){Wl=!0,ty(s)}function Jr(){if(!Ld&&gr!==null){Ld=!0;var s=0,i=qe;try{var u=gr;for(qe=1;s<u.length;s++){var h=u[s];do h=h(!0);while(h!==null)}gr=null,Wl=!1}catch(m){throw gr!==null&&(gr=gr.slice(s+1)),rg(ad,Jr),m}finally{qe=i,Ld=!1}}return null}var xs=[],Ss=0,Zl=null,Gl=0,_n=[],bn=0,Oa=null,yr=1,vr="";function Ta(s,i){xs[Ss++]=Gl,xs[Ss++]=Zl,Zl=s,Gl=i}function ny(s,i,u){_n[bn++]=yr,_n[bn++]=vr,_n[bn++]=Oa,Oa=s;var h=yr;s=vr;var m=32-On(h)-1;h&=~(1<<m),u+=1;var v=32-On(i)+m;if(30<v){var x=m-m%5;v=(h&(1<<x)-1).toString(32),h>>=x,m-=x,yr=1<<32-On(i)+m|u<<m|h,vr=v+s}else yr=1<<v|u<<m|h,vr=s}function Md(s){s.return!==null&&(Ta(s,1),ny(s,1,0))}function Dd(s){for(;s===Zl;)Zl=xs[--Ss],xs[Ss]=null,Gl=xs[--Ss],xs[Ss]=null;for(;s===Oa;)Oa=_n[--bn],_n[bn]=null,vr=_n[--bn],_n[bn]=null,yr=_n[--bn],_n[bn]=null}var an=null,sn=null,tt=!1,An=null;function ry(s,i){var u=kn(5,null,null,0);u.elementType="DELETED",u.stateNode=i,u.return=s,i=s.deletions,i===null?(s.deletions=[u],s.flags|=16):i.push(u)}function ay(s,i){switch(s.tag){case 5:var u=s.type;return i=i.nodeType!==1||u.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,an=s,sn=Wr(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,an=s,sn=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(u=Oa!==null?{id:yr,overflow:vr}:null,s.memoizedState={dehydrated:i,treeContext:u,retryLane:1073741824},u=kn(18,null,null,0),u.stateNode=i,u.return=s,s.child=u,an=s,sn=null,!0):!1;default:return!1}}function Fd(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Ud(s){if(tt){var i=sn;if(i){var u=i;if(!ay(s,i)){if(Fd(s))throw Error(t(418));i=Wr(u.nextSibling);var h=an;i&&ay(s,i)?ry(h,u):(s.flags=s.flags&-4097|2,tt=!1,an=s)}}else{if(Fd(s))throw Error(t(418));s.flags=s.flags&-4097|2,tt=!1,an=s}}}function sy(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;an=s}function Jl(s){if(s!==an)return!1;if(!tt)return sy(s),tt=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Ad(s.type,s.memoizedProps)),i&&(i=sn)){if(Fd(s))throw iy(),Error(t(418));for(;i;)ry(s,i),i=Wr(i.nextSibling)}if(sy(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(i===0){sn=Wr(s.nextSibling);break e}i--}else u!=="$"&&u!=="$!"&&u!=="$?"||i++}s=s.nextSibling}sn=null}}else sn=an?Wr(s.stateNode.nextSibling):null;return!0}function iy(){for(var s=sn;s;)s=Wr(s.nextSibling)}function Es(){sn=an=null,tt=!1}function zd(s){An===null?An=[s]:An.push(s)}var bE=N.ReactCurrentBatchConfig;function Vi(s,i,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var h=u.stateNode}if(!h)throw Error(t(147,s));var m=h,v=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===v?i.ref:(i=function(x){var C=m.refs;x===null?delete C[v]:C[v]=x},i._stringRef=v,i)}if(typeof s!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,s))}return s}function Kl(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function oy(s){var i=s._init;return i(s._payload)}function ly(s){function i(L,A){if(s){var M=L.deletions;M===null?(L.deletions=[A],L.flags|=16):M.push(A)}}function u(L,A){if(!s)return null;for(;A!==null;)i(L,A),A=A.sibling;return null}function h(L,A){for(L=new Map;A!==null;)A.key!==null?L.set(A.key,A):L.set(A.index,A),A=A.sibling;return L}function m(L,A){return L=ra(L,A),L.index=0,L.sibling=null,L}function v(L,A,M){return L.index=M,s?(M=L.alternate,M!==null?(M=M.index,M<A?(L.flags|=2,A):M):(L.flags|=2,A)):(L.flags|=1048576,A)}function x(L){return s&&L.alternate===null&&(L.flags|=2),L}function C(L,A,M,te){return A===null||A.tag!==6?(A=Nf(M,L.mode,te),A.return=L,A):(A=m(A,M),A.return=L,A)}function T(L,A,M,te){var pe=M.type;return pe===z?Z(L,A,M.props.children,te,M.key):A!==null&&(A.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===ne&&oy(pe)===A.type)?(te=m(A,M.props),te.ref=Vi(L,A,M),te.return=L,te):(te=_u(M.type,M.key,M.props,null,L.mode,te),te.ref=Vi(L,A,M),te.return=L,te)}function U(L,A,M,te){return A===null||A.tag!==4||A.stateNode.containerInfo!==M.containerInfo||A.stateNode.implementation!==M.implementation?(A=$f(M,L.mode,te),A.return=L,A):(A=m(A,M.children||[]),A.return=L,A)}function Z(L,A,M,te,pe){return A===null||A.tag!==7?(A=Da(M,L.mode,te,pe),A.return=L,A):(A=m(A,M),A.return=L,A)}function X(L,A,M){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Nf(""+A,L.mode,M),A.return=L,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case j:return M=_u(A.type,A.key,A.props,null,L.mode,M),M.ref=Vi(L,null,A),M.return=L,M;case D:return A=$f(A,L.mode,M),A.return=L,A;case ne:var te=A._init;return X(L,te(A._payload),M)}if(tn(A)||F(A))return A=Da(A,L.mode,M,null),A.return=L,A;Kl(L,A)}return null}function W(L,A,M,te){var pe=A!==null?A.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return pe!==null?null:C(L,A,""+M,te);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case j:return M.key===pe?T(L,A,M,te):null;case D:return M.key===pe?U(L,A,M,te):null;case ne:return pe=M._init,W(L,A,pe(M._payload),te)}if(tn(M)||F(M))return pe!==null?null:Z(L,A,M,te,null);Kl(L,M)}return null}function le(L,A,M,te,pe){if(typeof te=="string"&&te!==""||typeof te=="number")return L=L.get(M)||null,C(A,L,""+te,pe);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case j:return L=L.get(te.key===null?M:te.key)||null,T(A,L,te,pe);case D:return L=L.get(te.key===null?M:te.key)||null,U(A,L,te,pe);case ne:var _e=te._init;return le(L,A,M,_e(te._payload),pe)}if(tn(te)||F(te))return L=L.get(M)||null,Z(A,L,te,pe,null);Kl(A,te)}return null}function de(L,A,M,te){for(var pe=null,_e=null,be=A,ke=A=0,_t=null;be!==null&&ke<M.length;ke++){be.index>ke?(_t=be,be=null):_t=be.sibling;var ze=W(L,be,M[ke],te);if(ze===null){be===null&&(be=_t);break}s&&be&&ze.alternate===null&&i(L,be),A=v(ze,A,ke),_e===null?pe=ze:_e.sibling=ze,_e=ze,be=_t}if(ke===M.length)return u(L,be),tt&&Ta(L,ke),pe;if(be===null){for(;ke<M.length;ke++)be=X(L,M[ke],te),be!==null&&(A=v(be,A,ke),_e===null?pe=be:_e.sibling=be,_e=be);return tt&&Ta(L,ke),pe}for(be=h(L,be);ke<M.length;ke++)_t=le(be,L,ke,M[ke],te),_t!==null&&(s&&_t.alternate!==null&&be.delete(_t.key===null?ke:_t.key),A=v(_t,A,ke),_e===null?pe=_t:_e.sibling=_t,_e=_t);return s&&be.forEach(function(aa){return i(L,aa)}),tt&&Ta(L,ke),pe}function fe(L,A,M,te){var pe=F(M);if(typeof pe!="function")throw Error(t(150));if(M=pe.call(M),M==null)throw Error(t(151));for(var _e=pe=null,be=A,ke=A=0,_t=null,ze=M.next();be!==null&&!ze.done;ke++,ze=M.next()){be.index>ke?(_t=be,be=null):_t=be.sibling;var aa=W(L,be,ze.value,te);if(aa===null){be===null&&(be=_t);break}s&&be&&aa.alternate===null&&i(L,be),A=v(aa,A,ke),_e===null?pe=aa:_e.sibling=aa,_e=aa,be=_t}if(ze.done)return u(L,be),tt&&Ta(L,ke),pe;if(be===null){for(;!ze.done;ke++,ze=M.next())ze=X(L,ze.value,te),ze!==null&&(A=v(ze,A,ke),_e===null?pe=ze:_e.sibling=ze,_e=ze);return tt&&Ta(L,ke),pe}for(be=h(L,be);!ze.done;ke++,ze=M.next())ze=le(be,L,ke,ze.value,te),ze!==null&&(s&&ze.alternate!==null&&be.delete(ze.key===null?ke:ze.key),A=v(ze,A,ke),_e===null?pe=ze:_e.sibling=ze,_e=ze);return s&&be.forEach(function(e1){return i(L,e1)}),tt&&Ta(L,ke),pe}function ct(L,A,M,te){if(typeof M=="object"&&M!==null&&M.type===z&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case j:e:{for(var pe=M.key,_e=A;_e!==null;){if(_e.key===pe){if(pe=M.type,pe===z){if(_e.tag===7){u(L,_e.sibling),A=m(_e,M.props.children),A.return=L,L=A;break e}}else if(_e.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===ne&&oy(pe)===_e.type){u(L,_e.sibling),A=m(_e,M.props),A.ref=Vi(L,_e,M),A.return=L,L=A;break e}u(L,_e);break}else i(L,_e);_e=_e.sibling}M.type===z?(A=Da(M.props.children,L.mode,te,M.key),A.return=L,L=A):(te=_u(M.type,M.key,M.props,null,L.mode,te),te.ref=Vi(L,A,M),te.return=L,L=te)}return x(L);case D:e:{for(_e=M.key;A!==null;){if(A.key===_e)if(A.tag===4&&A.stateNode.containerInfo===M.containerInfo&&A.stateNode.implementation===M.implementation){u(L,A.sibling),A=m(A,M.children||[]),A.return=L,L=A;break e}else{u(L,A);break}else i(L,A);A=A.sibling}A=$f(M,L.mode,te),A.return=L,L=A}return x(L);case ne:return _e=M._init,ct(L,A,_e(M._payload),te)}if(tn(M))return de(L,A,M,te);if(F(M))return fe(L,A,M,te);Kl(L,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,A!==null&&A.tag===6?(u(L,A.sibling),A=m(A,M),A.return=L,L=A):(u(L,A),A=Nf(M,L.mode,te),A.return=L,L=A),x(L)):u(L,A)}return ct}var ks=ly(!0),uy=ly(!1),Xl=Zr(null),Ql=null,Cs=null,Bd=null;function Hd(){Bd=Cs=Ql=null}function Vd(s){var i=Xl.current;Ye(Xl),s._currentValue=i}function qd(s,i,u){for(;s!==null;){var h=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),s===u)break;s=s.return}}function Ps(s,i){Ql=s,Bd=Cs=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&i&&(Gt=!0),s.firstContext=null)}function xn(s){var i=s._currentValue;if(Bd!==s)if(s={context:s,memoizedValue:i,next:null},Cs===null){if(Ql===null)throw Error(t(308));Cs=s,Ql.dependencies={lanes:0,firstContext:s}}else Cs=Cs.next=s;return i}var Aa=null;function Wd(s){Aa===null?Aa=[s]:Aa.push(s)}function cy(s,i,u,h){var m=i.interleaved;return m===null?(u.next=u,Wd(i)):(u.next=m.next,m.next=u),i.interleaved=u,wr(s,h)}function wr(s,i){s.lanes|=i;var u=s.alternate;for(u!==null&&(u.lanes|=i),u=s,s=s.return;s!==null;)s.childLanes|=i,u=s.alternate,u!==null&&(u.childLanes|=i),u=s,s=s.return;return u.tag===3?u.stateNode:null}var Kr=!1;function Zd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dy(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function _r(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function Xr(s,i,u){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,Fe&2){var m=h.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),h.pending=i,wr(s,u)}return m=h.interleaved,m===null?(i.next=i,Wd(h)):(i.next=m.next,m.next=i),h.interleaved=i,wr(s,u)}function Yl(s,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194240)!==0)){var h=i.lanes;h&=s.pendingLanes,u|=h,i.lanes=u,od(s,u)}}function fy(s,i){var u=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var m=null,v=null;if(u=u.firstBaseUpdate,u!==null){do{var x={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};v===null?m=v=x:v=v.next=x,u=u.next}while(u!==null);v===null?m=v=i:v=v.next=i}else m=v=i;u={baseState:h.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:h.shared,effects:h.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=i:s.next=i,u.lastBaseUpdate=i}function eu(s,i,u,h){var m=s.updateQueue;Kr=!1;var v=m.firstBaseUpdate,x=m.lastBaseUpdate,C=m.shared.pending;if(C!==null){m.shared.pending=null;var T=C,U=T.next;T.next=null,x===null?v=U:x.next=U,x=T;var Z=s.alternate;Z!==null&&(Z=Z.updateQueue,C=Z.lastBaseUpdate,C!==x&&(C===null?Z.firstBaseUpdate=U:C.next=U,Z.lastBaseUpdate=T))}if(v!==null){var X=m.baseState;x=0,Z=U=T=null,C=v;do{var W=C.lane,le=C.eventTime;if((h&W)===W){Z!==null&&(Z=Z.next={eventTime:le,lane:0,tag:C.tag,payload:C.payload,callback:C.callback,next:null});e:{var de=s,fe=C;switch(W=i,le=u,fe.tag){case 1:if(de=fe.payload,typeof de=="function"){X=de.call(le,X,W);break e}X=de;break e;case 3:de.flags=de.flags&-65537|128;case 0:if(de=fe.payload,W=typeof de=="function"?de.call(le,X,W):de,W==null)break e;X=V({},X,W);break e;case 2:Kr=!0}}C.callback!==null&&C.lane!==0&&(s.flags|=64,W=m.effects,W===null?m.effects=[C]:W.push(C))}else le={eventTime:le,lane:W,tag:C.tag,payload:C.payload,callback:C.callback,next:null},Z===null?(U=Z=le,T=X):Z=Z.next=le,x|=W;if(C=C.next,C===null){if(C=m.shared.pending,C===null)break;W=C,C=W.next,W.next=null,m.lastBaseUpdate=W,m.shared.pending=null}}while(!0);if(Z===null&&(T=X),m.baseState=T,m.firstBaseUpdate=U,m.lastBaseUpdate=Z,i=m.shared.interleaved,i!==null){m=i;do x|=m.lane,m=m.next;while(m!==i)}else v===null&&(m.shared.lanes=0);$a|=x,s.lanes=x,s.memoizedState=X}}function hy(s,i,u){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var h=s[i],m=h.callback;if(m!==null){if(h.callback=null,h=u,typeof m!="function")throw Error(t(191,m));m.call(h)}}}var qi={},tr=Zr(qi),Wi=Zr(qi),Zi=Zr(qi);function Ia(s){if(s===qi)throw Error(t(174));return s}function Gd(s,i){switch(Xe(Zi,i),Xe(Wi,s),Xe(tr,qi),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Dr(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=Dr(i,s)}Ye(tr),Xe(tr,i)}function Rs(){Ye(tr),Ye(Wi),Ye(Zi)}function py(s){Ia(Zi.current);var i=Ia(tr.current),u=Dr(i,s.type);i!==u&&(Xe(Wi,s),Xe(tr,u))}function Jd(s){Wi.current===s&&(Ye(tr),Ye(Wi))}var rt=Zr(0);function tu(s){for(var i=s;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Kd=[];function Xd(){for(var s=0;s<Kd.length;s++)Kd[s]._workInProgressVersionPrimary=null;Kd.length=0}var nu=N.ReactCurrentDispatcher,Qd=N.ReactCurrentBatchConfig,Na=0,at=null,ht=null,vt=null,ru=!1,Gi=!1,Ji=0,xE=0;function At(){throw Error(t(321))}function Yd(s,i){if(i===null)return!1;for(var u=0;u<i.length&&u<s.length;u++)if(!Tn(s[u],i[u]))return!1;return!0}function ef(s,i,u,h,m,v){if(Na=v,at=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,nu.current=s===null||s.memoizedState===null?CE:PE,s=u(h,m),Gi){v=0;do{if(Gi=!1,Ji=0,25<=v)throw Error(t(301));v+=1,vt=ht=null,i.updateQueue=null,nu.current=RE,s=u(h,m)}while(Gi)}if(nu.current=iu,i=ht!==null&&ht.next!==null,Na=0,vt=ht=at=null,ru=!1,i)throw Error(t(300));return s}function tf(){var s=Ji!==0;return Ji=0,s}function nr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?at.memoizedState=vt=s:vt=vt.next=s,vt}function Sn(){if(ht===null){var s=at.alternate;s=s!==null?s.memoizedState:null}else s=ht.next;var i=vt===null?at.memoizedState:vt.next;if(i!==null)vt=i,ht=s;else{if(s===null)throw Error(t(310));ht=s,s={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},vt===null?at.memoizedState=vt=s:vt=vt.next=s}return vt}function Ki(s,i){return typeof i=="function"?i(s):i}function nf(s){var i=Sn(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var h=ht,m=h.baseQueue,v=u.pending;if(v!==null){if(m!==null){var x=m.next;m.next=v.next,v.next=x}h.baseQueue=m=v,u.pending=null}if(m!==null){v=m.next,h=h.baseState;var C=x=null,T=null,U=v;do{var Z=U.lane;if((Na&Z)===Z)T!==null&&(T=T.next={lane:0,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),h=U.hasEagerState?U.eagerState:s(h,U.action);else{var X={lane:Z,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null};T===null?(C=T=X,x=h):T=T.next=X,at.lanes|=Z,$a|=Z}U=U.next}while(U!==null&&U!==v);T===null?x=h:T.next=C,Tn(h,i.memoizedState)||(Gt=!0),i.memoizedState=h,i.baseState=x,i.baseQueue=T,u.lastRenderedState=h}if(s=u.interleaved,s!==null){m=s;do v=m.lane,at.lanes|=v,$a|=v,m=m.next;while(m!==s)}else m===null&&(u.lanes=0);return[i.memoizedState,u.dispatch]}function rf(s){var i=Sn(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var h=u.dispatch,m=u.pending,v=i.memoizedState;if(m!==null){u.pending=null;var x=m=m.next;do v=s(v,x.action),x=x.next;while(x!==m);Tn(v,i.memoizedState)||(Gt=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),u.lastRenderedState=v}return[v,h]}function my(){}function gy(s,i){var u=at,h=Sn(),m=i(),v=!Tn(h.memoizedState,m);if(v&&(h.memoizedState=m,Gt=!0),h=h.queue,af(wy.bind(null,u,h,s),[s]),h.getSnapshot!==i||v||vt!==null&&vt.memoizedState.tag&1){if(u.flags|=2048,Xi(9,vy.bind(null,u,h,m,i),void 0,null),wt===null)throw Error(t(349));Na&30||yy(u,i,m)}return m}function yy(s,i,u){s.flags|=16384,s={getSnapshot:i,value:u},i=at.updateQueue,i===null?(i={lastEffect:null,stores:null},at.updateQueue=i,i.stores=[s]):(u=i.stores,u===null?i.stores=[s]:u.push(s))}function vy(s,i,u,h){i.value=u,i.getSnapshot=h,_y(i)&&by(s)}function wy(s,i,u){return u(function(){_y(i)&&by(s)})}function _y(s){var i=s.getSnapshot;s=s.value;try{var u=i();return!Tn(s,u)}catch{return!0}}function by(s){var i=wr(s,1);i!==null&&jn(i,s,1,-1)}function xy(s){var i=nr();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:s},i.queue=s,s=s.dispatch=kE.bind(null,at,s),[i.memoizedState,s]}function Xi(s,i,u,h){return s={tag:s,create:i,destroy:u,deps:h,next:null},i=at.updateQueue,i===null?(i={lastEffect:null,stores:null},at.updateQueue=i,i.lastEffect=s.next=s):(u=i.lastEffect,u===null?i.lastEffect=s.next=s:(h=u.next,u.next=s,s.next=h,i.lastEffect=s)),s}function Sy(){return Sn().memoizedState}function au(s,i,u,h){var m=nr();at.flags|=s,m.memoizedState=Xi(1|i,u,void 0,h===void 0?null:h)}function su(s,i,u,h){var m=Sn();h=h===void 0?null:h;var v=void 0;if(ht!==null){var x=ht.memoizedState;if(v=x.destroy,h!==null&&Yd(h,x.deps)){m.memoizedState=Xi(i,u,v,h);return}}at.flags|=s,m.memoizedState=Xi(1|i,u,v,h)}function Ey(s,i){return au(8390656,8,s,i)}function af(s,i){return su(2048,8,s,i)}function ky(s,i){return su(4,2,s,i)}function Cy(s,i){return su(4,4,s,i)}function Py(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Ry(s,i,u){return u=u!=null?u.concat([s]):null,su(4,4,Py.bind(null,i,s),u)}function sf(){}function Oy(s,i){var u=Sn();i=i===void 0?null:i;var h=u.memoizedState;return h!==null&&i!==null&&Yd(i,h[1])?h[0]:(u.memoizedState=[s,i],s)}function Ty(s,i){var u=Sn();i=i===void 0?null:i;var h=u.memoizedState;return h!==null&&i!==null&&Yd(i,h[1])?h[0]:(s=s(),u.memoizedState=[s,i],s)}function Ay(s,i,u){return Na&21?(Tn(u,i)||(u=og(),at.lanes|=u,$a|=u,s.baseState=!0),i):(s.baseState&&(s.baseState=!1,Gt=!0),s.memoizedState=u)}function SE(s,i){var u=qe;qe=u!==0&&4>u?u:4,s(!0);var h=Qd.transition;Qd.transition={};try{s(!1),i()}finally{qe=u,Qd.transition=h}}function Iy(){return Sn().memoizedState}function EE(s,i,u){var h=ta(s);if(u={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null},Ny(s))$y(i,u);else if(u=cy(s,i,u,h),u!==null){var m=Ft();jn(u,s,h,m),jy(u,i,h)}}function kE(s,i,u){var h=ta(s),m={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null};if(Ny(s))$y(i,m);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var x=i.lastRenderedState,C=v(x,u);if(m.hasEagerState=!0,m.eagerState=C,Tn(C,x)){var T=i.interleaved;T===null?(m.next=m,Wd(i)):(m.next=T.next,T.next=m),i.interleaved=m;return}}catch{}finally{}u=cy(s,i,m,h),u!==null&&(m=Ft(),jn(u,s,h,m),jy(u,i,h))}}function Ny(s){var i=s.alternate;return s===at||i!==null&&i===at}function $y(s,i){Gi=ru=!0;var u=s.pending;u===null?i.next=i:(i.next=u.next,u.next=i),s.pending=i}function jy(s,i,u){if(u&4194240){var h=i.lanes;h&=s.pendingLanes,u|=h,i.lanes=u,od(s,u)}}var iu={readContext:xn,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useInsertionEffect:At,useLayoutEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useMutableSource:At,useSyncExternalStore:At,useId:At,unstable_isNewReconciler:!1},CE={readContext:xn,useCallback:function(s,i){return nr().memoizedState=[s,i===void 0?null:i],s},useContext:xn,useEffect:Ey,useImperativeHandle:function(s,i,u){return u=u!=null?u.concat([s]):null,au(4194308,4,Py.bind(null,i,s),u)},useLayoutEffect:function(s,i){return au(4194308,4,s,i)},useInsertionEffect:function(s,i){return au(4,2,s,i)},useMemo:function(s,i){var u=nr();return i=i===void 0?null:i,s=s(),u.memoizedState=[s,i],s},useReducer:function(s,i,u){var h=nr();return i=u!==void 0?u(i):i,h.memoizedState=h.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},h.queue=s,s=s.dispatch=EE.bind(null,at,s),[h.memoizedState,s]},useRef:function(s){var i=nr();return s={current:s},i.memoizedState=s},useState:xy,useDebugValue:sf,useDeferredValue:function(s){return nr().memoizedState=s},useTransition:function(){var s=xy(!1),i=s[0];return s=SE.bind(null,s[1]),nr().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,u){var h=at,m=nr();if(tt){if(u===void 0)throw Error(t(407));u=u()}else{if(u=i(),wt===null)throw Error(t(349));Na&30||yy(h,i,u)}m.memoizedState=u;var v={value:u,getSnapshot:i};return m.queue=v,Ey(wy.bind(null,h,v,s),[s]),h.flags|=2048,Xi(9,vy.bind(null,h,v,u,i),void 0,null),u},useId:function(){var s=nr(),i=wt.identifierPrefix;if(tt){var u=vr,h=yr;u=(h&~(1<<32-On(h)-1)).toString(32)+u,i=":"+i+"R"+u,u=Ji++,0<u&&(i+="H"+u.toString(32)),i+=":"}else u=xE++,i=":"+i+"r"+u.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},PE={readContext:xn,useCallback:Oy,useContext:xn,useEffect:af,useImperativeHandle:Ry,useInsertionEffect:ky,useLayoutEffect:Cy,useMemo:Ty,useReducer:nf,useRef:Sy,useState:function(){return nf(Ki)},useDebugValue:sf,useDeferredValue:function(s){var i=Sn();return Ay(i,ht.memoizedState,s)},useTransition:function(){var s=nf(Ki)[0],i=Sn().memoizedState;return[s,i]},useMutableSource:my,useSyncExternalStore:gy,useId:Iy,unstable_isNewReconciler:!1},RE={readContext:xn,useCallback:Oy,useContext:xn,useEffect:af,useImperativeHandle:Ry,useInsertionEffect:ky,useLayoutEffect:Cy,useMemo:Ty,useReducer:rf,useRef:Sy,useState:function(){return rf(Ki)},useDebugValue:sf,useDeferredValue:function(s){var i=Sn();return ht===null?i.memoizedState=s:Ay(i,ht.memoizedState,s)},useTransition:function(){var s=rf(Ki)[0],i=Sn().memoizedState;return[s,i]},useMutableSource:my,useSyncExternalStore:gy,useId:Iy,unstable_isNewReconciler:!1};function In(s,i){if(s&&s.defaultProps){i=V({},i),s=s.defaultProps;for(var u in s)i[u]===void 0&&(i[u]=s[u]);return i}return i}function of(s,i,u,h){i=s.memoizedState,u=u(h,i),u=u==null?i:V({},i,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var ou={isMounted:function(s){return(s=s._reactInternals)?Ca(s)===s:!1},enqueueSetState:function(s,i,u){s=s._reactInternals;var h=Ft(),m=ta(s),v=_r(h,m);v.payload=i,u!=null&&(v.callback=u),i=Xr(s,v,m),i!==null&&(jn(i,s,m,h),Yl(i,s,m))},enqueueReplaceState:function(s,i,u){s=s._reactInternals;var h=Ft(),m=ta(s),v=_r(h,m);v.tag=1,v.payload=i,u!=null&&(v.callback=u),i=Xr(s,v,m),i!==null&&(jn(i,s,m,h),Yl(i,s,m))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var u=Ft(),h=ta(s),m=_r(u,h);m.tag=2,i!=null&&(m.callback=i),i=Xr(s,m,h),i!==null&&(jn(i,s,h,u),Yl(i,s,h))}};function Ly(s,i,u,h,m,v,x){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,v,x):i.prototype&&i.prototype.isPureReactComponent?!Mi(u,h)||!Mi(m,v):!0}function My(s,i,u){var h=!1,m=Gr,v=i.contextType;return typeof v=="object"&&v!==null?v=xn(v):(m=Zt(i)?Ra:Tt.current,h=i.contextTypes,v=(h=h!=null)?bs(s,m):Gr),i=new i(u,v),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=ou,s.stateNode=i,i._reactInternals=s,h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=m,s.__reactInternalMemoizedMaskedChildContext=v),i}function Dy(s,i,u,h){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,h),i.state!==s&&ou.enqueueReplaceState(i,i.state,null)}function lf(s,i,u,h){var m=s.stateNode;m.props=u,m.state=s.memoizedState,m.refs={},Zd(s);var v=i.contextType;typeof v=="object"&&v!==null?m.context=xn(v):(v=Zt(i)?Ra:Tt.current,m.context=bs(s,v)),m.state=s.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(of(s,i,v,u),m.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(i=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),i!==m.state&&ou.enqueueReplaceState(m,m.state,null),eu(s,u,m,h),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308)}function Os(s,i){try{var u="",h=i;do u+=ie(h),h=h.return;while(h);var m=u}catch(v){m=`
Error generating stack: `+v.message+`
`+v.stack}return{value:s,source:i,stack:m,digest:null}}function uf(s,i,u){return{value:s,source:null,stack:u??null,digest:i??null}}function cf(s,i){try{console.error(i.value)}catch(u){setTimeout(function(){throw u})}}var OE=typeof WeakMap=="function"?WeakMap:Map;function Fy(s,i,u){u=_r(-1,u),u.tag=3,u.payload={element:null};var h=i.value;return u.callback=function(){pu||(pu=!0,kf=h),cf(s,i)},u}function Uy(s,i,u){u=_r(-1,u),u.tag=3;var h=s.type.getDerivedStateFromError;if(typeof h=="function"){var m=i.value;u.payload=function(){return h(m)},u.callback=function(){cf(s,i)}}var v=s.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(u.callback=function(){cf(s,i),typeof h!="function"&&(Yr===null?Yr=new Set([this]):Yr.add(this));var x=i.stack;this.componentDidCatch(i.value,{componentStack:x!==null?x:""})}),u}function zy(s,i,u){var h=s.pingCache;if(h===null){h=s.pingCache=new OE;var m=new Set;h.set(i,m)}else m=h.get(i),m===void 0&&(m=new Set,h.set(i,m));m.has(u)||(m.add(u),s=HE.bind(null,s,i,u),i.then(s,s))}function By(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Hy(s,i,u,h,m){return s.mode&1?(s.flags|=65536,s.lanes=m,s):(s===i?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(i=_r(-1,1),i.tag=2,Xr(u,i,1))),u.lanes|=1),s)}var TE=N.ReactCurrentOwner,Gt=!1;function Dt(s,i,u,h){i.child=s===null?uy(i,null,u,h):ks(i,s.child,u,h)}function Vy(s,i,u,h,m){u=u.render;var v=i.ref;return Ps(i,m),h=ef(s,i,u,h,v,m),u=tf(),s!==null&&!Gt?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~m,br(s,i,m)):(tt&&u&&Md(i),i.flags|=1,Dt(s,i,h,m),i.child)}function qy(s,i,u,h,m){if(s===null){var v=u.type;return typeof v=="function"&&!If(v)&&v.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(i.tag=15,i.type=v,Wy(s,i,v,h,m)):(s=_u(u.type,null,h,i,i.mode,m),s.ref=i.ref,s.return=i,i.child=s)}if(v=s.child,!(s.lanes&m)){var x=v.memoizedProps;if(u=u.compare,u=u!==null?u:Mi,u(x,h)&&s.ref===i.ref)return br(s,i,m)}return i.flags|=1,s=ra(v,h),s.ref=i.ref,s.return=i,i.child=s}function Wy(s,i,u,h,m){if(s!==null){var v=s.memoizedProps;if(Mi(v,h)&&s.ref===i.ref)if(Gt=!1,i.pendingProps=h=v,(s.lanes&m)!==0)s.flags&131072&&(Gt=!0);else return i.lanes=s.lanes,br(s,i,m)}return df(s,i,u,h,m)}function Zy(s,i,u){var h=i.pendingProps,m=h.children,v=s!==null?s.memoizedState:null;if(h.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(As,on),on|=u;else{if(!(u&1073741824))return s=v!==null?v.baseLanes|u:u,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,Xe(As,on),on|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:u,Xe(As,on),on|=h}else v!==null?(h=v.baseLanes|u,i.memoizedState=null):h=u,Xe(As,on),on|=h;return Dt(s,i,m,u),i.child}function Gy(s,i){var u=i.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(i.flags|=512,i.flags|=2097152)}function df(s,i,u,h,m){var v=Zt(u)?Ra:Tt.current;return v=bs(i,v),Ps(i,m),u=ef(s,i,u,h,v,m),h=tf(),s!==null&&!Gt?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~m,br(s,i,m)):(tt&&h&&Md(i),i.flags|=1,Dt(s,i,u,m),i.child)}function Jy(s,i,u,h,m){if(Zt(u)){var v=!0;ql(i)}else v=!1;if(Ps(i,m),i.stateNode===null)uu(s,i),My(i,u,h),lf(i,u,h,m),h=!0;else if(s===null){var x=i.stateNode,C=i.memoizedProps;x.props=C;var T=x.context,U=u.contextType;typeof U=="object"&&U!==null?U=xn(U):(U=Zt(u)?Ra:Tt.current,U=bs(i,U));var Z=u.getDerivedStateFromProps,X=typeof Z=="function"||typeof x.getSnapshotBeforeUpdate=="function";X||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(C!==h||T!==U)&&Dy(i,x,h,U),Kr=!1;var W=i.memoizedState;x.state=W,eu(i,h,x,m),T=i.memoizedState,C!==h||W!==T||Wt.current||Kr?(typeof Z=="function"&&(of(i,u,Z,h),T=i.memoizedState),(C=Kr||Ly(i,u,C,h,W,T,U))?(X||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(i.flags|=4194308)):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=T),x.props=h,x.state=T,x.context=U,h=C):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{x=i.stateNode,dy(s,i),C=i.memoizedProps,U=i.type===i.elementType?C:In(i.type,C),x.props=U,X=i.pendingProps,W=x.context,T=u.contextType,typeof T=="object"&&T!==null?T=xn(T):(T=Zt(u)?Ra:Tt.current,T=bs(i,T));var le=u.getDerivedStateFromProps;(Z=typeof le=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(C!==X||W!==T)&&Dy(i,x,h,T),Kr=!1,W=i.memoizedState,x.state=W,eu(i,h,x,m);var de=i.memoizedState;C!==X||W!==de||Wt.current||Kr?(typeof le=="function"&&(of(i,u,le,h),de=i.memoizedState),(U=Kr||Ly(i,u,U,h,W,de,T)||!1)?(Z||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,de,T),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,de,T)),typeof x.componentDidUpdate=="function"&&(i.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof x.componentDidUpdate!="function"||C===s.memoizedProps&&W===s.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&W===s.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=de),x.props=h,x.state=de,x.context=T,h=U):(typeof x.componentDidUpdate!="function"||C===s.memoizedProps&&W===s.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&W===s.memoizedState||(i.flags|=1024),h=!1)}return ff(s,i,u,h,v,m)}function ff(s,i,u,h,m,v){Gy(s,i);var x=(i.flags&128)!==0;if(!h&&!x)return m&&ey(i,u,!1),br(s,i,v);h=i.stateNode,TE.current=i;var C=x&&typeof u.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,s!==null&&x?(i.child=ks(i,s.child,null,v),i.child=ks(i,null,C,v)):Dt(s,i,C,v),i.memoizedState=h.state,m&&ey(i,u,!0),i.child}function Ky(s){var i=s.stateNode;i.pendingContext?Qg(s,i.pendingContext,i.pendingContext!==i.context):i.context&&Qg(s,i.context,!1),Gd(s,i.containerInfo)}function Xy(s,i,u,h,m){return Es(),zd(m),i.flags|=256,Dt(s,i,u,h),i.child}var hf={dehydrated:null,treeContext:null,retryLane:0};function pf(s){return{baseLanes:s,cachePool:null,transitions:null}}function Qy(s,i,u){var h=i.pendingProps,m=rt.current,v=!1,x=(i.flags&128)!==0,C;if((C=x)||(C=s!==null&&s.memoizedState===null?!1:(m&2)!==0),C?(v=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(m|=1),Xe(rt,m&1),s===null)return Ud(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(i.mode&1?s.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(x=h.children,s=h.fallback,v?(h=i.mode,v=i.child,x={mode:"hidden",children:x},!(h&1)&&v!==null?(v.childLanes=0,v.pendingProps=x):v=bu(x,h,0,null),s=Da(s,h,u,null),v.return=i,s.return=i,v.sibling=s,i.child=v,i.child.memoizedState=pf(u),i.memoizedState=hf,s):mf(i,x));if(m=s.memoizedState,m!==null&&(C=m.dehydrated,C!==null))return AE(s,i,x,h,C,m,u);if(v){v=h.fallback,x=i.mode,m=s.child,C=m.sibling;var T={mode:"hidden",children:h.children};return!(x&1)&&i.child!==m?(h=i.child,h.childLanes=0,h.pendingProps=T,i.deletions=null):(h=ra(m,T),h.subtreeFlags=m.subtreeFlags&14680064),C!==null?v=ra(C,v):(v=Da(v,x,u,null),v.flags|=2),v.return=i,h.return=i,h.sibling=v,i.child=h,h=v,v=i.child,x=s.child.memoizedState,x=x===null?pf(u):{baseLanes:x.baseLanes|u,cachePool:null,transitions:x.transitions},v.memoizedState=x,v.childLanes=s.childLanes&~u,i.memoizedState=hf,h}return v=s.child,s=v.sibling,h=ra(v,{mode:"visible",children:h.children}),!(i.mode&1)&&(h.lanes=u),h.return=i,h.sibling=null,s!==null&&(u=i.deletions,u===null?(i.deletions=[s],i.flags|=16):u.push(s)),i.child=h,i.memoizedState=null,h}function mf(s,i){return i=bu({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function lu(s,i,u,h){return h!==null&&zd(h),ks(i,s.child,null,u),s=mf(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function AE(s,i,u,h,m,v,x){if(u)return i.flags&256?(i.flags&=-257,h=uf(Error(t(422))),lu(s,i,x,h)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(v=h.fallback,m=i.mode,h=bu({mode:"visible",children:h.children},m,0,null),v=Da(v,m,x,null),v.flags|=2,h.return=i,v.return=i,h.sibling=v,i.child=h,i.mode&1&&ks(i,s.child,null,x),i.child.memoizedState=pf(x),i.memoizedState=hf,v);if(!(i.mode&1))return lu(s,i,x,null);if(m.data==="$!"){if(h=m.nextSibling&&m.nextSibling.dataset,h)var C=h.dgst;return h=C,v=Error(t(419)),h=uf(v,h,void 0),lu(s,i,x,h)}if(C=(x&s.childLanes)!==0,Gt||C){if(h=wt,h!==null){switch(x&-x){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=m&(h.suspendedLanes|x)?0:m,m!==0&&m!==v.retryLane&&(v.retryLane=m,wr(s,m),jn(h,s,m,-1))}return Af(),h=uf(Error(t(421))),lu(s,i,x,h)}return m.data==="$?"?(i.flags|=128,i.child=s.child,i=VE.bind(null,s),m._reactRetry=i,null):(s=v.treeContext,sn=Wr(m.nextSibling),an=i,tt=!0,An=null,s!==null&&(_n[bn++]=yr,_n[bn++]=vr,_n[bn++]=Oa,yr=s.id,vr=s.overflow,Oa=i),i=mf(i,h.children),i.flags|=4096,i)}function Yy(s,i,u){s.lanes|=i;var h=s.alternate;h!==null&&(h.lanes|=i),qd(s.return,i,u)}function gf(s,i,u,h,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:m}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=u,v.tailMode=m)}function ev(s,i,u){var h=i.pendingProps,m=h.revealOrder,v=h.tail;if(Dt(s,i,h.children,u),h=rt.current,h&2)h=h&1|2,i.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Yy(s,u,i);else if(s.tag===19)Yy(s,u,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}if(Xe(rt,h),!(i.mode&1))i.memoizedState=null;else switch(m){case"forwards":for(u=i.child,m=null;u!==null;)s=u.alternate,s!==null&&tu(s)===null&&(m=u),u=u.sibling;u=m,u===null?(m=i.child,i.child=null):(m=u.sibling,u.sibling=null),gf(i,!1,m,u,v);break;case"backwards":for(u=null,m=i.child,i.child=null;m!==null;){if(s=m.alternate,s!==null&&tu(s)===null){i.child=m;break}s=m.sibling,m.sibling=u,u=m,m=s}gf(i,!0,u,null,v);break;case"together":gf(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function uu(s,i){!(i.mode&1)&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function br(s,i,u){if(s!==null&&(i.dependencies=s.dependencies),$a|=i.lanes,!(u&i.childLanes))return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,u=ra(s,s.pendingProps),i.child=u,u.return=i;s.sibling!==null;)s=s.sibling,u=u.sibling=ra(s,s.pendingProps),u.return=i;u.sibling=null}return i.child}function IE(s,i,u){switch(i.tag){case 3:Ky(i),Es();break;case 5:py(i);break;case 1:Zt(i.type)&&ql(i);break;case 4:Gd(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,m=i.memoizedProps.value;Xe(Xl,h._currentValue),h._currentValue=m;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(Xe(rt,rt.current&1),i.flags|=128,null):u&i.child.childLanes?Qy(s,i,u):(Xe(rt,rt.current&1),s=br(s,i,u),s!==null?s.sibling:null);Xe(rt,rt.current&1);break;case 19:if(h=(u&i.childLanes)!==0,s.flags&128){if(h)return ev(s,i,u);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Xe(rt,rt.current),h)break;return null;case 22:case 23:return i.lanes=0,Zy(s,i,u)}return br(s,i,u)}var tv,yf,nv,rv;tv=function(s,i){for(var u=i.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},yf=function(){},nv=function(s,i,u,h){var m=s.memoizedProps;if(m!==h){s=i.stateNode,Ia(tr.current);var v=null;switch(u){case"input":m=vi(s,m),h=vi(s,h),v=[];break;case"select":m=V({},m,{value:void 0}),h=V({},h,{value:void 0}),v=[];break;case"textarea":m=wi(s,m),h=wi(s,h),v=[];break;default:typeof m.onClick!="function"&&typeof h.onClick=="function"&&(s.onclick=Bl)}cs(u,h);var x;u=null;for(U in m)if(!h.hasOwnProperty(U)&&m.hasOwnProperty(U)&&m[U]!=null)if(U==="style"){var C=m[U];for(x in C)C.hasOwnProperty(x)&&(u||(u={}),u[x]="")}else U!=="dangerouslySetInnerHTML"&&U!=="children"&&U!=="suppressContentEditableWarning"&&U!=="suppressHydrationWarning"&&U!=="autoFocus"&&(a.hasOwnProperty(U)?v||(v=[]):(v=v||[]).push(U,null));for(U in h){var T=h[U];if(C=m!=null?m[U]:void 0,h.hasOwnProperty(U)&&T!==C&&(T!=null||C!=null))if(U==="style")if(C){for(x in C)!C.hasOwnProperty(x)||T&&T.hasOwnProperty(x)||(u||(u={}),u[x]="");for(x in T)T.hasOwnProperty(x)&&C[x]!==T[x]&&(u||(u={}),u[x]=T[x])}else u||(v||(v=[]),v.push(U,u)),u=T;else U==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,C=C?C.__html:void 0,T!=null&&C!==T&&(v=v||[]).push(U,T)):U==="children"?typeof T!="string"&&typeof T!="number"||(v=v||[]).push(U,""+T):U!=="suppressContentEditableWarning"&&U!=="suppressHydrationWarning"&&(a.hasOwnProperty(U)?(T!=null&&U==="onScroll"&&Qe("scroll",s),v||C===T||(v=[])):(v=v||[]).push(U,T))}u&&(v=v||[]).push("style",u);var U=v;(i.updateQueue=U)&&(i.flags|=4)}},rv=function(s,i,u,h){u!==h&&(i.flags|=4)};function Qi(s,i){if(!tt)switch(s.tailMode){case"hidden":i=s.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function It(s){var i=s.alternate!==null&&s.alternate.child===s.child,u=0,h=0;if(i)for(var m=s.child;m!==null;)u|=m.lanes|m.childLanes,h|=m.subtreeFlags&14680064,h|=m.flags&14680064,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)u|=m.lanes|m.childLanes,h|=m.subtreeFlags,h|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=h,s.childLanes=u,i}function NE(s,i,u){var h=i.pendingProps;switch(Dd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(i),null;case 1:return Zt(i.type)&&Vl(),It(i),null;case 3:return h=i.stateNode,Rs(),Ye(Wt),Ye(Tt),Xd(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Jl(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,An!==null&&(Rf(An),An=null))),yf(s,i),It(i),null;case 5:Jd(i);var m=Ia(Zi.current);if(u=i.type,s!==null&&i.stateNode!=null)nv(s,i,u,h,m),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return It(i),null}if(s=Ia(tr.current),Jl(i)){h=i.stateNode,u=i.type;var v=i.memoizedProps;switch(h[er]=i,h[Bi]=v,s=(i.mode&1)!==0,u){case"dialog":Qe("cancel",h),Qe("close",h);break;case"iframe":case"object":case"embed":Qe("load",h);break;case"video":case"audio":for(m=0;m<Fi.length;m++)Qe(Fi[m],h);break;case"source":Qe("error",h);break;case"img":case"image":case"link":Qe("error",h),Qe("load",h);break;case"details":Qe("toggle",h);break;case"input":as(h,v),Qe("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},Qe("invalid",h);break;case"textarea":Mt(h,v),Qe("invalid",h)}cs(u,v),m=null;for(var x in v)if(v.hasOwnProperty(x)){var C=v[x];x==="children"?typeof C=="string"?h.textContent!==C&&(v.suppressHydrationWarning!==!0&&zl(h.textContent,C,s),m=["children",C]):typeof C=="number"&&h.textContent!==""+C&&(v.suppressHydrationWarning!==!0&&zl(h.textContent,C,s),m=["children",""+C]):a.hasOwnProperty(x)&&C!=null&&x==="onScroll"&&Qe("scroll",h)}switch(u){case"input":yn(h),Ea(h,v,!0);break;case"textarea":yn(h),ml(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=Bl)}h=m,i.updateQueue=h,h!==null&&(i.flags|=4)}else{x=m.nodeType===9?m:m.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=gl(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=x.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof h.is=="string"?s=x.createElement(u,{is:h.is}):(s=x.createElement(u),u==="select"&&(x=s,h.multiple?x.multiple=!0:h.size&&(x.size=h.size))):s=x.createElementNS(s,u),s[er]=i,s[Bi]=h,tv(s,i,!1,!1),i.stateNode=s;e:{switch(x=_i(u,h),u){case"dialog":Qe("cancel",s),Qe("close",s),m=h;break;case"iframe":case"object":case"embed":Qe("load",s),m=h;break;case"video":case"audio":for(m=0;m<Fi.length;m++)Qe(Fi[m],s);m=h;break;case"source":Qe("error",s),m=h;break;case"img":case"image":case"link":Qe("error",s),Qe("load",s),m=h;break;case"details":Qe("toggle",s),m=h;break;case"input":as(s,h),m=vi(s,h),Qe("invalid",s);break;case"option":m=h;break;case"select":s._wrapperState={wasMultiple:!!h.multiple},m=V({},h,{value:void 0}),Qe("invalid",s);break;case"textarea":Mt(s,h),m=wi(s,h),Qe("invalid",s);break;default:m=h}cs(u,m),C=m;for(v in C)if(C.hasOwnProperty(v)){var T=C[v];v==="style"?vl(s,T):v==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,T!=null&&ls(s,T)):v==="children"?typeof T=="string"?(u!=="textarea"||T!=="")&&vn(s,T):typeof T=="number"&&vn(s,""+T):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(a.hasOwnProperty(v)?T!=null&&v==="onScroll"&&Qe("scroll",s):T!=null&&P(s,v,T,x))}switch(u){case"input":yn(s),Ea(s,h,!1);break;case"textarea":yn(s),ml(s);break;case"option":h.value!=null&&s.setAttribute("value",""+Ie(h.value));break;case"select":s.multiple=!!h.multiple,v=h.value,v!=null?Mr(s,!!h.multiple,v,!1):h.defaultValue!=null&&Mr(s,!!h.multiple,h.defaultValue,!0);break;default:typeof m.onClick=="function"&&(s.onclick=Bl)}switch(u){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return It(i),null;case 6:if(s&&i.stateNode!=null)rv(s,i,s.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(u=Ia(Zi.current),Ia(tr.current),Jl(i)){if(h=i.stateNode,u=i.memoizedProps,h[er]=i,(v=h.nodeValue!==u)&&(s=an,s!==null))switch(s.tag){case 3:zl(h.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&zl(h.nodeValue,u,(s.mode&1)!==0)}v&&(i.flags|=4)}else h=(u.nodeType===9?u:u.ownerDocument).createTextNode(h),h[er]=i,i.stateNode=h}return It(i),null;case 13:if(Ye(rt),h=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(tt&&sn!==null&&i.mode&1&&!(i.flags&128))iy(),Es(),i.flags|=98560,v=!1;else if(v=Jl(i),h!==null&&h.dehydrated!==null){if(s===null){if(!v)throw Error(t(318));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[er]=i}else Es(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;It(i),v=!1}else An!==null&&(Rf(An),An=null),v=!0;if(!v)return i.flags&65536?i:null}return i.flags&128?(i.lanes=u,i):(h=h!==null,h!==(s!==null&&s.memoizedState!==null)&&h&&(i.child.flags|=8192,i.mode&1&&(s===null||rt.current&1?pt===0&&(pt=3):Af())),i.updateQueue!==null&&(i.flags|=4),It(i),null);case 4:return Rs(),yf(s,i),s===null&&Ui(i.stateNode.containerInfo),It(i),null;case 10:return Vd(i.type._context),It(i),null;case 17:return Zt(i.type)&&Vl(),It(i),null;case 19:if(Ye(rt),v=i.memoizedState,v===null)return It(i),null;if(h=(i.flags&128)!==0,x=v.rendering,x===null)if(h)Qi(v,!1);else{if(pt!==0||s!==null&&s.flags&128)for(s=i.child;s!==null;){if(x=tu(s),x!==null){for(i.flags|=128,Qi(v,!1),h=x.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=u,u=i.child;u!==null;)v=u,s=h,v.flags&=14680066,x=v.alternate,x===null?(v.childLanes=0,v.lanes=s,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=x.childLanes,v.lanes=x.lanes,v.child=x.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=x.memoizedProps,v.memoizedState=x.memoizedState,v.updateQueue=x.updateQueue,v.type=x.type,s=x.dependencies,v.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return Xe(rt,rt.current&1|2),i.child}s=s.sibling}v.tail!==null&&ut()>Is&&(i.flags|=128,h=!0,Qi(v,!1),i.lanes=4194304)}else{if(!h)if(s=tu(x),s!==null){if(i.flags|=128,h=!0,u=s.updateQueue,u!==null&&(i.updateQueue=u,i.flags|=4),Qi(v,!0),v.tail===null&&v.tailMode==="hidden"&&!x.alternate&&!tt)return It(i),null}else 2*ut()-v.renderingStartTime>Is&&u!==1073741824&&(i.flags|=128,h=!0,Qi(v,!1),i.lanes=4194304);v.isBackwards?(x.sibling=i.child,i.child=x):(u=v.last,u!==null?u.sibling=x:i.child=x,v.last=x)}return v.tail!==null?(i=v.tail,v.rendering=i,v.tail=i.sibling,v.renderingStartTime=ut(),i.sibling=null,u=rt.current,Xe(rt,h?u&1|2:u&1),i):(It(i),null);case 22:case 23:return Tf(),h=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==h&&(i.flags|=8192),h&&i.mode&1?on&1073741824&&(It(i),i.subtreeFlags&6&&(i.flags|=8192)):It(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function $E(s,i){switch(Dd(i),i.tag){case 1:return Zt(i.type)&&Vl(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Rs(),Ye(Wt),Ye(Tt),Xd(),s=i.flags,s&65536&&!(s&128)?(i.flags=s&-65537|128,i):null;case 5:return Jd(i),null;case 13:if(Ye(rt),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Es()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return Ye(rt),null;case 4:return Rs(),null;case 10:return Vd(i.type._context),null;case 22:case 23:return Tf(),null;case 24:return null;default:return null}}var cu=!1,Nt=!1,jE=typeof WeakSet=="function"?WeakSet:Set,ce=null;function Ts(s,i){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(h){lt(s,i,h)}else u.current=null}function vf(s,i,u){try{u()}catch(h){lt(s,i,h)}}var av=!1;function LE(s,i){if(Od=Tl,s=Lg(),bd(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var m=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{u.nodeType,v.nodeType}catch{u=null;break e}var x=0,C=-1,T=-1,U=0,Z=0,X=s,W=null;t:for(;;){for(var le;X!==u||m!==0&&X.nodeType!==3||(C=x+m),X!==v||h!==0&&X.nodeType!==3||(T=x+h),X.nodeType===3&&(x+=X.nodeValue.length),(le=X.firstChild)!==null;)W=X,X=le;for(;;){if(X===s)break t;if(W===u&&++U===m&&(C=x),W===v&&++Z===h&&(T=x),(le=X.nextSibling)!==null)break;X=W,W=X.parentNode}X=le}u=C===-1||T===-1?null:{start:C,end:T}}else u=null}u=u||{start:0,end:0}}else u=null;for(Td={focusedElem:s,selectionRange:u},Tl=!1,ce=i;ce!==null;)if(i=ce,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,ce=s;else for(;ce!==null;){i=ce;try{var de=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(de!==null){var fe=de.memoizedProps,ct=de.memoizedState,L=i.stateNode,A=L.getSnapshotBeforeUpdate(i.elementType===i.type?fe:In(i.type,fe),ct);L.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var M=i.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(te){lt(i,i.return,te)}if(s=i.sibling,s!==null){s.return=i.return,ce=s;break}ce=i.return}return de=av,av=!1,de}function Yi(s,i,u){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var m=h=h.next;do{if((m.tag&s)===s){var v=m.destroy;m.destroy=void 0,v!==void 0&&vf(i,u,v)}m=m.next}while(m!==h)}}function du(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var u=i=i.next;do{if((u.tag&s)===s){var h=u.create;u.destroy=h()}u=u.next}while(u!==i)}}function wf(s){var i=s.ref;if(i!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof i=="function"?i(s):i.current=s}}function sv(s){var i=s.alternate;i!==null&&(s.alternate=null,sv(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[er],delete i[Bi],delete i[$d],delete i[vE],delete i[wE])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function iv(s){return s.tag===5||s.tag===3||s.tag===4}function ov(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||iv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function _f(s,i,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,i?u.nodeType===8?u.parentNode.insertBefore(s,i):u.insertBefore(s,i):(u.nodeType===8?(i=u.parentNode,i.insertBefore(s,u)):(i=u,i.appendChild(s)),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=Bl));else if(h!==4&&(s=s.child,s!==null))for(_f(s,i,u),s=s.sibling;s!==null;)_f(s,i,u),s=s.sibling}function bf(s,i,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,i?u.insertBefore(s,i):u.appendChild(s);else if(h!==4&&(s=s.child,s!==null))for(bf(s,i,u),s=s.sibling;s!==null;)bf(s,i,u),s=s.sibling}var kt=null,Nn=!1;function Qr(s,i,u){for(u=u.child;u!==null;)lv(s,i,u),u=u.sibling}function lv(s,i,u){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(El,u)}catch{}switch(u.tag){case 5:Nt||Ts(u,i);case 6:var h=kt,m=Nn;kt=null,Qr(s,i,u),kt=h,Nn=m,kt!==null&&(Nn?(s=kt,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):kt.removeChild(u.stateNode));break;case 18:kt!==null&&(Nn?(s=kt,u=u.stateNode,s.nodeType===8?Nd(s.parentNode,u):s.nodeType===1&&Nd(s,u),Ai(s)):Nd(kt,u.stateNode));break;case 4:h=kt,m=Nn,kt=u.stateNode.containerInfo,Nn=!0,Qr(s,i,u),kt=h,Nn=m;break;case 0:case 11:case 14:case 15:if(!Nt&&(h=u.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){m=h=h.next;do{var v=m,x=v.destroy;v=v.tag,x!==void 0&&(v&2||v&4)&&vf(u,i,x),m=m.next}while(m!==h)}Qr(s,i,u);break;case 1:if(!Nt&&(Ts(u,i),h=u.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=u.memoizedProps,h.state=u.memoizedState,h.componentWillUnmount()}catch(C){lt(u,i,C)}Qr(s,i,u);break;case 21:Qr(s,i,u);break;case 22:u.mode&1?(Nt=(h=Nt)||u.memoizedState!==null,Qr(s,i,u),Nt=h):Qr(s,i,u);break;default:Qr(s,i,u)}}function uv(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new jE),i.forEach(function(h){var m=qE.bind(null,s,h);u.has(h)||(u.add(h),h.then(m,m))})}}function $n(s,i){var u=i.deletions;if(u!==null)for(var h=0;h<u.length;h++){var m=u[h];try{var v=s,x=i,C=x;e:for(;C!==null;){switch(C.tag){case 5:kt=C.stateNode,Nn=!1;break e;case 3:kt=C.stateNode.containerInfo,Nn=!0;break e;case 4:kt=C.stateNode.containerInfo,Nn=!0;break e}C=C.return}if(kt===null)throw Error(t(160));lv(v,x,m),kt=null,Nn=!1;var T=m.alternate;T!==null&&(T.return=null),m.return=null}catch(U){lt(m,i,U)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)cv(i,s),i=i.sibling}function cv(s,i){var u=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if($n(i,s),rr(s),h&4){try{Yi(3,s,s.return),du(3,s)}catch(fe){lt(s,s.return,fe)}try{Yi(5,s,s.return)}catch(fe){lt(s,s.return,fe)}}break;case 1:$n(i,s),rr(s),h&512&&u!==null&&Ts(u,u.return);break;case 5:if($n(i,s),rr(s),h&512&&u!==null&&Ts(u,u.return),s.flags&32){var m=s.stateNode;try{vn(m,"")}catch(fe){lt(s,s.return,fe)}}if(h&4&&(m=s.stateNode,m!=null)){var v=s.memoizedProps,x=u!==null?u.memoizedProps:v,C=s.type,T=s.updateQueue;if(s.updateQueue=null,T!==null)try{C==="input"&&v.type==="radio"&&v.name!=null&&pl(m,v),_i(C,x);var U=_i(C,v);for(x=0;x<T.length;x+=2){var Z=T[x],X=T[x+1];Z==="style"?vl(m,X):Z==="dangerouslySetInnerHTML"?ls(m,X):Z==="children"?vn(m,X):P(m,Z,X,U)}switch(C){case"input":ss(m,v);break;case"textarea":pr(m,v);break;case"select":var W=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!v.multiple;var le=v.value;le!=null?Mr(m,!!v.multiple,le,!1):W!==!!v.multiple&&(v.defaultValue!=null?Mr(m,!!v.multiple,v.defaultValue,!0):Mr(m,!!v.multiple,v.multiple?[]:"",!1))}m[Bi]=v}catch(fe){lt(s,s.return,fe)}}break;case 6:if($n(i,s),rr(s),h&4){if(s.stateNode===null)throw Error(t(162));m=s.stateNode,v=s.memoizedProps;try{m.nodeValue=v}catch(fe){lt(s,s.return,fe)}}break;case 3:if($n(i,s),rr(s),h&4&&u!==null&&u.memoizedState.isDehydrated)try{Ai(i.containerInfo)}catch(fe){lt(s,s.return,fe)}break;case 4:$n(i,s),rr(s);break;case 13:$n(i,s),rr(s),m=s.child,m.flags&8192&&(v=m.memoizedState!==null,m.stateNode.isHidden=v,!v||m.alternate!==null&&m.alternate.memoizedState!==null||(Ef=ut())),h&4&&uv(s);break;case 22:if(Z=u!==null&&u.memoizedState!==null,s.mode&1?(Nt=(U=Nt)||Z,$n(i,s),Nt=U):$n(i,s),rr(s),h&8192){if(U=s.memoizedState!==null,(s.stateNode.isHidden=U)&&!Z&&s.mode&1)for(ce=s,Z=s.child;Z!==null;){for(X=ce=Z;ce!==null;){switch(W=ce,le=W.child,W.tag){case 0:case 11:case 14:case 15:Yi(4,W,W.return);break;case 1:Ts(W,W.return);var de=W.stateNode;if(typeof de.componentWillUnmount=="function"){h=W,u=W.return;try{i=h,de.props=i.memoizedProps,de.state=i.memoizedState,de.componentWillUnmount()}catch(fe){lt(h,u,fe)}}break;case 5:Ts(W,W.return);break;case 22:if(W.memoizedState!==null){hv(X);continue}}le!==null?(le.return=W,ce=le):hv(X)}Z=Z.sibling}e:for(Z=null,X=s;;){if(X.tag===5){if(Z===null){Z=X;try{m=X.stateNode,U?(v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(C=X.stateNode,T=X.memoizedProps.style,x=T!=null&&T.hasOwnProperty("display")?T.display:null,C.style.display=yl("display",x))}catch(fe){lt(s,s.return,fe)}}}else if(X.tag===6){if(Z===null)try{X.stateNode.nodeValue=U?"":X.memoizedProps}catch(fe){lt(s,s.return,fe)}}else if((X.tag!==22&&X.tag!==23||X.memoizedState===null||X===s)&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===s)break e;for(;X.sibling===null;){if(X.return===null||X.return===s)break e;Z===X&&(Z=null),X=X.return}Z===X&&(Z=null),X.sibling.return=X.return,X=X.sibling}}break;case 19:$n(i,s),rr(s),h&4&&uv(s);break;case 21:break;default:$n(i,s),rr(s)}}function rr(s){var i=s.flags;if(i&2){try{e:{for(var u=s.return;u!==null;){if(iv(u)){var h=u;break e}u=u.return}throw Error(t(160))}switch(h.tag){case 5:var m=h.stateNode;h.flags&32&&(vn(m,""),h.flags&=-33);var v=ov(s);bf(s,v,m);break;case 3:case 4:var x=h.stateNode.containerInfo,C=ov(s);_f(s,C,x);break;default:throw Error(t(161))}}catch(T){lt(s,s.return,T)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function ME(s,i,u){ce=s,dv(s)}function dv(s,i,u){for(var h=(s.mode&1)!==0;ce!==null;){var m=ce,v=m.child;if(m.tag===22&&h){var x=m.memoizedState!==null||cu;if(!x){var C=m.alternate,T=C!==null&&C.memoizedState!==null||Nt;C=cu;var U=Nt;if(cu=x,(Nt=T)&&!U)for(ce=m;ce!==null;)x=ce,T=x.child,x.tag===22&&x.memoizedState!==null?pv(m):T!==null?(T.return=x,ce=T):pv(m);for(;v!==null;)ce=v,dv(v),v=v.sibling;ce=m,cu=C,Nt=U}fv(s)}else m.subtreeFlags&8772&&v!==null?(v.return=m,ce=v):fv(s)}}function fv(s){for(;ce!==null;){var i=ce;if(i.flags&8772){var u=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:Nt||du(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!Nt)if(u===null)h.componentDidMount();else{var m=i.elementType===i.type?u.memoizedProps:In(i.type,u.memoizedProps);h.componentDidUpdate(m,u.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=i.updateQueue;v!==null&&hy(i,v,h);break;case 3:var x=i.updateQueue;if(x!==null){if(u=null,i.child!==null)switch(i.child.tag){case 5:u=i.child.stateNode;break;case 1:u=i.child.stateNode}hy(i,x,u)}break;case 5:var C=i.stateNode;if(u===null&&i.flags&4){u=C;var T=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":T.autoFocus&&u.focus();break;case"img":T.src&&(u.src=T.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var U=i.alternate;if(U!==null){var Z=U.memoizedState;if(Z!==null){var X=Z.dehydrated;X!==null&&Ai(X)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Nt||i.flags&512&&wf(i)}catch(W){lt(i,i.return,W)}}if(i===s){ce=null;break}if(u=i.sibling,u!==null){u.return=i.return,ce=u;break}ce=i.return}}function hv(s){for(;ce!==null;){var i=ce;if(i===s){ce=null;break}var u=i.sibling;if(u!==null){u.return=i.return,ce=u;break}ce=i.return}}function pv(s){for(;ce!==null;){var i=ce;try{switch(i.tag){case 0:case 11:case 15:var u=i.return;try{du(4,i)}catch(T){lt(i,u,T)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var m=i.return;try{h.componentDidMount()}catch(T){lt(i,m,T)}}var v=i.return;try{wf(i)}catch(T){lt(i,v,T)}break;case 5:var x=i.return;try{wf(i)}catch(T){lt(i,x,T)}}}catch(T){lt(i,i.return,T)}if(i===s){ce=null;break}var C=i.sibling;if(C!==null){C.return=i.return,ce=C;break}ce=i.return}}var DE=Math.ceil,fu=N.ReactCurrentDispatcher,xf=N.ReactCurrentOwner,En=N.ReactCurrentBatchConfig,Fe=0,wt=null,dt=null,Ct=0,on=0,As=Zr(0),pt=0,eo=null,$a=0,hu=0,Sf=0,to=null,Jt=null,Ef=0,Is=1/0,xr=null,pu=!1,kf=null,Yr=null,mu=!1,ea=null,gu=0,no=0,Cf=null,yu=-1,vu=0;function Ft(){return Fe&6?ut():yu!==-1?yu:yu=ut()}function ta(s){return s.mode&1?Fe&2&&Ct!==0?Ct&-Ct:bE.transition!==null?(vu===0&&(vu=og()),vu):(s=qe,s!==0||(s=window.event,s=s===void 0?16:gg(s.type)),s):1}function jn(s,i,u,h){if(50<no)throw no=0,Cf=null,Error(t(185));Ci(s,u,h),(!(Fe&2)||s!==wt)&&(s===wt&&(!(Fe&2)&&(hu|=u),pt===4&&na(s,Ct)),Kt(s,h),u===1&&Fe===0&&!(i.mode&1)&&(Is=ut()+500,Wl&&Jr()))}function Kt(s,i){var u=s.callbackNode;bS(s,i);var h=Pl(s,s===wt?Ct:0);if(h===0)u!==null&&ag(u),s.callbackNode=null,s.callbackPriority=0;else if(i=h&-h,s.callbackPriority!==i){if(u!=null&&ag(u),i===1)s.tag===0?_E(gv.bind(null,s)):ty(gv.bind(null,s)),gE(function(){!(Fe&6)&&Jr()}),u=null;else{switch(lg(h)){case 1:u=ad;break;case 4:u=sg;break;case 16:u=Sl;break;case 536870912:u=ig;break;default:u=Sl}u=Ev(u,mv.bind(null,s))}s.callbackPriority=i,s.callbackNode=u}}function mv(s,i){if(yu=-1,vu=0,Fe&6)throw Error(t(327));var u=s.callbackNode;if(Ns()&&s.callbackNode!==u)return null;var h=Pl(s,s===wt?Ct:0);if(h===0)return null;if(h&30||h&s.expiredLanes||i)i=wu(s,h);else{i=h;var m=Fe;Fe|=2;var v=vv();(wt!==s||Ct!==i)&&(xr=null,Is=ut()+500,La(s,i));do try{zE();break}catch(C){yv(s,C)}while(!0);Hd(),fu.current=v,Fe=m,dt!==null?i=0:(wt=null,Ct=0,i=pt)}if(i!==0){if(i===2&&(m=sd(s),m!==0&&(h=m,i=Pf(s,m))),i===1)throw u=eo,La(s,0),na(s,h),Kt(s,ut()),u;if(i===6)na(s,h);else{if(m=s.current.alternate,!(h&30)&&!FE(m)&&(i=wu(s,h),i===2&&(v=sd(s),v!==0&&(h=v,i=Pf(s,v))),i===1))throw u=eo,La(s,0),na(s,h),Kt(s,ut()),u;switch(s.finishedWork=m,s.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:Ma(s,Jt,xr);break;case 3:if(na(s,h),(h&130023424)===h&&(i=Ef+500-ut(),10<i)){if(Pl(s,0)!==0)break;if(m=s.suspendedLanes,(m&h)!==h){Ft(),s.pingedLanes|=s.suspendedLanes&m;break}s.timeoutHandle=Id(Ma.bind(null,s,Jt,xr),i);break}Ma(s,Jt,xr);break;case 4:if(na(s,h),(h&4194240)===h)break;for(i=s.eventTimes,m=-1;0<h;){var x=31-On(h);v=1<<x,x=i[x],x>m&&(m=x),h&=~v}if(h=m,h=ut()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*DE(h/1960))-h,10<h){s.timeoutHandle=Id(Ma.bind(null,s,Jt,xr),h);break}Ma(s,Jt,xr);break;case 5:Ma(s,Jt,xr);break;default:throw Error(t(329))}}}return Kt(s,ut()),s.callbackNode===u?mv.bind(null,s):null}function Pf(s,i){var u=to;return s.current.memoizedState.isDehydrated&&(La(s,i).flags|=256),s=wu(s,i),s!==2&&(i=Jt,Jt=u,i!==null&&Rf(i)),s}function Rf(s){Jt===null?Jt=s:Jt.push.apply(Jt,s)}function FE(s){for(var i=s;;){if(i.flags&16384){var u=i.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var h=0;h<u.length;h++){var m=u[h],v=m.getSnapshot;m=m.value;try{if(!Tn(v(),m))return!1}catch{return!1}}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function na(s,i){for(i&=~Sf,i&=~hu,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var u=31-On(i),h=1<<u;s[u]=-1,i&=~h}}function gv(s){if(Fe&6)throw Error(t(327));Ns();var i=Pl(s,0);if(!(i&1))return Kt(s,ut()),null;var u=wu(s,i);if(s.tag!==0&&u===2){var h=sd(s);h!==0&&(i=h,u=Pf(s,h))}if(u===1)throw u=eo,La(s,0),na(s,i),Kt(s,ut()),u;if(u===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,Ma(s,Jt,xr),Kt(s,ut()),null}function Of(s,i){var u=Fe;Fe|=1;try{return s(i)}finally{Fe=u,Fe===0&&(Is=ut()+500,Wl&&Jr())}}function ja(s){ea!==null&&ea.tag===0&&!(Fe&6)&&Ns();var i=Fe;Fe|=1;var u=En.transition,h=qe;try{if(En.transition=null,qe=1,s)return s()}finally{qe=h,En.transition=u,Fe=i,!(Fe&6)&&Jr()}}function Tf(){on=As.current,Ye(As)}function La(s,i){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,mE(u)),dt!==null)for(u=dt.return;u!==null;){var h=u;switch(Dd(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Vl();break;case 3:Rs(),Ye(Wt),Ye(Tt),Xd();break;case 5:Jd(h);break;case 4:Rs();break;case 13:Ye(rt);break;case 19:Ye(rt);break;case 10:Vd(h.type._context);break;case 22:case 23:Tf()}u=u.return}if(wt=s,dt=s=ra(s.current,null),Ct=on=i,pt=0,eo=null,Sf=hu=$a=0,Jt=to=null,Aa!==null){for(i=0;i<Aa.length;i++)if(u=Aa[i],h=u.interleaved,h!==null){u.interleaved=null;var m=h.next,v=u.pending;if(v!==null){var x=v.next;v.next=m,h.next=x}u.pending=h}Aa=null}return s}function yv(s,i){do{var u=dt;try{if(Hd(),nu.current=iu,ru){for(var h=at.memoizedState;h!==null;){var m=h.queue;m!==null&&(m.pending=null),h=h.next}ru=!1}if(Na=0,vt=ht=at=null,Gi=!1,Ji=0,xf.current=null,u===null||u.return===null){pt=1,eo=i,dt=null;break}e:{var v=s,x=u.return,C=u,T=i;if(i=Ct,C.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){var U=T,Z=C,X=Z.tag;if(!(Z.mode&1)&&(X===0||X===11||X===15)){var W=Z.alternate;W?(Z.updateQueue=W.updateQueue,Z.memoizedState=W.memoizedState,Z.lanes=W.lanes):(Z.updateQueue=null,Z.memoizedState=null)}var le=By(x);if(le!==null){le.flags&=-257,Hy(le,x,C,v,i),le.mode&1&&zy(v,U,i),i=le,T=U;var de=i.updateQueue;if(de===null){var fe=new Set;fe.add(T),i.updateQueue=fe}else de.add(T);break e}else{if(!(i&1)){zy(v,U,i),Af();break e}T=Error(t(426))}}else if(tt&&C.mode&1){var ct=By(x);if(ct!==null){!(ct.flags&65536)&&(ct.flags|=256),Hy(ct,x,C,v,i),zd(Os(T,C));break e}}v=T=Os(T,C),pt!==4&&(pt=2),to===null?to=[v]:to.push(v),v=x;do{switch(v.tag){case 3:v.flags|=65536,i&=-i,v.lanes|=i;var L=Fy(v,T,i);fy(v,L);break e;case 1:C=T;var A=v.type,M=v.stateNode;if(!(v.flags&128)&&(typeof A.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(Yr===null||!Yr.has(M)))){v.flags|=65536,i&=-i,v.lanes|=i;var te=Uy(v,C,i);fy(v,te);break e}}v=v.return}while(v!==null)}_v(u)}catch(pe){i=pe,dt===u&&u!==null&&(dt=u=u.return);continue}break}while(!0)}function vv(){var s=fu.current;return fu.current=iu,s===null?iu:s}function Af(){(pt===0||pt===3||pt===2)&&(pt=4),wt===null||!($a&268435455)&&!(hu&268435455)||na(wt,Ct)}function wu(s,i){var u=Fe;Fe|=2;var h=vv();(wt!==s||Ct!==i)&&(xr=null,La(s,i));do try{UE();break}catch(m){yv(s,m)}while(!0);if(Hd(),Fe=u,fu.current=h,dt!==null)throw Error(t(261));return wt=null,Ct=0,pt}function UE(){for(;dt!==null;)wv(dt)}function zE(){for(;dt!==null&&!fS();)wv(dt)}function wv(s){var i=Sv(s.alternate,s,on);s.memoizedProps=s.pendingProps,i===null?_v(s):dt=i,xf.current=null}function _v(s){var i=s;do{var u=i.alternate;if(s=i.return,i.flags&32768){if(u=$E(u,i),u!==null){u.flags&=32767,dt=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{pt=6,dt=null;return}}else if(u=NE(u,i,on),u!==null){dt=u;return}if(i=i.sibling,i!==null){dt=i;return}dt=i=s}while(i!==null);pt===0&&(pt=5)}function Ma(s,i,u){var h=qe,m=En.transition;try{En.transition=null,qe=1,BE(s,i,u,h)}finally{En.transition=m,qe=h}return null}function BE(s,i,u,h){do Ns();while(ea!==null);if(Fe&6)throw Error(t(327));u=s.finishedWork;var m=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var v=u.lanes|u.childLanes;if(xS(s,v),s===wt&&(dt=wt=null,Ct=0),!(u.subtreeFlags&2064)&&!(u.flags&2064)||mu||(mu=!0,Ev(Sl,function(){return Ns(),null})),v=(u.flags&15990)!==0,u.subtreeFlags&15990||v){v=En.transition,En.transition=null;var x=qe;qe=1;var C=Fe;Fe|=4,xf.current=null,LE(s,u),cv(u,s),lE(Td),Tl=!!Od,Td=Od=null,s.current=u,ME(u),hS(),Fe=C,qe=x,En.transition=v}else s.current=u;if(mu&&(mu=!1,ea=s,gu=m),v=s.pendingLanes,v===0&&(Yr=null),gS(u.stateNode),Kt(s,ut()),i!==null)for(h=s.onRecoverableError,u=0;u<i.length;u++)m=i[u],h(m.value,{componentStack:m.stack,digest:m.digest});if(pu)throw pu=!1,s=kf,kf=null,s;return gu&1&&s.tag!==0&&Ns(),v=s.pendingLanes,v&1?s===Cf?no++:(no=0,Cf=s):no=0,Jr(),null}function Ns(){if(ea!==null){var s=lg(gu),i=En.transition,u=qe;try{if(En.transition=null,qe=16>s?16:s,ea===null)var h=!1;else{if(s=ea,ea=null,gu=0,Fe&6)throw Error(t(331));var m=Fe;for(Fe|=4,ce=s.current;ce!==null;){var v=ce,x=v.child;if(ce.flags&16){var C=v.deletions;if(C!==null){for(var T=0;T<C.length;T++){var U=C[T];for(ce=U;ce!==null;){var Z=ce;switch(Z.tag){case 0:case 11:case 15:Yi(8,Z,v)}var X=Z.child;if(X!==null)X.return=Z,ce=X;else for(;ce!==null;){Z=ce;var W=Z.sibling,le=Z.return;if(sv(Z),Z===U){ce=null;break}if(W!==null){W.return=le,ce=W;break}ce=le}}}var de=v.alternate;if(de!==null){var fe=de.child;if(fe!==null){de.child=null;do{var ct=fe.sibling;fe.sibling=null,fe=ct}while(fe!==null)}}ce=v}}if(v.subtreeFlags&2064&&x!==null)x.return=v,ce=x;else e:for(;ce!==null;){if(v=ce,v.flags&2048)switch(v.tag){case 0:case 11:case 15:Yi(9,v,v.return)}var L=v.sibling;if(L!==null){L.return=v.return,ce=L;break e}ce=v.return}}var A=s.current;for(ce=A;ce!==null;){x=ce;var M=x.child;if(x.subtreeFlags&2064&&M!==null)M.return=x,ce=M;else e:for(x=A;ce!==null;){if(C=ce,C.flags&2048)try{switch(C.tag){case 0:case 11:case 15:du(9,C)}}catch(pe){lt(C,C.return,pe)}if(C===x){ce=null;break e}var te=C.sibling;if(te!==null){te.return=C.return,ce=te;break e}ce=C.return}}if(Fe=m,Jr(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(El,s)}catch{}h=!0}return h}finally{qe=u,En.transition=i}}return!1}function bv(s,i,u){i=Os(u,i),i=Fy(s,i,1),s=Xr(s,i,1),i=Ft(),s!==null&&(Ci(s,1,i),Kt(s,i))}function lt(s,i,u){if(s.tag===3)bv(s,s,u);else for(;i!==null;){if(i.tag===3){bv(i,s,u);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Yr===null||!Yr.has(h))){s=Os(u,s),s=Uy(i,s,1),i=Xr(i,s,1),s=Ft(),i!==null&&(Ci(i,1,s),Kt(i,s));break}}i=i.return}}function HE(s,i,u){var h=s.pingCache;h!==null&&h.delete(i),i=Ft(),s.pingedLanes|=s.suspendedLanes&u,wt===s&&(Ct&u)===u&&(pt===4||pt===3&&(Ct&130023424)===Ct&&500>ut()-Ef?La(s,0):Sf|=u),Kt(s,i)}function xv(s,i){i===0&&(s.mode&1?(i=Cl,Cl<<=1,!(Cl&130023424)&&(Cl=4194304)):i=1);var u=Ft();s=wr(s,i),s!==null&&(Ci(s,i,u),Kt(s,u))}function VE(s){var i=s.memoizedState,u=0;i!==null&&(u=i.retryLane),xv(s,u)}function qE(s,i){var u=0;switch(s.tag){case 13:var h=s.stateNode,m=s.memoizedState;m!==null&&(u=m.retryLane);break;case 19:h=s.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),xv(s,u)}var Sv;Sv=function(s,i,u){if(s!==null)if(s.memoizedProps!==i.pendingProps||Wt.current)Gt=!0;else{if(!(s.lanes&u)&&!(i.flags&128))return Gt=!1,IE(s,i,u);Gt=!!(s.flags&131072)}else Gt=!1,tt&&i.flags&1048576&&ny(i,Gl,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;uu(s,i),s=i.pendingProps;var m=bs(i,Tt.current);Ps(i,u),m=ef(null,i,h,s,m,u);var v=tf();return i.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zt(h)?(v=!0,ql(i)):v=!1,i.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,Zd(i),m.updater=ou,i.stateNode=m,m._reactInternals=i,lf(i,h,s,u),i=ff(null,i,h,!0,v,u)):(i.tag=0,tt&&v&&Md(i),Dt(null,i,m,u),i=i.child),i;case 16:h=i.elementType;e:{switch(uu(s,i),s=i.pendingProps,m=h._init,h=m(h._payload),i.type=h,m=i.tag=ZE(h),s=In(h,s),m){case 0:i=df(null,i,h,s,u);break e;case 1:i=Jy(null,i,h,s,u);break e;case 11:i=Vy(null,i,h,s,u);break e;case 14:i=qy(null,i,h,In(h.type,s),u);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,m=i.pendingProps,m=i.elementType===h?m:In(h,m),df(s,i,h,m,u);case 1:return h=i.type,m=i.pendingProps,m=i.elementType===h?m:In(h,m),Jy(s,i,h,m,u);case 3:e:{if(Ky(i),s===null)throw Error(t(387));h=i.pendingProps,v=i.memoizedState,m=v.element,dy(s,i),eu(i,h,null,u);var x=i.memoizedState;if(h=x.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){m=Os(Error(t(423)),i),i=Xy(s,i,h,u,m);break e}else if(h!==m){m=Os(Error(t(424)),i),i=Xy(s,i,h,u,m);break e}else for(sn=Wr(i.stateNode.containerInfo.firstChild),an=i,tt=!0,An=null,u=uy(i,null,h,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Es(),h===m){i=br(s,i,u);break e}Dt(s,i,h,u)}i=i.child}return i;case 5:return py(i),s===null&&Ud(i),h=i.type,m=i.pendingProps,v=s!==null?s.memoizedProps:null,x=m.children,Ad(h,m)?x=null:v!==null&&Ad(h,v)&&(i.flags|=32),Gy(s,i),Dt(s,i,x,u),i.child;case 6:return s===null&&Ud(i),null;case 13:return Qy(s,i,u);case 4:return Gd(i,i.stateNode.containerInfo),h=i.pendingProps,s===null?i.child=ks(i,null,h,u):Dt(s,i,h,u),i.child;case 11:return h=i.type,m=i.pendingProps,m=i.elementType===h?m:In(h,m),Vy(s,i,h,m,u);case 7:return Dt(s,i,i.pendingProps,u),i.child;case 8:return Dt(s,i,i.pendingProps.children,u),i.child;case 12:return Dt(s,i,i.pendingProps.children,u),i.child;case 10:e:{if(h=i.type._context,m=i.pendingProps,v=i.memoizedProps,x=m.value,Xe(Xl,h._currentValue),h._currentValue=x,v!==null)if(Tn(v.value,x)){if(v.children===m.children&&!Wt.current){i=br(s,i,u);break e}}else for(v=i.child,v!==null&&(v.return=i);v!==null;){var C=v.dependencies;if(C!==null){x=v.child;for(var T=C.firstContext;T!==null;){if(T.context===h){if(v.tag===1){T=_r(-1,u&-u),T.tag=2;var U=v.updateQueue;if(U!==null){U=U.shared;var Z=U.pending;Z===null?T.next=T:(T.next=Z.next,Z.next=T),U.pending=T}}v.lanes|=u,T=v.alternate,T!==null&&(T.lanes|=u),qd(v.return,u,i),C.lanes|=u;break}T=T.next}}else if(v.tag===10)x=v.type===i.type?null:v.child;else if(v.tag===18){if(x=v.return,x===null)throw Error(t(341));x.lanes|=u,C=x.alternate,C!==null&&(C.lanes|=u),qd(x,u,i),x=v.sibling}else x=v.child;if(x!==null)x.return=v;else for(x=v;x!==null;){if(x===i){x=null;break}if(v=x.sibling,v!==null){v.return=x.return,x=v;break}x=x.return}v=x}Dt(s,i,m.children,u),i=i.child}return i;case 9:return m=i.type,h=i.pendingProps.children,Ps(i,u),m=xn(m),h=h(m),i.flags|=1,Dt(s,i,h,u),i.child;case 14:return h=i.type,m=In(h,i.pendingProps),m=In(h.type,m),qy(s,i,h,m,u);case 15:return Wy(s,i,i.type,i.pendingProps,u);case 17:return h=i.type,m=i.pendingProps,m=i.elementType===h?m:In(h,m),uu(s,i),i.tag=1,Zt(h)?(s=!0,ql(i)):s=!1,Ps(i,u),My(i,h,m),lf(i,h,m,u),ff(null,i,h,!0,s,u);case 19:return ev(s,i,u);case 22:return Zy(s,i,u)}throw Error(t(156,i.tag))};function Ev(s,i){return rg(s,i)}function WE(s,i,u,h){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(s,i,u,h){return new WE(s,i,u,h)}function If(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ZE(s){if(typeof s=="function")return If(s)?1:0;if(s!=null){if(s=s.$$typeof,s===me)return 11;if(s===G)return 14}return 2}function ra(s,i){var u=s.alternate;return u===null?(u=kn(s.tag,i,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=i,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,i=s.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function _u(s,i,u,h,m,v){var x=2;if(h=s,typeof s=="function")If(s)&&(x=1);else if(typeof s=="string")x=5;else e:switch(s){case z:return Da(u.children,m,v,i);case q:x=8,m|=8;break;case K:return s=kn(12,u,i,m|2),s.elementType=K,s.lanes=v,s;case Ue:return s=kn(13,u,i,m),s.elementType=Ue,s.lanes=v,s;case Y:return s=kn(19,u,i,m),s.elementType=Y,s.lanes=v,s;case Q:return bu(u,m,v,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case oe:x=10;break e;case he:x=9;break e;case me:x=11;break e;case G:x=14;break e;case ne:x=16,h=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=kn(x,u,i,m),i.elementType=s,i.type=h,i.lanes=v,i}function Da(s,i,u,h){return s=kn(7,s,h,i),s.lanes=u,s}function bu(s,i,u,h){return s=kn(22,s,h,i),s.elementType=Q,s.lanes=u,s.stateNode={isHidden:!1},s}function Nf(s,i,u){return s=kn(6,s,null,i),s.lanes=u,s}function $f(s,i,u){return i=kn(4,s.children!==null?s.children:[],s.key,i),i.lanes=u,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function GE(s,i,u,h,m){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=id(0),this.expirationTimes=id(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=id(0),this.identifierPrefix=h,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function jf(s,i,u,h,m,v,x,C,T){return s=new GE(s,i,u,C,T),i===1?(i=1,v===!0&&(i|=8)):i=0,v=kn(3,null,null,i),s.current=v,v.stateNode=s,v.memoizedState={element:h,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zd(v),s}function JE(s,i,u){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:h==null?null:""+h,children:s,containerInfo:i,implementation:u}}function kv(s){if(!s)return Gr;s=s._reactInternals;e:{if(Ca(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Zt(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var u=s.type;if(Zt(u))return Yg(s,u,i)}return i}function Cv(s,i,u,h,m,v,x,C,T){return s=jf(u,h,!0,s,m,v,x,C,T),s.context=kv(null),u=s.current,h=Ft(),m=ta(u),v=_r(h,m),v.callback=i??null,Xr(u,v,m),s.current.lanes=m,Ci(s,m,h),Kt(s,h),s}function xu(s,i,u,h){var m=i.current,v=Ft(),x=ta(m);return u=kv(u),i.context===null?i.context=u:i.pendingContext=u,i=_r(v,x),i.payload={element:s},h=h===void 0?null:h,h!==null&&(i.callback=h),s=Xr(m,i,x),s!==null&&(jn(s,m,x,v),Yl(s,m,x)),x}function Su(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function Pv(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<i?u:i}}function Lf(s,i){Pv(s,i),(s=s.alternate)&&Pv(s,i)}function KE(){return null}var Rv=typeof reportError=="function"?reportError:function(s){console.error(s)};function Mf(s){this._internalRoot=s}Eu.prototype.render=Mf.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));xu(s,i,null,null)},Eu.prototype.unmount=Mf.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;ja(function(){xu(null,s,null,null)}),i[mr]=null}};function Eu(s){this._internalRoot=s}Eu.prototype.unstable_scheduleHydration=function(s){if(s){var i=dg();s={blockedOn:null,target:s,priority:i};for(var u=0;u<Hr.length&&i!==0&&i<Hr[u].priority;u++);Hr.splice(u,0,s),u===0&&pg(s)}};function Df(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function ku(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Ov(){}function XE(s,i,u,h,m){if(m){if(typeof h=="function"){var v=h;h=function(){var U=Su(x);v.call(U)}}var x=Cv(i,h,s,0,null,!1,!1,"",Ov);return s._reactRootContainer=x,s[mr]=x.current,Ui(s.nodeType===8?s.parentNode:s),ja(),x}for(;m=s.lastChild;)s.removeChild(m);if(typeof h=="function"){var C=h;h=function(){var U=Su(T);C.call(U)}}var T=jf(s,0,!1,null,null,!1,!1,"",Ov);return s._reactRootContainer=T,s[mr]=T.current,Ui(s.nodeType===8?s.parentNode:s),ja(function(){xu(i,T,u,h)}),T}function Cu(s,i,u,h,m){var v=u._reactRootContainer;if(v){var x=v;if(typeof m=="function"){var C=m;m=function(){var T=Su(x);C.call(T)}}xu(i,x,s,m)}else x=XE(u,i,s,m,h);return Su(x)}ug=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var u=ki(i.pendingLanes);u!==0&&(od(i,u|1),Kt(i,ut()),!(Fe&6)&&(Is=ut()+500,Jr()))}break;case 13:ja(function(){var h=wr(s,1);if(h!==null){var m=Ft();jn(h,s,1,m)}}),Lf(s,1)}},ld=function(s){if(s.tag===13){var i=wr(s,134217728);if(i!==null){var u=Ft();jn(i,s,134217728,u)}Lf(s,134217728)}},cg=function(s){if(s.tag===13){var i=ta(s),u=wr(s,i);if(u!==null){var h=Ft();jn(u,s,i,h)}Lf(s,i)}},dg=function(){return qe},fg=function(s,i){var u=qe;try{return qe=s,i()}finally{qe=u}},bi=function(s,i,u){switch(i){case"input":if(ss(s,u),i=u.name,u.type==="radio"&&i!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<u.length;i++){var h=u[i];if(h!==s&&h.form===s.form){var m=Hl(h);if(!m)throw Error(t(90));hl(h),ss(h,m)}}}break;case"textarea":pr(s,u);break;case"select":i=u.value,i!=null&&Mr(s,!!u.multiple,i,!1)}},ds=Of,_l=ja;var QE={usingClientEntryPoint:!1,Events:[Hi,ws,Hl,qt,nn,Of]},ro={findFiberByHostInstance:Pa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},YE={bundleType:ro.bundleType,version:ro.version,rendererPackageName:ro.rendererPackageName,rendererConfig:ro.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=tg(s),s===null?null:s.stateNode},findFiberByHostInstance:ro.findFiberByHostInstance||KE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pu.isDisabled&&Pu.supportsFiber)try{El=Pu.inject(YE),Yn=Pu}catch{}}return Xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QE,Xt.createPortal=function(s,i){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Df(i))throw Error(t(200));return JE(s,i,null,u)},Xt.createRoot=function(s,i){if(!Df(s))throw Error(t(299));var u=!1,h="",m=Rv;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(m=i.onRecoverableError)),i=jf(s,1,!1,null,null,u,!1,h,m),s[mr]=i.current,Ui(s.nodeType===8?s.parentNode:s),new Mf(i)},Xt.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=tg(i),s=s===null?null:s.stateNode,s},Xt.flushSync=function(s){return ja(s)},Xt.hydrate=function(s,i,u){if(!ku(i))throw Error(t(200));return Cu(null,s,i,!0,u)},Xt.hydrateRoot=function(s,i,u){if(!Df(s))throw Error(t(405));var h=u!=null&&u.hydratedSources||null,m=!1,v="",x=Rv;if(u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onRecoverableError!==void 0&&(x=u.onRecoverableError)),i=Cv(i,null,s,1,u??null,m,!1,v,x),s[mr]=i.current,Ui(s),h)for(s=0;s<h.length;s++)u=h[s],m=u._getVersion,m=m(u._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[u,m]:i.mutableSourceEagerHydrationData.push(u,m);return new Eu(i)},Xt.render=function(s,i,u){if(!ku(i))throw Error(t(200));return Cu(null,s,i,!1,u)},Xt.unmountComponentAtNode=function(s){if(!ku(s))throw Error(t(40));return s._reactRootContainer?(ja(function(){Cu(null,null,s,!1,function(){s._reactRootContainer=null,s[mr]=null})}),!0):!1},Xt.unstable_batchedUpdates=Of,Xt.unstable_renderSubtreeIntoContainer=function(s,i,u,h){if(!ku(u))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Cu(s,i,u,!1,h)},Xt.version="18.3.1-next-f1338f8080-20240426",Xt}var Mv;function db(){if(Mv)return zf.exports;Mv=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),zf.exports=l1(),zf.exports}var Dv;function u1(){if(Dv)return Ru;Dv=1;var r=db();return Ru.createRoot=r.createRoot,Ru.hydrateRoot=r.hydrateRoot,Ru}var c1=u1(),so={},Fv;function d1(){if(Fv)return so;Fv=1,Object.defineProperty(so,"__esModule",{value:!0}),so.parse=l,so.serialize=f;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const g=function(){};return g.prototype=Object.create(null),g})();function l(g,w){const _=new o,S=g.length;if(S<2)return _;const b=(w==null?void 0:w.decode)||p;let k=0;do{const E=g.indexOf("=",k);if(E===-1)break;const P=g.indexOf(";",k),N=P===-1?S:P;if(E>N){k=g.lastIndexOf(";",E-1)+1;continue}const j=c(g,k,E),D=d(g,E,j),z=g.slice(j,D);if(_[z]===void 0){let q=c(g,E+1,N),K=d(g,N,q);const oe=b(g.slice(q,K));_[z]=oe}k=N+1}while(k<S);return _}function c(g,w,_){do{const S=g.charCodeAt(w);if(S!==32&&S!==9)return w}while(++w<_);return _}function d(g,w,_){for(;w>_;){const S=g.charCodeAt(--w);if(S!==32&&S!==9)return w+1}return _}function f(g,w,_){const S=(_==null?void 0:_.encode)||encodeURIComponent;if(!r.test(g))throw new TypeError(`argument name is invalid: ${g}`);const b=S(w);if(!e.test(b))throw new TypeError(`argument val is invalid: ${w}`);let k=g+"="+b;if(!_)return k;if(_.maxAge!==void 0){if(!Number.isInteger(_.maxAge))throw new TypeError(`option maxAge is invalid: ${_.maxAge}`);k+="; Max-Age="+_.maxAge}if(_.domain){if(!t.test(_.domain))throw new TypeError(`option domain is invalid: ${_.domain}`);k+="; Domain="+_.domain}if(_.path){if(!n.test(_.path))throw new TypeError(`option path is invalid: ${_.path}`);k+="; Path="+_.path}if(_.expires){if(!y(_.expires)||!Number.isFinite(_.expires.valueOf()))throw new TypeError(`option expires is invalid: ${_.expires}`);k+="; Expires="+_.expires.toUTCString()}if(_.httpOnly&&(k+="; HttpOnly"),_.secure&&(k+="; Secure"),_.partitioned&&(k+="; Partitioned"),_.priority)switch(typeof _.priority=="string"?_.priority.toLowerCase():void 0){case"low":k+="; Priority=Low";break;case"medium":k+="; Priority=Medium";break;case"high":k+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${_.priority}`)}if(_.sameSite)switch(typeof _.sameSite=="string"?_.sameSite.toLowerCase():_.sameSite){case!0:case"strict":k+="; SameSite=Strict";break;case"lax":k+="; SameSite=Lax";break;case"none":k+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${_.sameSite}`)}return k}function p(g){if(g.indexOf("%")===-1)return g;try{return decodeURIComponent(g)}catch{return g}}function y(g){return a.call(g)==="[object Date]"}return so}d1();/**
 * react-router v7.0.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Uv="popstate";function f1(r={}){function e(n,a){let{pathname:o,search:l,hash:c}=n.location;return vp("",{pathname:o,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(n,a){return typeof a=="string"?a:To(a)}return p1(e,t,null,r)}function ot(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function ba(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function h1(){return Math.random().toString(36).substring(2,10)}function zv(r,e){return{usr:r.state,key:r.key,idx:e}}function vp(r,e,t=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?si(e):e,state:t,key:e&&e.key||n||h1()}}function To({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function si(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substring(n),r=r.substring(0,n)),r&&(e.pathname=r)}return e}function p1(r,e,t,n={}){let{window:a=document.defaultView,v5Compat:o=!1}=n,l=a.history,c="POP",d=null,f=p();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function p(){return(l.state||{idx:null}).idx}function y(){c="POP";let b=p(),k=b==null?null:b-f;f=b,d&&d({action:c,location:S.location,delta:k})}function g(b,k){c="PUSH";let E=vp(S.location,b,k);f=p()+1;let P=zv(E,f),N=S.createHref(E);try{l.pushState(P,"",N)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(N)}o&&d&&d({action:c,location:S.location,delta:1})}function w(b,k){c="REPLACE";let E=vp(S.location,b,k);f=p();let P=zv(E,f),N=S.createHref(E);l.replaceState(P,"",N),o&&d&&d({action:c,location:S.location,delta:0})}function _(b){let k=a.location.origin!=="null"?a.location.origin:a.location.href,E=typeof b=="string"?b:To(b);return E=E.replace(/ $/,"%20"),ot(k,`No window.location.(origin|href) available to create URL for href: ${E}`),new URL(E,k)}let S={get action(){return c},get location(){return r(a,l)},listen(b){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(Uv,y),d=b,()=>{a.removeEventListener(Uv,y),d=null}},createHref(b){return e(a,b)},createURL:_,encodeLocation(b){let k=_(b);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:g,replace:w,go(b){return l.go(b)}};return S}function fb(r,e,t="/"){return m1(r,e,t,!1)}function m1(r,e,t,n){let a=typeof e=="string"?si(e):e,o=ma(a.pathname||"/",t);if(o==null)return null;let l=hb(r);g1(l);let c=null;for(let d=0;c==null&&d<l.length;++d){let f=P1(o);c=k1(l[d],f,n)}return c}function hb(r,e=[],t=[],n=""){let a=(o,l,c)=>{let d={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};d.relativePath.startsWith("/")&&(ot(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length));let f=Ir([n,d.relativePath]),p=t.concat(d);o.children&&o.children.length>0&&(ot(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),hb(o.children,e,p,f)),!(o.path==null&&!o.index)&&e.push({path:f,score:S1(f,o.index),routesMeta:p})};return r.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,l);else for(let d of pb(o.path))a(o,l,d)}),e}function pb(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(n.length===0)return a?[o,""]:[o];let l=pb(n.join("/")),c=[];return c.push(...l.map(d=>d===""?o:[o,d].join("/"))),a&&c.push(...l),c.map(d=>r.startsWith("/")&&d===""?"/":d)}function g1(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:E1(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var y1=/^:[\w-]+$/,v1=3,w1=2,_1=1,b1=10,x1=-2,Bv=r=>r==="*";function S1(r,e){let t=r.split("/"),n=t.length;return t.some(Bv)&&(n+=x1),e&&(n+=w1),t.filter(a=>!Bv(a)).reduce((a,o)=>a+(y1.test(o)?v1:o===""?_1:b1),n)}function E1(r,e){return r.length===e.length&&r.slice(0,-1).every((n,a)=>n===e[a])?r[r.length-1]-e[e.length-1]:0}function k1(r,e,t=!1){let{routesMeta:n}=r,a={},o="/",l=[];for(let c=0;c<n.length;++c){let d=n[c],f=c===n.length-1,p=o==="/"?e:e.slice(o.length)||"/",y=sc({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},p),g=d.route;if(!y&&f&&t&&!n[n.length-1].route.index&&(y=sc({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},p)),!y)return null;Object.assign(a,y.params),l.push({params:a,pathname:Ir([o,y.pathname]),pathnameBase:A1(Ir([o,y.pathnameBase])),route:g}),y.pathnameBase!=="/"&&(o=Ir([o,y.pathnameBase]))}return l}function sc(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=C1(r.path,r.caseSensitive,r.end),a=e.match(t);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:n.reduce((f,{paramName:p,isOptional:y},g)=>{if(p==="*"){let _=c[g]||"";l=o.slice(0,o.length-_.length).replace(/(.)\/+$/,"$1")}const w=c[g];return y&&!w?f[p]=void 0:f[p]=(w||"").replace(/%2F/g,"/"),f},{}),pathname:o,pathnameBase:l,pattern:r}}function C1(r,e=!1,t=!0){ba(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,d)=>(n.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function P1(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ba(!1,`The URL path "${r}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function ma(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function R1(r,e="/"){let{pathname:t,search:n="",hash:a=""}=typeof r=="string"?si(r):r;return{pathname:t?t.startsWith("/")?t:O1(t,e):e,search:I1(n),hash:N1(a)}}function O1(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Vf(r,e,t,n){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function T1(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function mb(r){let e=T1(r);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function gb(r,e,t,n=!1){let a;typeof r=="string"?a=si(r):(a={...r},ot(!a.pathname||!a.pathname.includes("?"),Vf("?","pathname","search",a)),ot(!a.pathname||!a.pathname.includes("#"),Vf("#","pathname","hash",a)),ot(!a.search||!a.search.includes("#"),Vf("#","search","hash",a)));let o=r===""||a.pathname==="",l=o?"/":a.pathname,c;if(l==null)c=t;else{let y=e.length-1;if(!n&&l.startsWith("..")){let g=l.split("/");for(;g[0]==="..";)g.shift(),y-=1;a.pathname=g.join("/")}c=y>=0?e[y]:"/"}let d=R1(a,c),f=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(f||p)&&(d.pathname+="/"),d}var Ir=r=>r.join("/").replace(/\/\/+/g,"/"),A1=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),I1=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,N1=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function $1(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var yb=["POST","PUT","PATCH","DELETE"];new Set(yb);var j1=["GET",...yb];new Set(j1);var ii=R.createContext(null);ii.displayName="DataRouter";var Nc=R.createContext(null);Nc.displayName="DataRouterState";var vb=R.createContext({isTransitioning:!1});vb.displayName="ViewTransition";var L1=R.createContext(new Map);L1.displayName="Fetchers";var M1=R.createContext(null);M1.displayName="Await";var fr=R.createContext(null);fr.displayName="Navigation";var Ko=R.createContext(null);Ko.displayName="Location";var Lr=R.createContext({outlet:null,matches:[],isDataRoute:!1});Lr.displayName="Route";var tm=R.createContext(null);tm.displayName="RouteError";function D1(r,{relative:e}={}){ot(Xo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=R.useContext(fr),{hash:a,pathname:o,search:l}=Qo(r,{relative:e}),c=o;return t!=="/"&&(c=o==="/"?t:Ir([t,o])),n.createHref({pathname:c,search:l,hash:a})}function Xo(){return R.useContext(Ko)!=null}function es(){return ot(Xo(),"useLocation() may be used only in the context of a <Router> component."),R.useContext(Ko).location}var wb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function _b(r){R.useContext(fr).static||R.useLayoutEffect(r)}function F1(){let{isDataRoute:r}=R.useContext(Lr);return r?Q1():U1()}function U1(){ot(Xo(),"useNavigate() may be used only in the context of a <Router> component.");let r=R.useContext(ii),{basename:e,navigator:t}=R.useContext(fr),{matches:n}=R.useContext(Lr),{pathname:a}=es(),o=JSON.stringify(mb(n)),l=R.useRef(!1);return _b(()=>{l.current=!0}),R.useCallback((d,f={})=>{if(ba(l.current,wb),!l.current)return;if(typeof d=="number"){t.go(d);return}let p=gb(d,JSON.parse(o),a,f.relative==="path");r==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Ir([e,p.pathname])),(f.replace?t.replace:t.push)(p,f.state,f)},[e,t,o,a,r])}R.createContext(null);function Qo(r,{relative:e}={}){let{matches:t}=R.useContext(Lr),{pathname:n}=es(),a=JSON.stringify(mb(t));return R.useMemo(()=>gb(r,JSON.parse(a),n,e==="path"),[r,a,n,e])}function z1(r,e){return bb(r,e)}function bb(r,e,t,n){var S;ot(Xo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=R.useContext(fr),{matches:o}=R.useContext(Lr),l=o[o.length-1],c=l?l.params:{};l&&l.pathname;let d=l?l.pathnameBase:"/";l&&l.route;let f=es(),p;if(e){let b=typeof e=="string"?si(e):e;ot(d==="/"||((S=b.pathname)==null?void 0:S.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${b.pathname}" was given in the \`location\` prop.`),p=b}else p=f;let y=p.pathname||"/",g=y;if(d!=="/"){let b=d.replace(/^\//,"").split("/");g="/"+y.replace(/^\//,"").split("/").slice(b.length).join("/")}let w=fb(r,{pathname:g}),_=W1(w&&w.map(b=>Object.assign({},b,{params:Object.assign({},c,b.params),pathname:Ir([d,a.encodeLocation?a.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?d:Ir([d,a.encodeLocation?a.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),o,t,n);return e&&_?R.createElement(Ko.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},_):_}function B1(){let r=X1(),e=$1(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),t?R.createElement("pre",{style:a},t):null,null)}var H1=R.createElement(B1,null),V1=class extends R.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){console.error("React Router caught the following error during render",r,e)}render(){return this.state.error!==void 0?R.createElement(Lr.Provider,{value:this.props.routeContext},R.createElement(tm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function q1({routeContext:r,match:e,children:t}){let n=R.useContext(ii);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),R.createElement(Lr.Provider,{value:r},t)}function W1(r,e=[],t=null,n=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let a=r,o=t==null?void 0:t.errors;if(o!=null){let d=a.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);ot(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,c=-1;if(t)for(let d=0;d<a.length;d++){let f=a[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=d),f.route.id){let{loaderData:p,errors:y}=t,g=f.route.loader&&!p.hasOwnProperty(f.route.id)&&(!y||y[f.route.id]===void 0);if(f.route.lazy||g){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((d,f,p)=>{let y,g=!1,w=null,_=null;t&&(y=o&&f.route.id?o[f.route.id]:void 0,w=f.route.errorElement||H1,l&&(c<0&&p===0?(Y1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,_=null):c===p&&(g=!0,_=f.route.hydrateFallbackElement||null)));let S=e.concat(a.slice(0,p+1)),b=()=>{let k;return y?k=w:g?k=_:f.route.Component?k=R.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=d,R.createElement(q1,{match:f,routeContext:{outlet:d,matches:S,isDataRoute:t!=null},children:k})};return t&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?R.createElement(V1,{location:t.location,revalidation:t.revalidation,component:w,error:y,children:b(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):b()},null)}function nm(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Z1(r){let e=R.useContext(ii);return ot(e,nm(r)),e}function G1(r){let e=R.useContext(Nc);return ot(e,nm(r)),e}function J1(r){let e=R.useContext(Lr);return ot(e,nm(r)),e}function rm(r){let e=J1(r),t=e.matches[e.matches.length-1];return ot(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function K1(){return rm("useRouteId")}function X1(){var n;let r=R.useContext(tm),e=G1("useRouteError"),t=rm("useRouteError");return r!==void 0?r:(n=e.errors)==null?void 0:n[t]}function Q1(){let{router:r}=Z1("useNavigate"),e=rm("useNavigate"),t=R.useRef(!1);return _b(()=>{t.current=!0}),R.useCallback(async(a,o={})=>{ba(t.current,wb),t.current&&(typeof a=="number"?r.navigate(a):await r.navigate(a,{fromRouteId:e,...o}))},[r,e])}var Hv={};function Y1(r,e,t){Hv[r]||(Hv[r]=!0,ba(!1,t))}R.memo(ek);function ek({routes:r,future:e,state:t}){return bb(r,void 0,t,e)}function wp(r){ot(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function tk({basename:r="/",children:e=null,location:t,navigationType:n="POP",navigator:a,static:o=!1}){ot(!Xo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=r.replace(/^\/*/,"/"),c=R.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof t=="string"&&(t=si(t));let{pathname:d="/",search:f="",hash:p="",state:y=null,key:g="default"}=t,w=R.useMemo(()=>{let _=ma(d,l);return _==null?null:{location:{pathname:_,search:f,hash:p,state:y,key:g},navigationType:n}},[l,d,f,p,y,g,n]);return ba(w!=null,`<Router basename="${l}"> is not able to match the URL "${d}${f}${p}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:R.createElement(fr.Provider,{value:c},R.createElement(Ko.Provider,{children:e,value:w}))}function nk({children:r,location:e}){return z1(_p(r),e)}function _p(r,e=[]){let t=[];return R.Children.forEach(r,(n,a)=>{if(!R.isValidElement(n))return;let o=[...e,a];if(n.type===R.Fragment){t.push.apply(t,_p(n.props.children,o));return}ot(n.type===wp,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ot(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=_p(n.props.children,o)),t.push(l)}),t}var Gu="get",Ju="application/x-www-form-urlencoded";function $c(r){return r!=null&&typeof r.tagName=="string"}function rk(r){return $c(r)&&r.tagName.toLowerCase()==="button"}function ak(r){return $c(r)&&r.tagName.toLowerCase()==="form"}function sk(r){return $c(r)&&r.tagName.toLowerCase()==="input"}function ik(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function ok(r,e){return r.button===0&&(!e||e==="_self")&&!ik(r)}var Ou=null;function lk(){if(Ou===null)try{new FormData(document.createElement("form"),0),Ou=!1}catch{Ou=!0}return Ou}var uk=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function qf(r){return r!=null&&!uk.has(r)?(ba(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ju}"`),null):r}function ck(r,e){let t,n,a,o,l;if(ak(r)){let c=r.getAttribute("action");n=c?ma(c,e):null,t=r.getAttribute("method")||Gu,a=qf(r.getAttribute("enctype"))||Ju,o=new FormData(r)}else if(rk(r)||sk(r)&&(r.type==="submit"||r.type==="image")){let c=r.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=r.getAttribute("formaction")||c.getAttribute("action");if(n=d?ma(d,e):null,t=r.getAttribute("formmethod")||c.getAttribute("method")||Gu,a=qf(r.getAttribute("formenctype"))||qf(c.getAttribute("enctype"))||Ju,o=new FormData(c,r),!lk()){let{name:f,type:p,value:y}=r;if(p==="image"){let g=f?`${f}.`:"";o.append(`${g}x`,"0"),o.append(`${g}y`,"0")}else f&&o.append(f,y)}}else{if($c(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Gu,n=null,a=Ju,l=r}return o&&a==="text/plain"&&(l=o,o=void 0),{action:n,method:t.toLowerCase(),encType:a,formData:o,body:l}}function am(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}async function dk(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function fk(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function hk(r,e,t){let n=await Promise.all(r.map(async a=>{let o=e.routes[a.route.id];if(o){let l=await dk(o,t);return l.links?l.links():[]}return[]}));return yk(n.flat(1).filter(fk).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Vv(r,e,t,n,a,o){let l=(d,f)=>t[f]?d.route.id!==t[f].route.id:!0,c=(d,f)=>{var p;return t[f].pathname!==d.pathname||((p=t[f].route.path)==null?void 0:p.endsWith("*"))&&t[f].params["*"]!==d.params["*"]};return o==="assets"?e.filter((d,f)=>l(d,f)||c(d,f)):o==="data"?e.filter((d,f)=>{var y;let p=n.routes[d.route.id];if(!p||!p.hasLoader)return!1;if(l(d,f)||c(d,f))return!0;if(d.route.shouldRevalidate){let g=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((y=t[0])==null?void 0:y.params)||{},nextUrl:new URL(r,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function pk(r,e){return mk(r.map(t=>{let n=e.routes[t.route.id];if(!n)return[];let a=[n.module];return n.imports&&(a=a.concat(n.imports)),a}).flat(1))}function mk(r){return[...new Set(r)]}function gk(r){let e={},t=Object.keys(r).sort();for(let n of t)e[n]=r[n];return e}function yk(r,e){let t=new Set;return new Set(e),r.reduce((n,a)=>{let o=JSON.stringify(gk(a));return t.has(o)||(t.add(o),n.push({key:o,link:a})),n},[])}function vk(r){let e=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function wk(){let r=R.useContext(ii);return am(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function _k(){let r=R.useContext(Nc);return am(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var sm=R.createContext(void 0);sm.displayName="FrameworkContext";function xb(){let r=R.useContext(sm);return am(r,"You must render this element inside a <HydratedRouter> element"),r}function bk(r,e){let t=R.useContext(sm),[n,a]=R.useState(!1),[o,l]=R.useState(!1),{onFocus:c,onBlur:d,onMouseEnter:f,onMouseLeave:p,onTouchStart:y}=e,g=R.useRef(null);R.useEffect(()=>{if(r==="render"&&l(!0),r==="viewport"){let S=k=>{k.forEach(E=>{l(E.isIntersecting)})},b=new IntersectionObserver(S,{threshold:.5});return g.current&&b.observe(g.current),()=>{b.disconnect()}}},[r]),R.useEffect(()=>{if(n){let S=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(S)}}},[n]);let w=()=>{a(!0)},_=()=>{a(!1),l(!1)};return t?r!=="intent"?[o,g,{}]:[o,g,{onFocus:io(c,w),onBlur:io(d,_),onMouseEnter:io(f,w),onMouseLeave:io(p,_),onTouchStart:io(y,w)}]:[!1,g,{}]}function io(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function xk({page:r,...e}){let{router:t}=wk(),n=R.useMemo(()=>fb(t.routes,r,t.basename),[t.routes,r,t.basename]);return n?R.createElement(Ek,{page:r,matches:n,...e}):(console.warn(`Tried to prefetch ${r} but no routes matched.`),null)}function Sk(r){let{manifest:e,routeModules:t}=xb(),[n,a]=R.useState([]);return R.useEffect(()=>{let o=!1;return hk(r,e,t).then(l=>{o||a(l)}),()=>{o=!0}},[r,e,t]),n}function Ek({page:r,matches:e,...t}){let n=es(),{manifest:a,routeModules:o}=xb(),{loaderData:l,matches:c}=_k(),d=R.useMemo(()=>Vv(r,e,c,a,n,"data"),[r,e,c,a,n]),f=R.useMemo(()=>Vv(r,e,c,a,n,"assets"),[r,e,c,a,n]),p=R.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let w=new Set,_=!1;if(e.forEach(b=>{var E;let k=a.routes[b.route.id];!k||!k.hasLoader||(!d.some(P=>P.route.id===b.route.id)&&b.route.id in l&&((E=o[b.route.id])!=null&&E.shouldRevalidate)||k.hasClientLoader?_=!0:w.add(b.route.id))}),w.size===0)return[];let S=vk(r);return _&&w.size>0&&S.searchParams.set("_routes",e.filter(b=>w.has(b.route.id)).map(b=>b.route.id).join(",")),[S.pathname+S.search]},[l,n,a,d,e,r,o]),y=R.useMemo(()=>pk(f,a),[f,a]),g=Sk(f);return R.createElement(R.Fragment,null,p.map(w=>R.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),y.map(w=>R.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),g.map(({key:w,link:_})=>R.createElement("link",{key:w,..._})))}function kk(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Sb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Sb&&(window.__reactRouterVersion="7.0.1")}catch{}function Ck({basename:r,children:e,window:t}){let n=R.useRef();n.current==null&&(n.current=f1({window:t,v5Compat:!0}));let a=n.current,[o,l]=R.useState({action:a.action,location:a.location}),c=R.useCallback(d=>{R.startTransition(()=>l(d))},[l]);return R.useLayoutEffect(()=>a.listen(c),[a,c]),R.createElement(tk,{basename:r,children:e,location:o.location,navigationType:o.action,navigator:a})}var Eb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ic=R.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:a,reloadDocument:o,replace:l,state:c,target:d,to:f,preventScrollReset:p,viewTransition:y,...g},w){let{basename:_}=R.useContext(fr),S=typeof f=="string"&&Eb.test(f),b,k=!1;if(typeof f=="string"&&S&&(b=f,Sb))try{let K=new URL(window.location.href),oe=f.startsWith("//")?new URL(K.protocol+f):new URL(f),he=ma(oe.pathname,_);oe.origin===K.origin&&he!=null?f=he+oe.search+oe.hash:k=!0}catch{ba(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=D1(f,{relative:a}),[P,N,j]=bk(n,g),D=Tk(f,{replace:l,state:c,target:d,preventScrollReset:p,relative:a,viewTransition:y});function z(K){e&&e(K),K.defaultPrevented||D(K)}let q=R.createElement("a",{...g,...j,href:b||E,onClick:k||o?e:z,ref:kk(w,N),target:d,"data-discover":!S&&t==="render"?"true":void 0});return P&&!S?R.createElement(R.Fragment,null,q,R.createElement(xk,{page:E})):q});ic.displayName="Link";var Pk=R.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:a=!1,style:o,to:l,viewTransition:c,children:d,...f},p){let y=Qo(l,{relative:f.relative}),g=es(),w=R.useContext(Nc),{navigator:_,basename:S}=R.useContext(fr),b=w!=null&&jk(y)&&c===!0,k=_.encodeLocation?_.encodeLocation(y).pathname:y.pathname,E=g.pathname,P=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;t||(E=E.toLowerCase(),P=P?P.toLowerCase():null,k=k.toLowerCase()),P&&S&&(P=ma(P,S)||P);const N=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let j=E===k||!a&&E.startsWith(k)&&E.charAt(N)==="/",D=P!=null&&(P===k||!a&&P.startsWith(k)&&P.charAt(k.length)==="/"),z={isActive:j,isPending:D,isTransitioning:b},q=j?e:void 0,K;typeof n=="function"?K=n(z):K=[n,j?"active":null,D?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let oe=typeof o=="function"?o(z):o;return R.createElement(ic,{...f,"aria-current":q,className:K,ref:p,style:oe,to:l,viewTransition:c},typeof d=="function"?d(z):d)});Pk.displayName="NavLink";var Rk=R.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:a,state:o,method:l=Gu,action:c,onSubmit:d,relative:f,preventScrollReset:p,viewTransition:y,...g},w)=>{let _=Nk(),S=$k(c,{relative:f}),b=l.toLowerCase()==="get"?"get":"post",k=typeof c=="string"&&Eb.test(c),E=P=>{if(d&&d(P),P.defaultPrevented)return;P.preventDefault();let N=P.nativeEvent.submitter,j=(N==null?void 0:N.getAttribute("formmethod"))||l;_(N||P.currentTarget,{fetcherKey:e,method:j,navigate:t,replace:a,state:o,relative:f,preventScrollReset:p,viewTransition:y})};return R.createElement("form",{ref:w,method:b,action:S,onSubmit:n?d:E,...g,"data-discover":!k&&r==="render"?"true":void 0})});Rk.displayName="Form";function Ok(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kb(r){let e=R.useContext(ii);return ot(e,Ok(r)),e}function Tk(r,{target:e,replace:t,state:n,preventScrollReset:a,relative:o,viewTransition:l}={}){let c=F1(),d=es(),f=Qo(r,{relative:o});return R.useCallback(p=>{if(ok(p,e)){p.preventDefault();let y=t!==void 0?t:To(d)===To(f);c(r,{replace:y,state:n,preventScrollReset:a,relative:o,viewTransition:l})}},[d,c,f,t,n,e,r,a,o,l])}var Ak=0,Ik=()=>`__${String(++Ak)}__`;function Nk(){let{router:r}=kb("useSubmit"),{basename:e}=R.useContext(fr),t=K1();return R.useCallback(async(n,a={})=>{let{action:o,method:l,encType:c,formData:d,body:f}=ck(n,e);if(a.navigate===!1){let p=a.fetcherKey||Ik();await r.fetch(p,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:d,body:f,formMethod:a.method||l,formEncType:a.encType||c,flushSync:a.flushSync})}else await r.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:d,body:f,formMethod:a.method||l,formEncType:a.encType||c,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,e,t])}function $k(r,{relative:e}={}){let{basename:t}=R.useContext(fr),n=R.useContext(Lr);ot(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),o={...Qo(r||".",{relative:e})},l=es();if(r==null){o.search=l.search;let c=new URLSearchParams(o.search),d=c.getAll("index");if(d.some(p=>p==="")){c.delete("index"),d.filter(y=>y).forEach(y=>c.append("index",y));let p=c.toString();o.search=p?`?${p}`:""}}return(!r||r===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Ir([t,o.pathname])),To(o)}function jk(r,e={}){let t=R.useContext(vb);ot(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=kb("useViewTransitionState"),a=Qo(r,{relative:e.relative});if(!t.isTransitioning)return!1;let o=ma(t.currentLocation.pathname,n)||t.currentLocation.pathname,l=ma(t.nextLocation.pathname,n)||t.nextLocation.pathname;return sc(a.pathname,l)!=null||sc(a.pathname,o)!=null}new TextEncoder;var Lk=db();const Mk=Ya(Lk);function Dk(r,e){typeof r=="function"?r(e):r!=null&&(r.current=e)}function Cb(...r){return e=>r.forEach(t=>Dk(t,e))}function xa(...r){return R.useCallback(Cb(...r),r)}var im=R.forwardRef((r,e)=>{const{children:t,...n}=r,a=R.Children.toArray(t),o=a.find(Uk);if(o){const l=o.props.children,c=a.map(d=>d===o?R.Children.count(l)>1?R.Children.only(null):R.isValidElement(l)?l.props.children:null:d);return I.jsx(bp,{...n,ref:e,children:R.isValidElement(l)?R.cloneElement(l,void 0,c):null})}return I.jsx(bp,{...n,ref:e,children:t})});im.displayName="Slot";var bp=R.forwardRef((r,e)=>{const{children:t,...n}=r;if(R.isValidElement(t)){const a=Bk(t);return R.cloneElement(t,{...zk(n,t.props),ref:e?Cb(e,a):a})}return R.Children.count(t)>1?R.Children.only(null):null});bp.displayName="SlotClone";var Fk=({children:r})=>I.jsx(I.Fragment,{children:r});function Uk(r){return R.isValidElement(r)&&r.type===Fk}function zk(r,e){const t={...e};for(const n in e){const a=r[n],o=e[n];/^on[A-Z]/.test(n)?a&&o?t[n]=(...c)=>{o(...c),a(...c)}:a&&(t[n]=a):n==="style"?t[n]={...a,...o}:n==="className"&&(t[n]=[a,o].filter(Boolean).join(" "))}return{...r,...t}}function Bk(r){var n,a;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(a=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:a.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var Hk=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],ts=Hk.reduce((r,e)=>{const t=R.forwardRef((n,a)=>{const{asChild:o,...l}=n,c=o?im:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),I.jsx(c,{...l,ref:a})});return t.displayName=`Primitive.${e}`,{...r,[e]:t}},{}),oc=globalThis!=null&&globalThis.document?R.useLayoutEffect:()=>{};function Vk(r,e){return R.useReducer((t,n)=>e[t][n]??t,r)}var oi=r=>{const{present:e,children:t}=r,n=qk(e),a=typeof t=="function"?t({present:n.isPresent}):R.Children.only(t),o=xa(n.ref,Wk(a));return typeof t=="function"||n.isPresent?R.cloneElement(a,{ref:o}):null};oi.displayName="Presence";function qk(r){const[e,t]=R.useState(),n=R.useRef({}),a=R.useRef(r),o=R.useRef("none"),l=r?"mounted":"unmounted",[c,d]=Vk(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return R.useEffect(()=>{const f=Tu(n.current);o.current=c==="mounted"?f:"none"},[c]),oc(()=>{const f=n.current,p=a.current;if(p!==r){const g=o.current,w=Tu(f);r?d("MOUNT"):w==="none"||(f==null?void 0:f.display)==="none"?d("UNMOUNT"):d(p&&g!==w?"ANIMATION_OUT":"UNMOUNT"),a.current=r}},[r,d]),oc(()=>{if(e){let f;const p=e.ownerDocument.defaultView??window,y=w=>{const S=Tu(n.current).includes(w.animationName);if(w.target===e&&S&&(d("ANIMATION_END"),!a.current)){const b=e.style.animationFillMode;e.style.animationFillMode="forwards",f=p.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=b)})}},g=w=>{w.target===e&&(o.current=Tu(n.current))};return e.addEventListener("animationstart",g),e.addEventListener("animationcancel",y),e.addEventListener("animationend",y),()=>{p.clearTimeout(f),e.removeEventListener("animationstart",g),e.removeEventListener("animationcancel",y),e.removeEventListener("animationend",y)}}else d("ANIMATION_END")},[e,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:R.useCallback(f=>{f&&(n.current=getComputedStyle(f)),t(f)},[])}}function Tu(r){return(r==null?void 0:r.animationName)||"none"}function Wk(r){var n,a;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(a=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:a.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function Pb(r,e=[]){let t=[];function n(o,l){const c=R.createContext(l),d=t.length;t=[...t,l];const f=y=>{var k;const{scope:g,children:w,..._}=y,S=((k=g==null?void 0:g[r])==null?void 0:k[d])||c,b=R.useMemo(()=>_,Object.values(_));return I.jsx(S.Provider,{value:b,children:w})};f.displayName=o+"Provider";function p(y,g){var S;const w=((S=g==null?void 0:g[r])==null?void 0:S[d])||c,_=R.useContext(w);if(_)return _;if(l!==void 0)return l;throw new Error(`\`${y}\` must be used within \`${o}\``)}return[f,p]}const a=()=>{const o=t.map(l=>R.createContext(l));return function(c){const d=(c==null?void 0:c[r])||o;return R.useMemo(()=>({[`__scope${r}`]:{...c,[r]:d}}),[c,d])}};return a.scopeName=r,[n,Zk(a,...e)]}function Zk(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const l=n.reduce((c,{useScope:d,scopeName:f})=>{const y=d(o)[`__scope${f}`];return{...c,...y}},{});return R.useMemo(()=>({[`__scope${e.scopeName}`]:l}),[l])}};return t.scopeName=e.scopeName,t}function Tr(r){const e=R.useRef(r);return R.useEffect(()=>{e.current=r}),R.useMemo(()=>(...t)=>{var n;return(n=e.current)==null?void 0:n.call(e,...t)},[])}var Gk=R.createContext(void 0);function Jk(r){const e=R.useContext(Gk);return r||e||"ltr"}function Kk(r,[e,t]){return Math.min(t,Math.max(e,r))}function Nr(r,e,{checkForDefaultPrevented:t=!0}={}){return function(a){if(r==null||r(a),t===!1||!a.defaultPrevented)return e==null?void 0:e(a)}}function Xk(r,e){return R.useReducer((t,n)=>e[t][n]??t,r)}var om="ScrollArea",[Rb,z$]=Pb(om),[Qk,Rn]=Rb(om),lc=R.forwardRef((r,e)=>{const{__scopeScrollArea:t,type:n="hover",dir:a,scrollHideDelay:o=600,...l}=r,[c,d]=R.useState(null),[f,p]=R.useState(null),[y,g]=R.useState(null),[w,_]=R.useState(null),[S,b]=R.useState(null),[k,E]=R.useState(0),[P,N]=R.useState(0),[j,D]=R.useState(!1),[z,q]=R.useState(!1),K=xa(e,he=>d(he)),oe=Jk(a);return I.jsx(Qk,{scope:t,type:n,dir:oe,scrollHideDelay:o,scrollArea:c,viewport:f,onViewportChange:p,content:y,onContentChange:g,scrollbarX:w,onScrollbarXChange:_,scrollbarXEnabled:j,onScrollbarXEnabledChange:D,scrollbarY:S,onScrollbarYChange:b,scrollbarYEnabled:z,onScrollbarYEnabledChange:q,onCornerWidthChange:E,onCornerHeightChange:N,children:I.jsx(ts.div,{dir:oe,...l,ref:K,style:{position:"relative","--radix-scroll-area-corner-width":k+"px","--radix-scroll-area-corner-height":P+"px",...r.style}})})});lc.displayName=om;var Ob="ScrollAreaViewport",Tb=R.forwardRef((r,e)=>{const{__scopeScrollArea:t,children:n,nonce:a,...o}=r,l=Rn(Ob,t),c=R.useRef(null),d=xa(e,c,l.onViewportChange);return I.jsxs(I.Fragment,{children:[I.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),I.jsx(ts.div,{"data-radix-scroll-area-viewport":"",...o,ref:d,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...r.style},children:I.jsx("div",{ref:l.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});Tb.displayName=Ob;var hr="ScrollAreaScrollbar",lm=R.forwardRef((r,e)=>{const{forceMount:t,...n}=r,a=Rn(hr,r.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:l}=a,c=r.orientation==="horizontal";return R.useEffect(()=>(c?o(!0):l(!0),()=>{c?o(!1):l(!1)}),[c,o,l]),a.type==="hover"?I.jsx(Yk,{...n,ref:e,forceMount:t}):a.type==="scroll"?I.jsx(eC,{...n,ref:e,forceMount:t}):a.type==="auto"?I.jsx(Ab,{...n,ref:e,forceMount:t}):a.type==="always"?I.jsx(um,{...n,ref:e}):null});lm.displayName=hr;var Yk=R.forwardRef((r,e)=>{const{forceMount:t,...n}=r,a=Rn(hr,r.__scopeScrollArea),[o,l]=R.useState(!1);return R.useEffect(()=>{const c=a.scrollArea;let d=0;if(c){const f=()=>{window.clearTimeout(d),l(!0)},p=()=>{d=window.setTimeout(()=>l(!1),a.scrollHideDelay)};return c.addEventListener("pointerenter",f),c.addEventListener("pointerleave",p),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",f),c.removeEventListener("pointerleave",p)}}},[a.scrollArea,a.scrollHideDelay]),I.jsx(oi,{present:t||o,children:I.jsx(Ab,{"data-state":o?"visible":"hidden",...n,ref:e})})}),eC=R.forwardRef((r,e)=>{const{forceMount:t,...n}=r,a=Rn(hr,r.__scopeScrollArea),o=r.orientation==="horizontal",l=Lc(()=>d("SCROLL_END"),100),[c,d]=Xk("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return R.useEffect(()=>{if(c==="idle"){const f=window.setTimeout(()=>d("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(f)}},[c,a.scrollHideDelay,d]),R.useEffect(()=>{const f=a.viewport,p=o?"scrollLeft":"scrollTop";if(f){let y=f[p];const g=()=>{const w=f[p];y!==w&&(d("SCROLL"),l()),y=w};return f.addEventListener("scroll",g),()=>f.removeEventListener("scroll",g)}},[a.viewport,o,d,l]),I.jsx(oi,{present:t||c!=="hidden",children:I.jsx(um,{"data-state":c==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:Nr(r.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Nr(r.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),Ab=R.forwardRef((r,e)=>{const t=Rn(hr,r.__scopeScrollArea),{forceMount:n,...a}=r,[o,l]=R.useState(!1),c=r.orientation==="horizontal",d=Lc(()=>{if(t.viewport){const f=t.viewport.offsetWidth<t.viewport.scrollWidth,p=t.viewport.offsetHeight<t.viewport.scrollHeight;l(c?f:p)}},10);return Qs(t.viewport,d),Qs(t.content,d),I.jsx(oi,{present:n||o,children:I.jsx(um,{"data-state":o?"visible":"hidden",...a,ref:e})})}),um=R.forwardRef((r,e)=>{const{orientation:t="vertical",...n}=r,a=Rn(hr,r.__scopeScrollArea),o=R.useRef(null),l=R.useRef(0),[c,d]=R.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),f=Lb(c.viewport,c.content),p={...n,sizes:c,onSizesChange:d,hasThumb:f>0&&f<1,onThumbChange:g=>o.current=g,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:g=>l.current=g};function y(g,w){return iC(g,l.current,c,w)}return t==="horizontal"?I.jsx(tC,{...p,ref:e,onThumbPositionChange:()=>{if(a.viewport&&o.current){const g=a.viewport.scrollLeft,w=qv(g,c,a.dir);o.current.style.transform=`translate3d(${w}px, 0, 0)`}},onWheelScroll:g=>{a.viewport&&(a.viewport.scrollLeft=g)},onDragScroll:g=>{a.viewport&&(a.viewport.scrollLeft=y(g,a.dir))}}):t==="vertical"?I.jsx(nC,{...p,ref:e,onThumbPositionChange:()=>{if(a.viewport&&o.current){const g=a.viewport.scrollTop,w=qv(g,c);o.current.style.transform=`translate3d(0, ${w}px, 0)`}},onWheelScroll:g=>{a.viewport&&(a.viewport.scrollTop=g)},onDragScroll:g=>{a.viewport&&(a.viewport.scrollTop=y(g))}}):null}),tC=R.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...a}=r,o=Rn(hr,r.__scopeScrollArea),[l,c]=R.useState(),d=R.useRef(null),f=xa(e,d,o.onScrollbarXChange);return R.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),I.jsx(Nb,{"data-orientation":"horizontal",...a,ref:f,sizes:t,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":jc(t)+"px",...r.style},onThumbPointerDown:p=>r.onThumbPointerDown(p.x),onDragScroll:p=>r.onDragScroll(p.x),onWheelScroll:(p,y)=>{if(o.viewport){const g=o.viewport.scrollLeft+p.deltaX;r.onWheelScroll(g),Db(g,y)&&p.preventDefault()}},onResize:()=>{d.current&&o.viewport&&l&&n({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:cc(l.paddingLeft),paddingEnd:cc(l.paddingRight)}})}})}),nC=R.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...a}=r,o=Rn(hr,r.__scopeScrollArea),[l,c]=R.useState(),d=R.useRef(null),f=xa(e,d,o.onScrollbarYChange);return R.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),I.jsx(Nb,{"data-orientation":"vertical",...a,ref:f,sizes:t,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":jc(t)+"px",...r.style},onThumbPointerDown:p=>r.onThumbPointerDown(p.y),onDragScroll:p=>r.onDragScroll(p.y),onWheelScroll:(p,y)=>{if(o.viewport){const g=o.viewport.scrollTop+p.deltaY;r.onWheelScroll(g),Db(g,y)&&p.preventDefault()}},onResize:()=>{d.current&&o.viewport&&l&&n({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:cc(l.paddingTop),paddingEnd:cc(l.paddingBottom)}})}})}),[rC,Ib]=Rb(hr),Nb=R.forwardRef((r,e)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:a,onThumbChange:o,onThumbPointerUp:l,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:f,onWheelScroll:p,onResize:y,...g}=r,w=Rn(hr,t),[_,S]=R.useState(null),b=xa(e,K=>S(K)),k=R.useRef(null),E=R.useRef(""),P=w.viewport,N=n.content-n.viewport,j=Tr(p),D=Tr(d),z=Lc(y,10);function q(K){if(k.current){const oe=K.clientX-k.current.left,he=K.clientY-k.current.top;f({x:oe,y:he})}}return R.useEffect(()=>{const K=oe=>{const he=oe.target;(_==null?void 0:_.contains(he))&&j(oe,N)};return document.addEventListener("wheel",K,{passive:!1}),()=>document.removeEventListener("wheel",K,{passive:!1})},[P,_,N,j]),R.useEffect(D,[n,D]),Qs(_,z),Qs(w.content,z),I.jsx(rC,{scope:t,scrollbar:_,hasThumb:a,onThumbChange:Tr(o),onThumbPointerUp:Tr(l),onThumbPositionChange:D,onThumbPointerDown:Tr(c),children:I.jsx(ts.div,{...g,ref:b,style:{position:"absolute",...g.style},onPointerDown:Nr(r.onPointerDown,K=>{K.button===0&&(K.target.setPointerCapture(K.pointerId),k.current=_.getBoundingClientRect(),E.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",w.viewport&&(w.viewport.style.scrollBehavior="auto"),q(K))}),onPointerMove:Nr(r.onPointerMove,q),onPointerUp:Nr(r.onPointerUp,K=>{const oe=K.target;oe.hasPointerCapture(K.pointerId)&&oe.releasePointerCapture(K.pointerId),document.body.style.webkitUserSelect=E.current,w.viewport&&(w.viewport.style.scrollBehavior=""),k.current=null})})})}),uc="ScrollAreaThumb",$b=R.forwardRef((r,e)=>{const{forceMount:t,...n}=r,a=Ib(uc,r.__scopeScrollArea);return I.jsx(oi,{present:t||a.hasThumb,children:I.jsx(aC,{ref:e,...n})})}),aC=R.forwardRef((r,e)=>{const{__scopeScrollArea:t,style:n,...a}=r,o=Rn(uc,t),l=Ib(uc,t),{onThumbPositionChange:c}=l,d=xa(e,y=>l.onThumbChange(y)),f=R.useRef(),p=Lc(()=>{f.current&&(f.current(),f.current=void 0)},100);return R.useEffect(()=>{const y=o.viewport;if(y){const g=()=>{if(p(),!f.current){const w=oC(y,c);f.current=w,c()}};return c(),y.addEventListener("scroll",g),()=>y.removeEventListener("scroll",g)}},[o.viewport,p,c]),I.jsx(ts.div,{"data-state":l.hasThumb?"visible":"hidden",...a,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:Nr(r.onPointerDownCapture,y=>{const w=y.target.getBoundingClientRect(),_=y.clientX-w.left,S=y.clientY-w.top;l.onThumbPointerDown({x:_,y:S})}),onPointerUp:Nr(r.onPointerUp,l.onThumbPointerUp)})});$b.displayName=uc;var cm="ScrollAreaCorner",jb=R.forwardRef((r,e)=>{const t=Rn(cm,r.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?I.jsx(sC,{...r,ref:e}):null});jb.displayName=cm;var sC=R.forwardRef((r,e)=>{const{__scopeScrollArea:t,...n}=r,a=Rn(cm,t),[o,l]=R.useState(0),[c,d]=R.useState(0),f=!!(o&&c);return Qs(a.scrollbarX,()=>{var y;const p=((y=a.scrollbarX)==null?void 0:y.offsetHeight)||0;a.onCornerHeightChange(p),d(p)}),Qs(a.scrollbarY,()=>{var y;const p=((y=a.scrollbarY)==null?void 0:y.offsetWidth)||0;a.onCornerWidthChange(p),l(p)}),f?I.jsx(ts.div,{...n,ref:e,style:{width:o,height:c,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function cc(r){return r?parseInt(r,10):0}function Lb(r,e){const t=r/e;return isNaN(t)?0:t}function jc(r){const e=Lb(r.viewport,r.content),t=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,n=(r.scrollbar.size-t)*e;return Math.max(n,18)}function iC(r,e,t,n="ltr"){const a=jc(t),o=a/2,l=e||o,c=a-l,d=t.scrollbar.paddingStart+l,f=t.scrollbar.size-t.scrollbar.paddingEnd-c,p=t.content-t.viewport,y=n==="ltr"?[0,p]:[p*-1,0];return Mb([d,f],y)(r)}function qv(r,e,t="ltr"){const n=jc(e),a=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,o=e.scrollbar.size-a,l=e.content-e.viewport,c=o-n,d=t==="ltr"?[0,l]:[l*-1,0],f=Kk(r,d);return Mb([0,l],[0,c])(f)}function Mb(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function Db(r,e){return r>0&&r<e}var oC=(r,e=()=>{})=>{let t={left:r.scrollLeft,top:r.scrollTop},n=0;return function a(){const o={left:r.scrollLeft,top:r.scrollTop},l=t.left!==o.left,c=t.top!==o.top;(l||c)&&e(),t=o,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function Lc(r,e){const t=Tr(r),n=R.useRef(0);return R.useEffect(()=>()=>window.clearTimeout(n.current),[]),R.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,e)},[t,e])}function Qs(r,e){const t=Tr(e);oc(()=>{let n=0;if(r){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return a.observe(r),()=>{window.cancelAnimationFrame(n),a.unobserve(r)}}},[r,t])}var Fb=lc,lC=Tb,uC=jb;const cC=[{id:"gamedev",model:"gpt-4o-mini",temperature:.7,presence_penalty:.6,frequency_penalty:.5,top_p:.9,name:"Эксперт по игровому программированию",description:"Помогу с разработкой игр и игровыми технологиями",systemPrompt:`Вы — опытный разработчик игр. Ваша задача — помочь пользователю с вопросами, связанными с игровым программированием, через умный диалог.

Для сбора контекста используйте следующие вопросы (но не ограничивайтесь ими):
- На каком языке программирования вы работаете?
- Какой игровой движок вы используете (Unity, Unreal Engine и т.д.)?
- Какой жанр игры вы разрабатываете?
- Требуется ли поддержка мультиплеера?
- Какие платформы вы нацелены поддерживать (PC, мобильные устройства, консоли)?
- Есть ли у вас опыт работы с 2D или 3D графикой?
- Какие механики вы планируете реализовать?
- Требуется ли интеграция с сервисами (например, Steam, App Store)?
- Какой у вас уровень опыта в игровом программировании?
- Есть ли ограничения по производительности или ресурсам?

Правила взаимодействия:
1. Задавайте по одному вопросу за раз.
2. Выбирайте наиболее релевантный вопрос исходя из контекста беседы.
3. Анализируйте ответы пользователя для выбора следующего вопроса.
4. Когда соберете достаточно информации, предложите техническое решение или рекомендации.`},{id:"webdev",model:"gpt-4o-mini",temperature:.1,presence_penalty:-.2,frequency_penalty:-.1,top_p:.1,name:"Эксперт по веб-разработке",description:"Помогу с разработкой веб-приложений и сайтов",systemPrompt:`Вы — опытный веб-разработчик. Ваша задача — помочь пользователю с вопросами по веб-разработке через умный диалог.

Для сбора контекста используйте следующие вопросы:
- Какой тип веб-приложения вы хотите создать (сайт, SPA, REST API)?
- Какие технологии или фреймворки вы планируете использовать (React, Angular, ASP.NET и т.д.)?
- Требуется ли бэкенд-разработка, и на каком языке?
- Какие функциональные требования есть к приложению?
- Нужно ли работать с базами данных? Если да, то с какими?
- Есть ли требования к дизайну и пользовательскому интерфейсу?
- Каковы требования по безопасности?
- Требуется ли интеграция со сторонними API или сервисами?
- Какой у вас уровень опыта в веб-разработке?
- Есть ли ограничения по времени или ресурсам?

Правила взаимодействия:
1. Задавайте по одному вопросу за раз.
2. Выбирайте релевантные вопросы исходя из контекста.
3. Анализируйте ответы для определения следующего вопроса.
4. После сбора информации предоставьте развернутое техническое решение или рекомендации.`},{id:"mobiledev",model:"gpt-4o-mini",temperature:.3,presence_penalty:0,frequency_penalty:0,top_p:.5,name:"Эксперт по мобильной разработке",description:"Помогу с разработкой мобильных приложений",systemPrompt:`Вы — опытный разработчик мобильных приложений. Ваша задача — помочь пользователю с вопросами по мобильной разработке через умный диалог.

Для сбора контекста используйте следующие вопросы:
- Для какой платформы вы разрабатываете приложение (iOS, Android, кроссплатформенное)?
- Какие технологии или фреймворки вы планируете использовать (Swift, Kotlin, React Native, Flutter)?
- Какие функциональные возможности должны быть в приложении?
- Требуется ли серверная часть или бэкенд?
- Есть ли необходимость в работе с базами данных?
- Каковы требования к пользовательскому интерфейсу и дизайну?
- Нужно ли использовать специфические возможности устройства (GPS, камера, датчики)?
- Каковы требования по производительности и оптимизации?
- Какой у вас опыт в мобильной разработке?
- Требуется ли публикация в App Store или Google Play?

Правила взаимодействия:
1. Задавайте по одному вопросу за раз.
2. Выбирайте релевантные вопросы на основе контекста.
3. Анализируйте ответы для определения следующего вопроса.
4. После сбора достаточной информации предоставьте техническое решение или рекомендации.`}],Au={experts:cC},xp="RFC3986",Sp={RFC1738:r=>String(r).replace(/%20/g,"+"),RFC3986:r=>String(r)},dC="RFC1738",fC=Array.isArray,ar=(()=>{const r=[];for(let e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r})(),Wf=1024,hC=(r,e,t,n,a)=>{if(r.length===0)return r;let o=r;if(typeof r=="symbol"?o=Symbol.prototype.toString.call(r):typeof r!="string"&&(o=String(r)),t==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});let l="";for(let c=0;c<o.length;c+=Wf){const d=o.length>=Wf?o.slice(c,c+Wf):o,f=[];for(let p=0;p<d.length;++p){let y=d.charCodeAt(p);if(y===45||y===46||y===95||y===126||y>=48&&y<=57||y>=65&&y<=90||y>=97&&y<=122||a===dC&&(y===40||y===41)){f[f.length]=d.charAt(p);continue}if(y<128){f[f.length]=ar[y];continue}if(y<2048){f[f.length]=ar[192|y>>6]+ar[128|y&63];continue}if(y<55296||y>=57344){f[f.length]=ar[224|y>>12]+ar[128|y>>6&63]+ar[128|y&63];continue}p+=1,y=65536+((y&1023)<<10|d.charCodeAt(p)&1023),f[f.length]=ar[240|y>>18]+ar[128|y>>12&63]+ar[128|y>>6&63]+ar[128|y&63]}l+=f.join("")}return l};function pC(r){return!r||typeof r!="object"?!1:!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))}function Wv(r,e){if(fC(r)){const t=[];for(let n=0;n<r.length;n+=1)t.push(e(r[n]));return t}return e(r)}const mC=Object.prototype.hasOwnProperty,Ub={brackets(r){return String(r)+"[]"},comma:"comma",indices(r,e){return String(r)+"["+e+"]"},repeat(r){return String(r)}},sr=Array.isArray,gC=Array.prototype.push,zb=function(r,e){gC.apply(r,sr(e)?e:[e])},yC=Date.prototype.toISOString,gt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:hC,encodeValuesOnly:!1,format:xp,formatter:Sp[xp],indices:!1,serializeDate(r){return yC.call(r)},skipNulls:!1,strictNullHandling:!1};function vC(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r=="symbol"||typeof r=="bigint"}const Zf={};function Bb(r,e,t,n,a,o,l,c,d,f,p,y,g,w,_,S,b,k){let E=r,P=k,N=0,j=!1;for(;(P=P.get(Zf))!==void 0&&!j;){const oe=P.get(r);if(N+=1,typeof oe<"u"){if(oe===N)throw new RangeError("Cyclic object value");j=!0}typeof P.get(Zf)>"u"&&(N=0)}if(typeof f=="function"?E=f(e,E):E instanceof Date?E=g==null?void 0:g(E):t==="comma"&&sr(E)&&(E=Wv(E,function(oe){return oe instanceof Date?g==null?void 0:g(oe):oe})),E===null){if(o)return d&&!S?d(e,gt.encoder,b,"key",w):e;E=""}if(vC(E)||pC(E)){if(d){const oe=S?e:d(e,gt.encoder,b,"key",w);return[(_==null?void 0:_(oe))+"="+(_==null?void 0:_(d(E,gt.encoder,b,"value",w)))]}return[(_==null?void 0:_(e))+"="+(_==null?void 0:_(String(E)))]}const D=[];if(typeof E>"u")return D;let z;if(t==="comma"&&sr(E))S&&d&&(E=Wv(E,d)),z=[{value:E.length>0?E.join(",")||null:void 0}];else if(sr(f))z=f;else{const oe=Object.keys(E);z=p?oe.sort(p):oe}const q=c?String(e).replace(/\./g,"%2E"):String(e),K=n&&sr(E)&&E.length===1?q+"[]":q;if(a&&sr(E)&&E.length===0)return K+"[]";for(let oe=0;oe<z.length;++oe){const he=z[oe],me=typeof he=="object"&&typeof he.value<"u"?he.value:E[he];if(l&&me===null)continue;const Ue=y&&c?he.replace(/\./g,"%2E"):he,Y=sr(E)?typeof t=="function"?t(K,Ue):K:K+(y?"."+Ue:"["+Ue+"]");k.set(r,N);const G=new WeakMap;G.set(Zf,k),zb(D,Bb(me,Y,t,n,a,o,l,c,t==="comma"&&S&&sr(E)?null:d,f,p,y,g,w,_,S,b,G))}return D}function wC(r=gt){if(typeof r.allowEmptyArrays<"u"&&typeof r.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof r.encodeDotInKeys<"u"&&typeof r.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(r.encoder!==null&&typeof r.encoder<"u"&&typeof r.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=r.charset||gt.charset;if(typeof r.charset<"u"&&r.charset!=="utf-8"&&r.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=xp;if(typeof r.format<"u"){if(!mC.call(Sp,r.format))throw new TypeError("Unknown format option provided.");t=r.format}const n=Sp[t];let a=gt.filter;(typeof r.filter=="function"||sr(r.filter))&&(a=r.filter);let o;if(r.arrayFormat&&r.arrayFormat in Ub?o=r.arrayFormat:"indices"in r?o=r.indices?"indices":"repeat":o=gt.arrayFormat,"commaRoundTrip"in r&&typeof r.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const l=typeof r.allowDots>"u"?r.encodeDotInKeys?!0:gt.allowDots:!!r.allowDots;return{addQueryPrefix:typeof r.addQueryPrefix=="boolean"?r.addQueryPrefix:gt.addQueryPrefix,allowDots:l,allowEmptyArrays:typeof r.allowEmptyArrays=="boolean"?!!r.allowEmptyArrays:gt.allowEmptyArrays,arrayFormat:o,charset:e,charsetSentinel:typeof r.charsetSentinel=="boolean"?r.charsetSentinel:gt.charsetSentinel,commaRoundTrip:!!r.commaRoundTrip,delimiter:typeof r.delimiter>"u"?gt.delimiter:r.delimiter,encode:typeof r.encode=="boolean"?r.encode:gt.encode,encodeDotInKeys:typeof r.encodeDotInKeys=="boolean"?r.encodeDotInKeys:gt.encodeDotInKeys,encoder:typeof r.encoder=="function"?r.encoder:gt.encoder,encodeValuesOnly:typeof r.encodeValuesOnly=="boolean"?r.encodeValuesOnly:gt.encodeValuesOnly,filter:a,format:t,formatter:n,serializeDate:typeof r.serializeDate=="function"?r.serializeDate:gt.serializeDate,skipNulls:typeof r.skipNulls=="boolean"?r.skipNulls:gt.skipNulls,sort:typeof r.sort=="function"?r.sort:null,strictNullHandling:typeof r.strictNullHandling=="boolean"?r.strictNullHandling:gt.strictNullHandling}}function _C(r,e={}){let t=r;const n=wC(e);let a,o;typeof n.filter=="function"?(o=n.filter,t=o("",t)):sr(n.filter)&&(o=n.filter,a=o);const l=[];if(typeof t!="object"||t===null)return"";const c=Ub[n.arrayFormat],d=c==="comma"&&n.commaRoundTrip;a||(a=Object.keys(t)),n.sort&&a.sort(n.sort);const f=new WeakMap;for(let g=0;g<a.length;++g){const w=a[g];n.skipNulls&&t[w]===null||zb(l,Bb(t[w],w,c,d,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,f))}const p=l.join(n.delimiter);let y=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?y+="utf8=%26%2310003%3B&":y+="utf8=%E2%9C%93&"),p.length>0?y+p:""}const Ms="4.73.1";let Zv=!1,So,Hb,Vb,Ep,qb,Wb,Zb,Gb,Jb;function bC(r,e={auto:!1}){if(Zv)throw new Error(`you must \`import 'openai/shims/${r.kind}'\` before importing anything else from openai`);if(So)throw new Error(`can't \`import 'openai/shims/${r.kind}'\` after \`import 'openai/shims/${So}'\``);Zv=e.auto,So=r.kind,Hb=r.fetch,Vb=r.FormData,Ep=r.File,qb=r.ReadableStream,Wb=r.getMultipartRequestOptions,Zb=r.getDefaultAgent,Gb=r.fileFromPath,Jb=r.isFsReadStream}class xC{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function SC({manuallyImported:r}={}){const e=r?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,a,o;try{t=fetch,n=Request,a=Response,o=Headers}catch(l){throw new Error(`this environment is missing the following Web Fetch API type: ${l.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:a,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(l,c)=>({...c,body:new xC(l)}),getDefaultAgent:l=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:l=>!1}}So||bC(SC(),{auto:!0});class $e extends Error{}class Ot extends $e{constructor(e,t,n,a){super(`${Ot.makeMessage(e,t,n)}`),this.status=e,this.headers=a,this.request_id=a==null?void 0:a["x-request-id"];const o=t;this.error=o,this.code=o==null?void 0:o.code,this.param=o==null?void 0:o.param,this.type=o==null?void 0:o.type}static makeMessage(e,t,n){const a=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,t,n,a){if(!e)return new Mc({message:n,cause:Cp(t)});const o=t==null?void 0:t.error;return e===400?new Kb(e,o,n,a):e===401?new Xb(e,o,n,a):e===403?new Qb(e,o,n,a):e===404?new Yb(e,o,n,a):e===409?new e0(e,o,n,a):e===422?new t0(e,o,n,a):e===429?new n0(e,o,n,a):e>=500?new r0(e,o,n,a):new Ot(e,o,n,a)}}class Pn extends Ot{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class Mc extends Ot{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}}class Dc extends Mc{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Kb extends Ot{constructor(){super(...arguments),this.status=400}}class Xb extends Ot{constructor(){super(...arguments),this.status=401}}class Qb extends Ot{constructor(){super(...arguments),this.status=403}}class Yb extends Ot{constructor(){super(...arguments),this.status=404}}class e0 extends Ot{constructor(){super(...arguments),this.status=409}}class t0 extends Ot{constructor(){super(...arguments),this.status=422}}class n0 extends Ot{constructor(){super(...arguments),this.status=429}}class r0 extends Ot{}class a0 extends $e{constructor(){super("Could not parse response content as the length limit was reached")}}class s0 extends $e{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Ga{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=Ga.NEWLINE_CHARS.has(t[t.length-1]||"");let a=t.split(Ga.NEWLINE_REGEXP);return n&&a.pop(),a.length===1&&!n?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),n||(this.buffer=[a.pop()||""]),a)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new $e(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new $e(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new $e("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Ga.NEWLINE_CHARS=new Set([`
`,"\r"]);Ga.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class or{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let o=!1;try{for await(const l of EC(e,t))if(!o){if(l.data.startsWith("[DONE]")){o=!0;continue}if(l.event===null){let c;try{c=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(c&&c.error)throw new Ot(void 0,c.error,void 0,void 0);yield c}else{let c;try{c=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(l.event=="error")throw new Ot(void 0,c.error,c.message,void 0);yield{event:l.event,data:c}}}o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||t.abort()}}return new or(a,t)}static fromReadableStream(e,t){let n=!1;async function*a(){const l=new Ga,c=i0(e);for await(const d of c)for(const f of l.decode(d))yield f;for(const d of l.flush())yield d}async function*o(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let l=!1;try{for await(const c of a())l||c&&(yield JSON.parse(c));l=!0}catch(c){if(c instanceof Error&&c.name==="AbortError")return;throw c}finally{l||t.abort()}}return new or(o,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),a=o=>({next:()=>{if(o.length===0){const l=n.next();e.push(l),t.push(l)}return o.shift()}});return[new or(()=>a(e),this.controller),new or(()=>a(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new qb({async start(){t=e[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:l}=await t.next();if(l)return a.close();const c=n.encode(JSON.stringify(o)+`
`);a.enqueue(c)}catch(o){a.error(o)}},async cancel(){var a;await((a=t.return)==null?void 0:a.call(t))}})}}async function*EC(r,e){if(!r.body)throw e.abort(),new $e("Attempted to iterate over a response with no body");const t=new PC,n=new Ga,a=i0(r.body);for await(const o of kC(a))for(const l of n.decode(o)){const c=t.decode(l);c&&(yield c)}for(const o of n.flush()){const l=t.decode(o);l&&(yield l)}}async function*kC(r){let e=new Uint8Array;for await(const t of r){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let a=new Uint8Array(e.length+n.length);a.set(e),a.set(n,e.length),e=a;let o;for(;(o=CC(e))!==-1;)yield e.slice(0,o),e=e.slice(o)}e.length>0&&(yield e)}function CC(r){for(let n=0;n<r.length-2;n++){if(r[n]===10&&r[n+1]===10||r[n]===13&&r[n+1]===13)return n+2;if(r[n]===13&&r[n+1]===10&&n+3<r.length&&r[n+2]===13&&r[n+3]===10)return n+4}return-1}class PC{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,a]=RC(e,":");return a.startsWith(" ")&&(a=a.substring(1)),t==="event"?this.event=a:t==="data"&&this.data.push(a),null}}function RC(r,e){const t=r.indexOf(e);return t!==-1?[r.substring(0,t),e,r.substring(t+e.length)]:[r,"",""]}function i0(r){if(r[Symbol.asyncIterator])return r;const e=r.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const o0=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function",l0=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&Fc(r),Fc=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",OC=r=>l0(r)||o0(r)||Jb(r);async function u0(r,e,t){var a;if(r=await r,l0(r))return r;if(o0(r)){const o=await r.blob();e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()??"unknown_file");const l=Fc(o)?[await o.arrayBuffer()]:[o];return new Ep(l,e,t)}const n=await TC(r);if(e||(e=IC(r)??"unknown_file"),!(t!=null&&t.type)){const o=(a=n[0])==null?void 0:a.type;typeof o=="string"&&(t={...t,type:o})}return new Ep(n,e,t)}async function TC(r){var t;let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(Fc(r))e.push(await r.arrayBuffer());else if(NC(r))for await(const n of r)e.push(n);else throw new Error(`Unexpected data type: ${typeof r}; constructor: ${(t=r==null?void 0:r.constructor)==null?void 0:t.name}; props: ${AC(r)}`);return e}function AC(r){return`[${Object.getOwnPropertyNames(r).map(t=>`"${t}"`).join(", ")}]`}function IC(r){var e;return Gf(r.name)||Gf(r.filename)||((e=Gf(r.path))==null?void 0:e.split(/[\\/]/).pop())}const Gf=r=>{if(typeof r=="string")return r;if(typeof Buffer<"u"&&r instanceof Buffer)return String(r)},NC=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",Gv=r=>r&&typeof r=="object"&&r.body&&r[Symbol.toStringTag]==="MultipartBody",Ys=async r=>{const e=await $C(r.body);return Wb(e,r)},$C=async r=>{const e=new Vb;return await Promise.all(Object.entries(r||{}).map(([t,n])=>kp(e,t,n))),e},kp=async(r,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")r.append(e,String(t));else if(OC(t)){const n=await u0(t);r.append(e,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>kp(r,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,a])=>kp(r,`${e}[${n}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Ws={},jC=function(r,e,t,n,a){if(typeof e=="function"?r!==e||!a:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t},LC=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Iu;async function c0(r){const{response:e}=r;if(r.options.stream)return Zs("response",e.status,e.url,e.headers,e.body),r.options.__streamClass?r.options.__streamClass.fromSSEResponse(e,r.controller):or.fromSSEResponse(e,r.controller);if(e.status===204)return null;if(r.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const o=await e.json();return Zs("response",e.status,e.url,e.headers,o),d0(o,e)}const a=await e.text();return Zs("response",e.status,e.url,e.headers,a),a}function d0(r,e){return!r||typeof r!="object"||Array.isArray(r)?r:Object.defineProperty(r,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Uc extends Promise{constructor(e,t=c0){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Uc(this.responsePromise,async t=>d0(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class MC{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:a,fetch:o}){this.baseURL=e,this.maxRetries=Jf("maxRetries",t),this.timeout=Jf("timeout",n),this.httpAgent=a,this.fetch=o??Hb}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...HC(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${ZC()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async a=>{const o=a&&Fc(a==null?void 0:a.body)?new DataView(await a.body.arrayBuffer()):(a==null?void 0:a.body)instanceof DataView?a.body:(a==null?void 0:a.body)instanceof ArrayBuffer?new DataView(a.body):a&&ArrayBuffer.isView(a==null?void 0:a.body)?new DataView(a.body.buffer):a==null?void 0:a.body;return{method:e,path:t,...a,body:o}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var S;const{method:n,path:a,query:o,headers:l={}}=e,c=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:Gv(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,d=this.calculateContentLength(c),f=this.buildURL(a,o);"timeout"in e&&Jf("timeout",e.timeout);const p=e.timeout??this.timeout,y=e.httpAgent??this.httpAgent??Zb(f),g=p+1e3;typeof((S=y==null?void 0:y.options)==null?void 0:S.timeout)=="number"&&g>(y.options.timeout??0)&&(y.options.timeout=g),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const w=this.buildHeaders({options:e,headers:l,contentLength:d,retryCount:t});return{req:{method:n,...c&&{body:c},headers:w,...y&&{agent:y},signal:e.signal??null},url:f,timeout:p}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:a}){const o={};n&&(o["content-length"]=n);const l=this.defaultHeaders(e);return Qv(o,l),Qv(o,t),Gv(e.body)&&So!=="node"&&delete o["content-type"],Yv(l,"x-stainless-retry-count")===void 0&&Yv(t,"x-stainless-retry-count")===void 0&&(o["x-stainless-retry-count"]=String(a)),this.validateHeaders(o,t),o}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,a){return Ot.generate(e,t,n,a)}request(e,t=null){return new Uc(this.makeRequest(e,t))}async makeRequest(e,t){var y,g;const n=await e,a=n.maxRetries??this.maxRetries;t==null&&(t=a),await this.prepareOptions(n);const{req:o,url:l,timeout:c}=this.buildRequest(n,{retryCount:a-t});if(await this.prepareRequest(o,{url:l,options:n}),Zs("request",l,n,o.headers),(y=n.signal)!=null&&y.aborted)throw new Pn;const d=new AbortController,f=await this.fetchWithTimeout(l,o,c,d).catch(Cp);if(f instanceof Error){if((g=n.signal)!=null&&g.aborted)throw new Pn;if(t)return this.retryRequest(n,t);throw f.name==="AbortError"?new Dc:new Mc({cause:f})}const p=FC(f.headers);if(!f.ok){if(t&&this.shouldRetry(f)){const E=`retrying, ${t} attempts remaining`;return Zs(`response (error; ${E})`,f.status,l,p),this.retryRequest(n,t,p)}const w=await f.text().catch(E=>Cp(E).message),_=VC(w),S=_?void 0:w;throw Zs(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,f.status,l,p,S),this.makeStatusError(f.status,_,S,p)}return{response:f,options:n,controller:d}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new DC(this,n,e)}buildURL(e,t){const n=WC(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return h0(a)||(t={...a,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new $e(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,a){const{signal:o,...l}=t||{};o&&o.addEventListener("abort",()=>a.abort());const c=setTimeout(()=>a.abort(),n);return this.getRequestClient().fetch.call(void 0,e,{signal:a.signal,...l}).finally(()=>{clearTimeout(c)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let a;const o=n==null?void 0:n["retry-after-ms"];if(o){const c=parseFloat(o);Number.isNaN(c)||(a=c)}const l=n==null?void 0:n["retry-after"];if(l&&!a){const c=parseFloat(l);Number.isNaN(c)?a=Date.parse(l)-Date.now():a=c*1e3}if(!(a&&0<=a&&a<60*1e3)){const c=e.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,c)}return await Yo(a),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const o=t-e,l=Math.min(.5*Math.pow(2,o),8),c=1-Math.random()*.25;return l*c*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Ms}`}}class f0{constructor(e,t,n,a){Iu.set(this,void 0),jC(this,Iu,e),this.options=a,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new $e("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[a,o]of n)e.url.searchParams.set(a,o);t.query=void 0,t.path=e.url.toString()}return await LC(this,Iu,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Iu=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class DC extends Uc{constructor(e,t,n){super(t,async a=>new n(e,a.response,await c0(a),a.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const FC=r=>new Proxy(Object.fromEntries(r.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),UC={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},en=r=>typeof r=="object"&&r!==null&&!h0(r)&&Object.keys(r).every(e=>p0(UC,e)),zC=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ms,"X-Stainless-OS":Kv(Deno.build.os),"X-Stainless-Arch":Jv(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ms,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ms,"X-Stainless-OS":Kv(process.platform),"X-Stainless-Arch":Jv(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const r=BC();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ms,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ms,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function BC(){if(typeof navigator>"u"||!navigator)return null;const r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of r){const n=t.exec(navigator.userAgent);if(n){const a=n[1]||0,o=n[2]||0,l=n[3]||0;return{browser:e,version:`${a}.${o}.${l}`}}}return null}const Jv=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",Kv=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown");let Xv;const HC=()=>Xv??(Xv=zC()),VC=r=>{try{return JSON.parse(r)}catch{return}},qC=new RegExp("^(?:[a-z]+:)?//","i"),WC=r=>qC.test(r),Yo=r=>new Promise(e=>setTimeout(e,r)),Jf=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new $e(`${r} must be an integer`);if(e<0)throw new $e(`${r} must be a positive integer`);return e},Cp=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null)try{return new Error(JSON.stringify(r))}catch{}return new Error(r)},Nu=r=>{var e,t,n,a;if(typeof process<"u")return((e=Ws==null?void 0:Ws[r])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(a=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,r))==null?void 0:a.trim()};function h0(r){if(!r)return!0;for(const e in r)return!1;return!0}function p0(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Qv(r,e){for(const t in e){if(!p0(e,t))continue;const n=t.toLowerCase();if(!n)continue;const a=e[t];a===null?delete r[n]:a!==void 0&&(r[n]=a)}}function Zs(r,...e){typeof process<"u"&&(Ws==null?void 0:Ws.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${r}`,...e)}const ZC=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)}),GC=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",JC=r=>typeof(r==null?void 0:r.get)=="function",Yv=(r,e)=>{var n;const t=e.toLowerCase();if(JC(r)){const a=((n=e[0])==null?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(o,l,c)=>l+c.toUpperCase());for(const o of[e,t,e.toUpperCase(),a]){const l=r.get(o);if(l)return l}}for(const[a,o]of Object.entries(r))if(a.toLowerCase()===t)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${e} header, using the first entry.`),o[0]):o};function Kf(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}class KC extends f0{constructor(e,t,n,a){super(e,t,n,a),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Kn extends f0{constructor(e,t,n,a){super(e,t,n,a),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const t=(n=e[e.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class Ge{constructor(e){this._client=e}}let m0=class extends Ge{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},dm=class extends Ge{constructor(){super(...arguments),this.completions=new m0(this._client)}};dm.Completions=m0;class g0 extends Ge{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:!0})}}class y0 extends Ge{create(e,t){return this._client.post("/audio/transcriptions",Ys({body:e,...t}))}}class v0 extends Ge{create(e,t){return this._client.post("/audio/translations",Ys({body:e,...t}))}}class el extends Ge{constructor(){super(...arguments),this.transcriptions=new y0(this._client),this.translations=new v0(this._client),this.speech=new g0(this._client)}}el.Transcriptions=y0;el.Translations=v0;el.Speech=g0;class fm extends Ge{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return en(e)?this.list({},e):this._client.getAPIList("/batches",hm,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class hm extends Kn{}fm.BatchesPage=hm;class pm extends Ge{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return en(e)?this.list({},e):this._client.getAPIList("/assistants",mm,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class mm extends Kn{}pm.AssistantsPage=mm;function ew(r){return typeof r.parse=="function"}const Gs=r=>(r==null?void 0:r.role)==="assistant",w0=r=>(r==null?void 0:r.role)==="function",_0=r=>(r==null?void 0:r.role)==="tool";var zn=function(r,e,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!a:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(r,t):a?a.value=t:e.set(r,t),t},st=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Pp,Ku,Xu,po,mo,Qu,go,Pr,yo,dc,fc,Ds,b0;class x0{constructor(){Pp.add(this),this.controller=new AbortController,Ku.set(this,void 0),Xu.set(this,()=>{}),po.set(this,()=>{}),mo.set(this,void 0),Qu.set(this,()=>{}),go.set(this,()=>{}),Pr.set(this,{}),yo.set(this,!1),dc.set(this,!1),fc.set(this,!1),Ds.set(this,!1),zn(this,Ku,new Promise((e,t)=>{zn(this,Xu,e,"f"),zn(this,po,t,"f")}),"f"),zn(this,mo,new Promise((e,t)=>{zn(this,Qu,e,"f"),zn(this,go,t,"f")}),"f"),st(this,Ku,"f").catch(()=>{}),st(this,mo,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},st(this,Pp,"m",b0).bind(this))},0)}_connected(){this.ended||(st(this,Xu,"f").call(this),this._emit("connect"))}get ended(){return st(this,yo,"f")}get errored(){return st(this,dc,"f")}get aborted(){return st(this,fc,"f")}abort(){this.controller.abort()}on(e,t){return(st(this,Pr,"f")[e]||(st(this,Pr,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=st(this,Pr,"f")[e];if(!n)return this;const a=n.findIndex(o=>o.listener===t);return a>=0&&n.splice(a,1),this}once(e,t){return(st(this,Pr,"f")[e]||(st(this,Pr,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{zn(this,Ds,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){zn(this,Ds,!0,"f"),await st(this,mo,"f")}_emit(e,...t){if(st(this,yo,"f"))return;e==="end"&&(zn(this,yo,!0,"f"),st(this,Qu,"f").call(this));const n=st(this,Pr,"f")[e];if(n&&(st(this,Pr,"f")[e]=n.filter(a=>!a.once),n.forEach(({listener:a})=>a(...t))),e==="abort"){const a=t[0];!st(this,Ds,"f")&&!(n!=null&&n.length)&&Promise.reject(a),st(this,po,"f").call(this,a),st(this,go,"f").call(this,a),this._emit("end");return}if(e==="error"){const a=t[0];!st(this,Ds,"f")&&!(n!=null&&n.length)&&Promise.reject(a),st(this,po,"f").call(this,a),st(this,go,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Ku=new WeakMap,Xu=new WeakMap,po=new WeakMap,mo=new WeakMap,Qu=new WeakMap,go=new WeakMap,Pr=new WeakMap,yo=new WeakMap,dc=new WeakMap,fc=new WeakMap,Ds=new WeakMap,Pp=new WeakSet,b0=function(e){if(zn(this,dc,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Pn),e instanceof Pn)return zn(this,fc,!0,"f"),this._emit("abort",e);if(e instanceof $e)return this._emit("error",e);if(e instanceof Error){const t=new $e(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new $e(String(e)))};function XC(r,e){const t={...r};return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function S0(r){return(r==null?void 0:r.$brand)==="auto-parseable-response-format"}function QC(r,{parser:e,callback:t}){const n={...r};return Object.defineProperties(n,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:e,enumerable:!1},$callback:{value:t,enumerable:!1}}),n}function tl(r){return(r==null?void 0:r.$brand)==="auto-parseable-tool"}function YC(r,e){return!e||!E0(e)?{...r,choices:r.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:gm(r,e)}function gm(r,e){const t=r.choices.map(n=>{var a;if(n.finish_reason==="length")throw new a0;if(n.finish_reason==="content_filter")throw new s0;return{...n,message:{...n.message,tool_calls:((a=n.message.tool_calls)==null?void 0:a.map(o=>tP(e,o)))??[],parsed:n.message.content&&!n.message.refusal?eP(e,n.message.content):null}}});return{...r,choices:t}}function eP(r,e){var t,n;return((t=r.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=r.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(e):JSON.parse(e):null}function tP(r,e){var n;const t=(n=r.tools)==null?void 0:n.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:tl(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function nP(r,e){var n;if(!r)return!1;const t=(n=r.tools)==null?void 0:n.find(a=>{var o;return((o=a.function)==null?void 0:o.name)===e.function.name});return tl(t)||(t==null?void 0:t.function.strict)||!1}function E0(r){var e;return S0(r.response_format)?!0:((e=r.tools)==null?void 0:e.some(t=>tl(t)||t.type==="function"&&t.function.strict===!0))??!1}function rP(r){for(const e of r??[]){if(e.type!=="function")throw new $e(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new $e(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Yt=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},$t,Rp,hc,Op,Tp,Ap,k0,Ip;const tw=10;class C0 extends x0{constructor(){super(...arguments),$t.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(w0(e)||_0(e))&&e.content)this._emit("functionCallResult",e.content);else if(Gs(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Gs(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new $e("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Yt(this,$t,"m",Rp).call(this)}async finalMessage(){return await this.done(),Yt(this,$t,"m",hc).call(this)}async finalFunctionCall(){return await this.done(),Yt(this,$t,"m",Op).call(this)}async finalFunctionCallResult(){return await this.done(),Yt(this,$t,"m",Tp).call(this)}async totalUsage(){return await this.done(),Yt(this,$t,"m",Ap).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=Yt(this,$t,"m",hc).call(this);t&&this._emit("finalMessage",t);const n=Yt(this,$t,"m",Rp).call(this);n&&this._emit("finalContent",n);const a=Yt(this,$t,"m",Op).call(this);a&&this._emit("finalFunctionCall",a);const o=Yt(this,$t,"m",Tp).call(this);o!=null&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some(l=>l.usage)&&this._emit("totalUsage",Yt(this,$t,"m",Ap).call(this))}async _createChatCompletion(e,t,n){const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Yt(this,$t,"m",k0).call(this,t);const o=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(gm(o,t))}async _runChatCompletion(e,t,n){for(const a of t.messages)this._addMessage(a,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){var g;const a="function",{function_call:o="auto",stream:l,...c}=t,d=typeof o!="string"&&(o==null?void 0:o.name),{maxChatCompletions:f=tw}=n||{},p={};for(const w of t.functions)p[w.name||w.function.name]=w;const y=t.functions.map(w=>({name:w.name||w.function.name,parameters:w.parameters,description:w.description}));for(const w of t.messages)this._addMessage(w,!1);for(let w=0;w<f;++w){const S=(g=(await this._createChatCompletion(e,{...c,function_call:o,functions:y,messages:[...this.messages]},n)).choices[0])==null?void 0:g.message;if(!S)throw new $e("missing message in ChatCompletion response");if(!S.function_call)return;const{name:b,arguments:k}=S.function_call,E=p[b];if(E){if(d&&d!==b){const D=`Invalid function_call: ${JSON.stringify(b)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:a,name:b,content:D});continue}}else{const D=`Invalid function_call: ${JSON.stringify(b)}. Available options are: ${y.map(z=>JSON.stringify(z.name)).join(", ")}. Please try again`;this._addMessage({role:a,name:b,content:D});continue}let P;try{P=ew(E)?await E.parse(k):k}catch(D){this._addMessage({role:a,name:b,content:D instanceof Error?D.message:String(D)});continue}const N=await E.function(P,this),j=Yt(this,$t,"m",Ip).call(this,N);if(this._addMessage({role:a,name:b,content:j}),d)return}}async _runTools(e,t,n){var w,_,S;const a="tool",{tool_choice:o="auto",stream:l,...c}=t,d=typeof o!="string"&&((w=o==null?void 0:o.function)==null?void 0:w.name),{maxChatCompletions:f=tw}=n||{},p=t.tools.map(b=>{if(tl(b)){if(!b.$callback)throw new $e("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:b.$callback,name:b.function.name,description:b.function.description||"",parameters:b.function.parameters,parse:b.$parseRaw,strict:!0}}}return b}),y={};for(const b of p)b.type==="function"&&(y[b.function.name||b.function.function.name]=b.function);const g="tools"in t?p.map(b=>b.type==="function"?{type:"function",function:{name:b.function.name||b.function.function.name,parameters:b.function.parameters,description:b.function.description,strict:b.function.strict}}:b):void 0;for(const b of t.messages)this._addMessage(b,!1);for(let b=0;b<f;++b){const E=(_=(await this._createChatCompletion(e,{...c,tool_choice:o,tools:g,messages:[...this.messages]},n)).choices[0])==null?void 0:_.message;if(!E)throw new $e("missing message in ChatCompletion response");if(!((S=E.tool_calls)!=null&&S.length))return;for(const P of E.tool_calls){if(P.type!=="function")continue;const N=P.id,{name:j,arguments:D}=P.function,z=y[j];if(z){if(d&&d!==j){const he=`Invalid tool_call: ${JSON.stringify(j)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:a,tool_call_id:N,content:he});continue}}else{const he=`Invalid tool_call: ${JSON.stringify(j)}. Available options are: ${Object.keys(y).map(me=>JSON.stringify(me)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:N,content:he});continue}let q;try{q=ew(z)?await z.parse(D):D}catch(he){const me=he instanceof Error?he.message:String(he);this._addMessage({role:a,tool_call_id:N,content:me});continue}const K=await z.function(q,this),oe=Yt(this,$t,"m",Ip).call(this,K);if(this._addMessage({role:a,tool_call_id:N,content:oe}),d)return}}}}$t=new WeakSet,Rp=function(){return Yt(this,$t,"m",hc).call(this).content??null},hc=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Gs(t)){const{function_call:n,...a}=t,o={...a,content:t.content??null,refusal:t.refusal??null};return n&&(o.function_call=n),o}}throw new $e("stream ended without producing a ChatCompletionMessage with role=assistant")},Op=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const a=this.messages[n];if(Gs(a)&&(a!=null&&a.function_call))return a.function_call;if(Gs(a)&&((e=a==null?void 0:a.tool_calls)!=null&&e.length))return(t=a.tool_calls.at(-1))==null?void 0:t.function}},Tp=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(w0(t)&&t.content!=null||_0(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var a;return n.role==="assistant"&&((a=n.tool_calls)==null?void 0:a.some(o=>o.type==="function"&&o.id===t.tool_call_id))}))return t.content}},Ap=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},k0=function(e){if(e.n!=null&&e.n>1)throw new $e("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ip=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Ao extends C0{static runFunctions(e,t,n){const a=new Ao,o={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(e,t,o)),a}static runTools(e,t,n){const a=new Ao,o={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,t,o)),a}_addMessage(e,t=!0){super._addMessage(e,t),Gs(e)&&e.content&&this._emit("content",e.content)}}const P0=1,R0=2,O0=4,T0=8,A0=16,I0=32,N0=64,$0=128,j0=256,L0=$0|j0,M0=A0|I0|L0|N0,D0=P0|R0|M0,F0=O0|T0,aP=D0|F0,xt={STR:P0,NUM:R0,ARR:O0,OBJ:T0,NULL:A0,BOOL:I0,NAN:N0,INFINITY:$0,MINUS_INFINITY:j0,INF:L0,SPECIAL:M0,ATOM:D0,COLLECTION:F0,ALL:aP};class sP extends Error{}class iP extends Error{}function oP(r,e=xt.ALL){if(typeof r!="string")throw new TypeError(`expecting str, got ${typeof r}`);if(!r.trim())throw new Error(`${r} is empty`);return lP(r.trim(),e)}const lP=(r,e)=>{const t=r.length;let n=0;const a=g=>{throw new sP(`${g} at position ${n}`)},o=g=>{throw new iP(`${g} at position ${n}`)},l=()=>(y(),n>=t&&a("Unexpected end of input"),r[n]==='"'?c():r[n]==="{"?d():r[n]==="["?f():r.substring(n,n+4)==="null"||xt.NULL&e&&t-n<4&&"null".startsWith(r.substring(n))?(n+=4,null):r.substring(n,n+4)==="true"||xt.BOOL&e&&t-n<4&&"true".startsWith(r.substring(n))?(n+=4,!0):r.substring(n,n+5)==="false"||xt.BOOL&e&&t-n<5&&"false".startsWith(r.substring(n))?(n+=5,!1):r.substring(n,n+8)==="Infinity"||xt.INFINITY&e&&t-n<8&&"Infinity".startsWith(r.substring(n))?(n+=8,1/0):r.substring(n,n+9)==="-Infinity"||xt.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(r.substring(n))?(n+=9,-1/0):r.substring(n,n+3)==="NaN"||xt.NAN&e&&t-n<3&&"NaN".startsWith(r.substring(n))?(n+=3,NaN):p()),c=()=>{const g=n;let w=!1;for(n++;n<t&&(r[n]!=='"'||w&&r[n-1]==="\\");)w=r[n]==="\\"?!w:!1,n++;if(r.charAt(n)=='"')try{return JSON.parse(r.substring(g,++n-Number(w)))}catch(_){o(String(_))}else if(xt.STR&e)try{return JSON.parse(r.substring(g,n-Number(w))+'"')}catch{return JSON.parse(r.substring(g,r.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},d=()=>{n++,y();const g={};try{for(;r[n]!=="}";){if(y(),n>=t&&xt.OBJ&e)return g;const w=c();y(),n++;try{const _=l();Object.defineProperty(g,w,{value:_,writable:!0,enumerable:!0,configurable:!0})}catch(_){if(xt.OBJ&e)return g;throw _}y(),r[n]===","&&n++}}catch{if(xt.OBJ&e)return g;a("Expected '}' at end of object")}return n++,g},f=()=>{n++;const g=[];try{for(;r[n]!=="]";)g.push(l()),y(),r[n]===","&&n++}catch{if(xt.ARR&e)return g;a("Expected ']' at end of array")}return n++,g},p=()=>{if(n===0){r==="-"&&xt.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(r)}catch(w){if(xt.NUM&e)try{return r[r.length-1]==="."?JSON.parse(r.substring(0,r.lastIndexOf("."))):JSON.parse(r.substring(0,r.lastIndexOf("e")))}catch{}o(String(w))}}const g=n;for(r[n]==="-"&&n++;r[n]&&!",]}".includes(r[n]);)n++;n==t&&!(xt.NUM&e)&&a("Unterminated number literal");try{return JSON.parse(r.substring(g,n))}catch{r.substring(g,n)==="-"&&xt.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(r.substring(g,r.lastIndexOf("e")))}catch(_){o(String(_))}}},y=()=>{for(;n<t&&` 
\r	`.includes(r[n]);)n++};return l()},nw=r=>oP(r,xt.ALL^xt.NUM);var $s=function(r,e,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!a:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(r,t):a?a.value=t:e.set(r,t),t},Je=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},mt,Er,js,sa,Xf,$u,Qf,Yf,eh,ju,th,rw;class Io extends C0{constructor(e){super(),mt.add(this),Er.set(this,void 0),js.set(this,void 0),sa.set(this,void 0),$s(this,Er,e,"f"),$s(this,js,[],"f")}get currentChatCompletionSnapshot(){return Je(this,sa,"f")}static fromReadableStream(e){const t=new Io(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const a=new Io(t);return a._run(()=>a._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,t,n){var l;super._createChatCompletion;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Je(this,mt,"m",Xf).call(this);const o=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const c of o)Je(this,mt,"m",Qf).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new Pn;return this._addChatCompletion(Je(this,mt,"m",ju).call(this))}async _fromReadableStream(e,t){var l;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Je(this,mt,"m",Xf).call(this),this._connected();const a=or.fromReadableStream(e,this.controller);let o;for await(const c of a)o&&o!==c.id&&this._addChatCompletion(Je(this,mt,"m",ju).call(this)),Je(this,mt,"m",Qf).call(this,c),o=c.id;if((l=a.controller.signal)!=null&&l.aborted)throw new Pn;return this._addChatCompletion(Je(this,mt,"m",ju).call(this))}[(Er=new WeakMap,js=new WeakMap,sa=new WeakMap,mt=new WeakSet,Xf=function(){this.ended||$s(this,sa,void 0,"f")},$u=function(t){let n=Je(this,js,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Je(this,js,"f")[t.index]=n,n)},Qf=function(t){var a,o,l,c,d,f,p,y,g,w,_,S,b,k,E;if(this.ended)return;const n=Je(this,mt,"m",rw).call(this,t);this._emit("chunk",t,n);for(const P of t.choices){const N=n.choices[P.index];P.delta.content!=null&&((a=N.message)==null?void 0:a.role)==="assistant"&&((o=N.message)!=null&&o.content)&&(this._emit("content",P.delta.content,N.message.content),this._emit("content.delta",{delta:P.delta.content,snapshot:N.message.content,parsed:N.message.parsed})),P.delta.refusal!=null&&((l=N.message)==null?void 0:l.role)==="assistant"&&((c=N.message)!=null&&c.refusal)&&this._emit("refusal.delta",{delta:P.delta.refusal,snapshot:N.message.refusal}),((d=P.logprobs)==null?void 0:d.content)!=null&&((f=N.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(p=P.logprobs)==null?void 0:p.content,snapshot:((y=N.logprobs)==null?void 0:y.content)??[]}),((g=P.logprobs)==null?void 0:g.refusal)!=null&&((w=N.message)==null?void 0:w.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(_=P.logprobs)==null?void 0:_.refusal,snapshot:((S=N.logprobs)==null?void 0:S.refusal)??[]});const j=Je(this,mt,"m",$u).call(this,N);N.finish_reason&&(Je(this,mt,"m",eh).call(this,N),j.current_tool_call_index!=null&&Je(this,mt,"m",Yf).call(this,N,j.current_tool_call_index));for(const D of P.delta.tool_calls??[])j.current_tool_call_index!==D.index&&(Je(this,mt,"m",eh).call(this,N),j.current_tool_call_index!=null&&Je(this,mt,"m",Yf).call(this,N,j.current_tool_call_index)),j.current_tool_call_index=D.index;for(const D of P.delta.tool_calls??[]){const z=(b=N.message.tool_calls)==null?void 0:b[D.index];z!=null&&z.type&&((z==null?void 0:z.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(k=z.function)==null?void 0:k.name,index:D.index,arguments:z.function.arguments,parsed_arguments:z.function.parsed_arguments,arguments_delta:((E=D.function)==null?void 0:E.arguments)??""}):(z==null||z.type,void 0))}}},Yf=function(t,n){var l,c,d;if(Je(this,mt,"m",$u).call(this,t).done_tool_calls.has(n))return;const o=(l=t.message.tool_calls)==null?void 0:l[n];if(!o)throw new Error("no tool call snapshot");if(!o.type)throw new Error("tool call snapshot missing `type`");if(o.type==="function"){const f=(d=(c=Je(this,Er,"f"))==null?void 0:c.tools)==null?void 0:d.find(p=>p.type==="function"&&p.function.name===o.function.name);this._emit("tool_calls.function.arguments.done",{name:o.function.name,index:n,arguments:o.function.arguments,parsed_arguments:tl(f)?f.$parseRaw(o.function.arguments):f!=null&&f.function.strict?JSON.parse(o.function.arguments):null})}else o.type},eh=function(t){var a,o;const n=Je(this,mt,"m",$u).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const l=Je(this,mt,"m",th).call(this);this._emit("content.done",{content:t.message.content,parsed:l?l.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(a=t.logprobs)!=null&&a.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(o=t.logprobs)!=null&&o.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},ju=function(){if(this.ended)throw new $e("stream has ended, this shouldn't happen");const t=Je(this,sa,"f");if(!t)throw new $e("request ended without sending any chunks");return $s(this,sa,void 0,"f"),$s(this,js,[],"f"),uP(t,Je(this,Er,"f"))},th=function(){var n;const t=(n=Je(this,Er,"f"))==null?void 0:n.response_format;return S0(t)?t:null},rw=function(t){var n,a,o,l;let c=Je(this,sa,"f");const{choices:d,...f}=t;c?Object.assign(c,f):c=$s(this,sa,{...f,choices:[]},"f");for(const{delta:p,finish_reason:y,index:g,logprobs:w=null,..._}of t.choices){let S=c.choices[g];if(S||(S=c.choices[g]={finish_reason:y,index:g,message:{},logprobs:w,..._}),w)if(!S.logprobs)S.logprobs=Object.assign({},w);else{const{content:D,refusal:z,...q}=w;Object.assign(S.logprobs,q),D&&((n=S.logprobs).content??(n.content=[]),S.logprobs.content.push(...D)),z&&((a=S.logprobs).refusal??(a.refusal=[]),S.logprobs.refusal.push(...z))}if(y&&(S.finish_reason=y,Je(this,Er,"f")&&E0(Je(this,Er,"f")))){if(y==="length")throw new a0;if(y==="content_filter")throw new s0}if(Object.assign(S,_),!p)continue;const{content:b,refusal:k,function_call:E,role:P,tool_calls:N,...j}=p;if(Object.assign(S.message,j),k&&(S.message.refusal=(S.message.refusal||"")+k),P&&(S.message.role=P),E&&(S.message.function_call?(E.name&&(S.message.function_call.name=E.name),E.arguments&&((o=S.message.function_call).arguments??(o.arguments=""),S.message.function_call.arguments+=E.arguments)):S.message.function_call=E),b&&(S.message.content=(S.message.content||"")+b,!S.message.refusal&&Je(this,mt,"m",th).call(this)&&(S.message.parsed=nw(S.message.content))),N){S.message.tool_calls||(S.message.tool_calls=[]);for(const{index:D,id:z,type:q,function:K,...oe}of N){const he=(l=S.message.tool_calls)[D]??(l[D]={});Object.assign(he,oe),z&&(he.id=z),q&&(he.type=q),K&&(he.function??(he.function={name:K.name??"",arguments:""})),K!=null&&K.name&&(he.function.name=K.name),K!=null&&K.arguments&&(he.function.arguments+=K.arguments,nP(Je(this,Er,"f"),he)&&(he.function.parsed_arguments=nw(he.function.arguments)))}}}return c},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",a=>{const o=t.shift();o?o.resolve(a):e.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const o of t)o.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const o of t)o.reject(a);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((o,l)=>t.push({resolve:o,reject:l})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new or(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function uP(r,e){const{id:t,choices:n,created:a,model:o,system_fingerprint:l,...c}=r,d={...c,id:t,choices:n.map(({message:f,finish_reason:p,index:y,logprobs:g,...w})=>{if(!p)throw new $e(`missing finish_reason for choice ${y}`);const{content:_=null,function_call:S,tool_calls:b,...k}=f,E=f.role;if(!E)throw new $e(`missing role for choice ${y}`);if(S){const{arguments:P,name:N}=S;if(P==null)throw new $e(`missing function_call.arguments for choice ${y}`);if(!N)throw new $e(`missing function_call.name for choice ${y}`);return{...w,message:{content:_,function_call:{arguments:P,name:N},role:E,refusal:f.refusal??null},finish_reason:p,index:y,logprobs:g}}return b?{...w,index:y,finish_reason:p,logprobs:g,message:{...k,role:E,content:_,refusal:f.refusal??null,tool_calls:b.map((P,N)=>{const{function:j,type:D,id:z,...q}=P,{arguments:K,name:oe,...he}=j||{};if(z==null)throw new $e(`missing choices[${y}].tool_calls[${N}].id
${Lu(r)}`);if(D==null)throw new $e(`missing choices[${y}].tool_calls[${N}].type
${Lu(r)}`);if(oe==null)throw new $e(`missing choices[${y}].tool_calls[${N}].function.name
${Lu(r)}`);if(K==null)throw new $e(`missing choices[${y}].tool_calls[${N}].function.arguments
${Lu(r)}`);return{...q,id:z,type:D,function:{...he,name:oe,arguments:K}}})}}:{...w,message:{...k,content:_,role:E,refusal:f.refusal??null},finish_reason:p,index:y,logprobs:g}}),created:a,model:o,object:"chat.completion",...l?{system_fingerprint:l}:{}};return YC(d,e)}function Lu(r){return JSON.stringify(r)}class Js extends Io{static fromReadableStream(e){const t=new Js(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){const a=new Js(null),o={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return a._run(()=>a._runFunctions(e,t,o)),a}static runTools(e,t,n){const a=new Js(t),o={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,t,o)),a}}let U0=class extends Ge{parse(e,t){return rP(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>gm(n,e))}runFunctions(e,t){return e.stream?Js.runFunctions(this._client,e,t):Ao.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Js.runTools(this._client,e,t):Ao.runTools(this._client,e,t)}stream(e,t){return Io.createChatCompletion(this._client,e,t)}},Np=class extends Ge{constructor(){super(...arguments),this.completions=new U0(this._client)}};(function(r){r.Completions=U0})(Np||(Np={}));var ye=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},ln=function(r,e,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!a:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(r,t):a?a.value=t:e.set(r,t),t},Rt,$p,ir,Yu,Bn,Ha,zs,za,pc,un,ec,tc,Eo,vo,wo,aw,sw,iw,ow,lw,uw,cw;class Hn extends x0{constructor(){super(...arguments),Rt.add(this),$p.set(this,[]),ir.set(this,{}),Yu.set(this,{}),Bn.set(this,void 0),Ha.set(this,void 0),zs.set(this,void 0),za.set(this,void 0),pc.set(this,void 0),un.set(this,void 0),ec.set(this,void 0),tc.set(this,void 0),Eo.set(this,void 0)}[($p=new WeakMap,ir=new WeakMap,Yu=new WeakMap,Bn=new WeakMap,Ha=new WeakMap,zs=new WeakMap,za=new WeakMap,pc=new WeakMap,un=new WeakMap,ec=new WeakMap,tc=new WeakMap,Eo=new WeakMap,Rt=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",a=>{const o=t.shift();o?o.resolve(a):e.push(a)}),this.on("end",()=>{n=!0;for(const a of t)a.resolve(void 0);t.length=0}),this.on("abort",a=>{n=!0;for(const o of t)o.reject(a);t.length=0}),this.on("error",a=>{n=!0;for(const o of t)o.reject(a);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((o,l)=>t.push({resolve:o,reject:l})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new Hn;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var o;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=or.fromReadableStream(e,this.controller);for await(const l of a)ye(this,Rt,"m",vo).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new Pn;return this._addRun(ye(this,Rt,"m",wo).call(this))}toReadableStream(){return new or(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,a,o){const l=new Hn;return l._run(()=>l._runToolAssistantStream(e,t,n,a,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),l}async _createToolAssistantStream(e,t,n,a,o){var f;const l=o==null?void 0:o.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",()=>this.controller.abort()));const c={...a,stream:!0},d=await e.submitToolOutputs(t,n,c,{...o,signal:this.controller.signal});this._connected();for await(const p of d)ye(this,Rt,"m",vo).call(this,p);if((f=d.controller.signal)!=null&&f.aborted)throw new Pn;return this._addRun(ye(this,Rt,"m",wo).call(this))}static createThreadAssistantStream(e,t,n){const a=new Hn;return a._run(()=>a._threadAssistantStream(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,t,n,a){const o=new Hn;return o._run(()=>o._runAssistantStream(e,t,n,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return ye(this,ec,"f")}currentRun(){return ye(this,tc,"f")}currentMessageSnapshot(){return ye(this,Bn,"f")}currentRunStepSnapshot(){return ye(this,Eo,"f")}async finalRunSteps(){return await this.done(),Object.values(ye(this,ir,"f"))}async finalMessages(){return await this.done(),Object.values(ye(this,Yu,"f"))}async finalRun(){if(await this.done(),!ye(this,Ha,"f"))throw Error("Final run was not received.");return ye(this,Ha,"f")}async _createThreadAssistantStream(e,t,n){var c;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...t,stream:!0},l=await e.createAndRun(o,{...n,signal:this.controller.signal});this._connected();for await(const d of l)ye(this,Rt,"m",vo).call(this,d);if((c=l.controller.signal)!=null&&c.aborted)throw new Pn;return this._addRun(ye(this,Rt,"m",wo).call(this))}async _createAssistantStream(e,t,n,a){var d;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...n,stream:!0},c=await e.create(t,l,{...a,signal:this.controller.signal});this._connected();for await(const f of c)ye(this,Rt,"m",vo).call(this,f);if((d=c.controller.signal)!=null&&d.aborted)throw new Pn;return this._addRun(ye(this,Rt,"m",wo).call(this))}static accumulateDelta(e,t){for(const[n,a]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=a;continue}let o=e[n];if(o==null){e[n]=a;continue}if(n==="index"||n==="type"){e[n]=a;continue}if(typeof o=="string"&&typeof a=="string")o+=a;else if(typeof o=="number"&&typeof a=="number")o+=a;else if(Kf(o)&&Kf(a))o=this.accumulateDelta(o,a);else if(Array.isArray(o)&&Array.isArray(a)){if(o.every(l=>typeof l=="string"||typeof l=="number")){o.push(...a);continue}for(const l of a){if(!Kf(l))throw new Error(`Expected array delta entry to be an object but got: ${l}`);const c=l.index;if(c==null)throw console.error(l),new Error("Expected array delta entry to have an `index` property");if(typeof c!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);const d=o[c];d==null?o.push(l):o[c]=this.accumulateDelta(d,l)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${a}, accValue: ${o}`);e[n]=o}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,a){return await this._createAssistantStream(t,e,n,a)}async _runToolAssistantStream(e,t,n,a,o){return await this._createToolAssistantStream(n,e,t,a,o)}}vo=function(e){if(!this.ended)switch(ln(this,ec,e,"f"),ye(this,Rt,"m",iw).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":ye(this,Rt,"m",cw).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ye(this,Rt,"m",sw).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":ye(this,Rt,"m",aw).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},wo=function(){if(this.ended)throw new $e("stream has ended, this shouldn't happen");if(!ye(this,Ha,"f"))throw Error("Final run has not been received");return ye(this,Ha,"f")},aw=function(e){const[t,n]=ye(this,Rt,"m",lw).call(this,e,ye(this,Bn,"f"));ln(this,Bn,t,"f"),ye(this,Yu,"f")[t.id]=t;for(const a of n){const o=t.content[a.index];(o==null?void 0:o.type)=="text"&&this._emit("textCreated",o.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const a of e.data.delta.content){if(a.type=="text"&&a.text){let o=a.text,l=t.content[a.index];if(l&&l.type=="text")this._emit("textDelta",o,l.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=ye(this,zs,"f")){if(ye(this,za,"f"))switch(ye(this,za,"f").type){case"text":this._emit("textDone",ye(this,za,"f").text,ye(this,Bn,"f"));break;case"image_file":this._emit("imageFileDone",ye(this,za,"f").image_file,ye(this,Bn,"f"));break}ln(this,zs,a.index,"f")}ln(this,za,t.content[a.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(ye(this,zs,"f")!==void 0){const a=e.data.content[ye(this,zs,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,ye(this,Bn,"f"));break;case"text":this._emit("textDone",a.text,ye(this,Bn,"f"));break}}ye(this,Bn,"f")&&this._emit("messageDone",e.data),ln(this,Bn,void 0,"f")}},sw=function(e){const t=ye(this,Rt,"m",ow).call(this,e);switch(ln(this,Eo,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const o of n.step_details.tool_calls)o.index==ye(this,pc,"f")?this._emit("toolCallDelta",o,t.step_details.tool_calls[o.index]):(ye(this,un,"f")&&this._emit("toolCallDone",ye(this,un,"f")),ln(this,pc,o.index,"f"),ln(this,un,t.step_details.tool_calls[o.index],"f"),ye(this,un,"f")&&this._emit("toolCallCreated",ye(this,un,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ln(this,Eo,void 0,"f"),e.data.step_details.type=="tool_calls"&&ye(this,un,"f")&&(this._emit("toolCallDone",ye(this,un,"f")),ln(this,un,void 0,"f")),this._emit("runStepDone",e.data,t);break}},iw=function(e){ye(this,$p,"f").push(e),this._emit("event",e)},ow=function(e){switch(e.event){case"thread.run.step.created":return ye(this,ir,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=ye(this,ir,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const a=Hn.accumulateDelta(t,n.delta);ye(this,ir,"f")[e.data.id]=a}return ye(this,ir,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":ye(this,ir,"f")[e.data.id]=e.data;break}if(ye(this,ir,"f")[e.data.id])return ye(this,ir,"f")[e.data.id];throw new Error("No snapshot available")},lw=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(const o of a.delta.content)if(o.index in t.content){let l=t.content[o.index];t.content[o.index]=ye(this,Rt,"m",uw).call(this,o,l)}else t.content[o.index]=o,n.push(o);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},uw=function(e,t){return Hn.accumulateDelta(t,e)},cw=function(e){switch(ln(this,tc,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ln(this,Ha,e.data,"f"),ye(this,un,"f")&&(this._emit("toolCallDone",ye(this,un,"f")),ln(this,un,void 0,"f"));break}};class ym extends Ge{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,a){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,t={},n){return en(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,vm,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class vm extends Kn{}ym.MessagesPage=vm;class wm extends Ge{retrieve(e,t,n,a={},o){return en(a)?this.retrieve(e,t,n,{},a):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:a,...o,headers:{"OpenAI-Beta":"assistants=v2",...o==null?void 0:o.headers}})}list(e,t,n={},a){return en(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,_m,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class _m extends Kn{}wm.RunStepsPage=_m;class nl extends Ge{constructor(){super(...arguments),this.steps=new wm(this._client)}create(e,t,n){const{include:a,...o}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:a},body:o,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,a){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,t={},n){return en(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,bm,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const a=await this.create(e,t,n);return await this.poll(e,a.id,n)}createAndStream(e,t,n){return Hn.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:o,response:l}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const d=l.headers.get("openai-poll-after-ms");if(d){const f=parseInt(d);isNaN(f)||(c=f)}}await Yo(c);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(e,t,n){return Hn.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,a){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,a){const o=await this.submitToolOutputs(e,t,n,a);return await this.poll(e,o.id,a)}submitToolOutputsStream(e,t,n,a){return Hn.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,a)}}class bm extends Kn{}nl.RunsPage=bm;nl.Steps=wm;nl.RunStepsPage=_m;class li extends Ge{constructor(){super(...arguments),this.runs=new nl(this._client),this.messages=new ym(this._client)}create(e={},t){return en(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return Hn.createThreadAssistantStream(e,this._client.beta.threads,t)}}li.Runs=nl;li.RunsPage=bm;li.Messages=ym;li.MessagesPage=vm;const cP=async r=>{const e=await Promise.allSettled(r),t=e.filter(a=>a.status==="rejected");if(t.length){for(const a of t)console.error(a.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const a of e)a.status==="fulfilled"&&n.push(a.value);return n};let xm=class extends Ge{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return en(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,zc,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const a=await this.create(e,t,n);return await this.poll(e,a.id,n)}async poll(e,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const o=await this.retrieve(e,t,{...n,headers:a}).withResponse(),l=o.data;switch(l.status){case"in_progress":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const d=o.response.headers.get("openai-poll-after-ms");if(d){const f=parseInt(d);isNaN(f)||(c=f)}}await Yo(c);break;case"failed":case"completed":return l}}}async upload(e,t,n){const a=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:a.id},n)}async uploadAndPoll(e,t,n){const a=await this.upload(e,t,n);return await this.poll(e,a.id,n)}};class zc extends Kn{}xm.VectorStoreFilesPage=zc;class z0 extends Ge{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const a=await this.create(e,t);return await this.poll(e,a.id,n)}listFiles(e,t,n={},a){return en(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,zc,{query:n,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async poll(e,t,n){const a={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:o,response:l}=await this.retrieve(e,t,{...n,headers:a}).withResponse();switch(o.status){case"in_progress":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const d=l.headers.get("openai-poll-after-ms");if(d){const f=parseInt(d);isNaN(f)||(c=f)}}await Yo(c);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},a){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=(a==null?void 0:a.maxConcurrency)??5,l=Math.min(o,t.length),c=this._client,d=t.values(),f=[...n];async function p(g){for(let w of g){const _=await c.files.create({file:w,purpose:"assistants"},a);f.push(_.id)}}const y=Array(l).fill(d).map(p);return await cP(y),await this.createAndPoll(e,{file_ids:f})}}class ui extends Ge{constructor(){super(...arguments),this.files=new xm(this._client),this.fileBatches=new z0(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return en(e)?this.list({},e):this._client.getAPIList("/vector_stores",Sm,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Sm extends Kn{}ui.VectorStoresPage=Sm;ui.Files=xm;ui.VectorStoreFilesPage=zc;ui.FileBatches=z0;class ns extends Ge{constructor(){super(...arguments),this.vectorStores=new ui(this._client),this.chat=new Np(this._client),this.assistants=new pm(this._client),this.threads=new li(this._client)}}ns.VectorStores=ui;ns.VectorStoresPage=Sm;ns.Assistants=pm;ns.AssistantsPage=mm;ns.Threads=li;class B0 extends Ge{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class H0 extends Ge{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class Em extends Ge{create(e,t){return this._client.post("/files",Ys({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return en(e)?this.list({},e):this._client.getAPIList("/files",km,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t==null?void 0:t.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),o=Date.now();let l=await this.retrieve(e);for(;!l.status||!a.has(l.status);)if(await Yo(t),l=await this.retrieve(e),Date.now()-o>n)throw new Dc({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return l}}class km extends Kn{}Em.FileObjectsPage=km;class Cm extends Ge{list(e,t={},n){return en(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Pm,{query:t,...n})}}class Pm extends Kn{}Cm.FineTuningJobCheckpointsPage=Pm;class ci extends Ge{constructor(){super(...arguments),this.checkpoints=new Cm(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return en(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Rm,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return en(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Om,{query:t,...n})}}class Rm extends Kn{}class Om extends Kn{}ci.FineTuningJobsPage=Rm;ci.FineTuningJobEventsPage=Om;ci.Checkpoints=Cm;ci.FineTuningJobCheckpointsPage=Pm;class rl extends Ge{constructor(){super(...arguments),this.jobs=new ci(this._client)}}rl.Jobs=ci;rl.FineTuningJobsPage=Rm;rl.FineTuningJobEventsPage=Om;class V0 extends Ge{createVariation(e,t){return this._client.post("/images/variations",Ys({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Ys({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class Tm extends Ge{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Am,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Am extends KC{}Tm.ModelsPage=Am;class q0 extends Ge{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class W0 extends Ge{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,Ys({body:t,...n}))}}class Im extends Ge{constructor(){super(...arguments),this.parts=new W0(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}Im.Parts=W0;var Z0;let De=class extends MC{constructor({baseURL:e=Nu("OPENAI_BASE_URL"),apiKey:t=Nu("OPENAI_API_KEY"),organization:n=Nu("OPENAI_ORG_ID")??null,project:a=Nu("OPENAI_PROJECT_ID")??null,...o}={}){if(t===void 0)throw new $e("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const l={apiKey:t,organization:n,project:a,...o,baseURL:e||"https://api.openai.com/v1"};if(!l.dangerouslyAllowBrowser&&GC())throw new $e(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:l.baseURL,timeout:l.timeout??6e5,httpAgent:l.httpAgent,maxRetries:l.maxRetries,fetch:l.fetch}),this.completions=new B0(this),this.chat=new dm(this),this.embeddings=new H0(this),this.files=new Em(this),this.images=new V0(this),this.audio=new el(this),this.moderations=new q0(this),this.models=new Tm(this),this.fineTuning=new rl(this),this.beta=new ns(this),this.batches=new fm(this),this.uploads=new Im(this),this._options=l,this.apiKey=t,this.organization=n,this.project=a}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return _C(e,{arrayFormat:"brackets"})}};Z0=De;De.OpenAI=Z0;De.DEFAULT_TIMEOUT=6e5;De.OpenAIError=$e;De.APIError=Ot;De.APIConnectionError=Mc;De.APIConnectionTimeoutError=Dc;De.APIUserAbortError=Pn;De.NotFoundError=Yb;De.ConflictError=e0;De.RateLimitError=n0;De.BadRequestError=Kb;De.AuthenticationError=Xb;De.InternalServerError=r0;De.PermissionDeniedError=Qb;De.UnprocessableEntityError=t0;De.toFile=u0;De.fileFromPath=Gb;De.Completions=B0;De.Chat=dm;De.Embeddings=H0;De.Files=Em;De.FileObjectsPage=km;De.Images=V0;De.Audio=el;De.Moderations=q0;De.Models=Tm;De.ModelsPage=Am;De.FineTuning=rl;De.Beta=ns;De.Batches=fm;De.BatchesPage=hm;De.Uploads=Im;function dw(r,e=Nm){r=r.trim();const t=/```(json)?(.*)```/s.exec(r);return e(t?t[2]:r)}function Nm(r){if(typeof r>"u")return null;try{return JSON.parse(r)}catch{}let e="";const t=[];let n=!1,a=!1;for(let o of r){if(n)o==='"'&&!a?n=!1:o===`
`&&!a?o="\\n":o==="\\"?a=!a:a=!1;else if(o==='"')n=!0,a=!1;else if(o==="{")t.push("}");else if(o==="[")t.push("]");else if(o==="}"||o==="]")if(t&&t[t.length-1]===o)t.pop();else return null;e+=o}n&&(e+='"');for(let o=t.length-1;o>=0;o-=1)e+=t[o];try{return JSON.parse(e)}catch{return null}}var nh,fw;function dP(){return fw||(fw=1,nh=function(r,e){if(typeof r!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,r.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}),nh}var fP=dP();const hP=Ya(fP);var Mu={exports:{}},hw;function pP(){if(hw)return Mu.exports;hw=1;const r=/[\p{Lu}]/u,e=/[\p{Ll}]/u,t=/^[\p{Lu}](?![\p{Lu}])/gu,n=/([\p{Alpha}\p{N}_]|$)/u,a=/[_.\- ]+/,o=new RegExp("^"+a.source),l=new RegExp(a.source+n.source,"gu"),c=new RegExp("\\d+"+n.source,"gu"),d=(g,w,_)=>{let S=!1,b=!1,k=!1;for(let E=0;E<g.length;E++){const P=g[E];S&&r.test(P)?(g=g.slice(0,E)+"-"+g.slice(E),S=!1,k=b,b=!0,E++):b&&k&&e.test(P)?(g=g.slice(0,E-1)+"-"+g.slice(E-1),k=b,b=!1,S=!0):(S=w(P)===P&&_(P)!==P,k=b,b=_(P)===P&&w(P)!==P)}return g},f=(g,w)=>(t.lastIndex=0,g.replace(t,_=>w(_))),p=(g,w)=>(l.lastIndex=0,c.lastIndex=0,g.replace(l,(_,S)=>w(S)).replace(c,_=>w(_))),y=(g,w)=>{if(!(typeof g=="string"||Array.isArray(g)))throw new TypeError("Expected the input to be `string | string[]`");if(w={pascalCase:!1,preserveConsecutiveUppercase:!1,...w},Array.isArray(g)?g=g.map(k=>k.trim()).filter(k=>k.length).join("-"):g=g.trim(),g.length===0)return"";const _=w.locale===!1?k=>k.toLowerCase():k=>k.toLocaleLowerCase(w.locale),S=w.locale===!1?k=>k.toUpperCase():k=>k.toLocaleUpperCase(w.locale);return g.length===1?w.pascalCase?S(g):_(g):(g!==_(g)&&(g=d(g,_,S)),g=g.replace(o,""),w.preserveConsecutiveUppercase?g=f(g,_):g=_(g),w.pascalCase&&(g=S(g.charAt(0))+g.slice(1)),p(g,S))};return Mu.exports=y,Mu.exports.default=y,Mu.exports}pP();function mP(r,e){return(e==null?void 0:e[r])||hP(r)}function gP(r,e,t){const n={};for(const a in r)Object.hasOwn(r,a)&&(n[e(a,t)]=r[a]);return n}function pw(r){return Array.isArray(r)?[...r]:{...r}}function yP(r,e){const t=pw(r);for(const[n,a]of Object.entries(e)){const[o,...l]=n.split(".").reverse();let c=t;for(const d of l.reverse()){if(c[d]===void 0)break;c[d]=pw(c[d]),c=c[d]}c[o]!==void 0&&(c[o]={lc:1,type:"secret",id:[a]})}return t}function G0(r){const e=Object.getPrototypeOf(r);return typeof r.lc_name=="function"&&(typeof e.lc_name!="function"||r.lc_name()!==e.lc_name())?r.lc_name():r.name}class Ja{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,G0(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof Ja||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},n=Object.keys(this.lc_kwargs).reduce((a,o)=>(a[o]=o in this?this[o]:this.lc_kwargs[o],a),{});for(let a=Object.getPrototypeOf(this);a;a=Object.getPrototypeOf(a))Object.assign(e,Reflect.get(a,"lc_aliases",this)),Object.assign(t,Reflect.get(a,"lc_secrets",this)),Object.assign(n,Reflect.get(a,"lc_attributes",this));return Object.keys(t).forEach(a=>{let o=this,l=n;const[c,...d]=a.split(".").reverse();for(const f of d.reverse()){if(!(f in o)||o[f]===void 0)return;(!(f in l)||l[f]===void 0)&&(typeof o[f]=="object"&&o[f]!=null?l[f]={}:Array.isArray(o[f])&&(l[f]=[])),o=o[f],l=l[f]}c in o&&o[c]!==void 0&&(l[c]=l[c]||o[c])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:gP(Object.keys(t).length?yP(n,t):n,mP,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}function di(r,e){return typeof r=="string"?typeof e=="string"?r+e:[{type:"text",text:r},...e]:Array.isArray(e)?Bc(r,e)??[...r,...e]:[...r,{type:"text",text:e}]}function vP(r,e){return r==="error"||e==="error"?"error":"success"}function wP(r,e){function t(n,a){if(typeof n!="object"||n===null||n===void 0)return n;if(a>=e)return Array.isArray(n)?"[Array]":"[Object]";if(Array.isArray(n))return n.map(l=>t(l,a+1));const o={};for(const l of Object.keys(n))o[l]=t(n[l],a+1);return o}return JSON.stringify(t(r,0),null,2)}class fi extends Ja{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:""}getType(){return this._getType()}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const t=wP(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${t}`}}function Bt(r,e){const t={...r};for(const[n,a]of Object.entries(e))if(t[n]==null)t[n]=a;else{if(a==null)continue;if(typeof t[n]!=typeof a||Array.isArray(t[n])!==Array.isArray(a))throw new Error(`field[${n}] already exists in the message chunk, but with a different type.`);if(typeof t[n]=="string"){if(n==="type")continue;t[n]+=a}else if(typeof t[n]=="object"&&!Array.isArray(t[n]))t[n]=Bt(t[n],a);else if(Array.isArray(t[n]))t[n]=Bc(t[n],a);else{if(t[n]===a)continue;console.warn(`field[${n}] already exists in this message chunk and value has unsupported type.`)}}return t}function Bc(r,e){if(!(r===void 0&&e===void 0)){if(r===void 0||e===void 0)return r||e;{const t=[...r];for(const n of e)if(typeof n=="object"&&"index"in n&&typeof n.index=="number"){const a=t.findIndex(o=>o.index===n.index);a!==-1?t[a]=Bt(t[a],n):t.push(n)}else{if(typeof n=="object"&&"text"in n&&n.text==="")continue;t.push(n)}return t}}}function _P(r,e){if(!r&&!e)throw new Error("Cannot merge two undefined objects.");if(!r||!e)return r||e;if(typeof r!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof r}
Right ${typeof e}`);if(typeof r=="string"&&typeof e=="string")return r+e;if(Array.isArray(r)&&Array.isArray(e))return Bc(r,e);if(typeof r=="object"&&typeof e=="object")return Bt(r,e);if(r===e)return r;throw new Error(`Can not merge objects of different types.
Left ${r}
Right ${e}`)}class hi extends fi{}function bP(r){return typeof r.role=="string"}function $m(r){return typeof(r==null?void 0:r._getType)=="function"}function xP(r){return $m(r)&&typeof r.concat=="function"}class SP extends fi{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,t,n){typeof e=="string"&&(e={content:e,name:n,tool_call_id:t}),super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}class jm extends hi{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new jm({content:di(this.content,e.content),additional_kwargs:Bt(this.additional_kwargs,e.additional_kwargs),response_metadata:Bt(this.response_metadata,e.response_metadata),artifact:_P(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:vP(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function EP(r){const e=[],t=[];for(const n of r)if(n.function){const a=n.function.name;try{const o=JSON.parse(n.function.arguments),l={name:a||"",args:o||{},id:n.id};e.push(l)}catch{t.push({name:a,args:n.function.arguments,id:n.id,error:"Malformed args."})}}else continue;return[e,t]}class No extends fi{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){var a;let n;if(typeof e=="string")n={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{n=e;const o=(a=n.additional_kwargs)==null?void 0:a.tool_calls,l=n.tool_calls;o!=null&&o.length>0&&(l===void 0||l.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(o!=null&&l===void 0){const[c,d]=EP(o);n.tool_calls=c??[],n.invalid_tool_calls=d??[]}else n.tool_calls=n.tool_calls??[],n.invalid_tool_calls=n.invalid_tool_calls??[]}catch{n.tool_calls=[],n.invalid_tool_calls=[]}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof n!="string"&&(this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=n.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function Lm(r){return r._getType()==="ai"}function mw(r){return r._getType()==="ai"}class rs extends hi{constructor(e){let t;if(typeof e=="string")t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const n=[],a=[];for(const o of e.tool_call_chunks){let l={};try{if(l=Nm(o.args||"{}"),l===null||typeof l!="object"||Array.isArray(l))throw new Error("Malformed tool call chunk args.");n.push({name:o.name??"",args:l,id:o.id,type:"tool_call"})}catch{a.push({name:o.name,args:o.args,id:o.id,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:n,invalid_tool_calls:a,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){var n,a,o,l,c,d,f,p,y,g,w,_,S,b,k,E,P,N,j,D,z,q,K,oe,he,me,Ue,Y,G,ne,Q,B,F,V,O,$,J,re,ie,xe;const t={content:di(this.content,e.content),additional_kwargs:Bt(this.additional_kwargs,e.additional_kwargs),response_metadata:Bt(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const ve=Bc(this.tool_call_chunks,e.tool_call_chunks);ve!==void 0&&ve.length>0&&(t.tool_call_chunks=ve)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const ve={...(((a=(n=this.usage_metadata)==null?void 0:n.input_token_details)==null?void 0:a.audio)!==void 0||((l=(o=e.usage_metadata)==null?void 0:o.input_token_details)==null?void 0:l.audio)!==void 0)&&{audio:(((d=(c=this.usage_metadata)==null?void 0:c.input_token_details)==null?void 0:d.audio)??0)+(((p=(f=e.usage_metadata)==null?void 0:f.input_token_details)==null?void 0:p.audio)??0)},...(((g=(y=this.usage_metadata)==null?void 0:y.input_token_details)==null?void 0:g.cache_read)!==void 0||((_=(w=e.usage_metadata)==null?void 0:w.input_token_details)==null?void 0:_.cache_read)!==void 0)&&{cache_read:(((b=(S=this.usage_metadata)==null?void 0:S.input_token_details)==null?void 0:b.cache_read)??0)+(((E=(k=e.usage_metadata)==null?void 0:k.input_token_details)==null?void 0:E.cache_read)??0)},...(((N=(P=this.usage_metadata)==null?void 0:P.input_token_details)==null?void 0:N.cache_creation)!==void 0||((D=(j=e.usage_metadata)==null?void 0:j.input_token_details)==null?void 0:D.cache_creation)!==void 0)&&{cache_creation:(((q=(z=this.usage_metadata)==null?void 0:z.input_token_details)==null?void 0:q.cache_creation)??0)+(((oe=(K=e.usage_metadata)==null?void 0:K.input_token_details)==null?void 0:oe.cache_creation)??0)}},Ie={...(((me=(he=this.usage_metadata)==null?void 0:he.output_token_details)==null?void 0:me.audio)!==void 0||((Y=(Ue=e.usage_metadata)==null?void 0:Ue.output_token_details)==null?void 0:Y.audio)!==void 0)&&{audio:(((ne=(G=this.usage_metadata)==null?void 0:G.output_token_details)==null?void 0:ne.audio)??0)+(((B=(Q=e.usage_metadata)==null?void 0:Q.output_token_details)==null?void 0:B.audio)??0)},...(((V=(F=this.usage_metadata)==null?void 0:F.output_token_details)==null?void 0:V.reasoning)!==void 0||(($=(O=e.usage_metadata)==null?void 0:O.output_token_details)==null?void 0:$.reasoning)!==void 0)&&{reasoning:(((re=(J=this.usage_metadata)==null?void 0:J.output_token_details)==null?void 0:re.reasoning)??0)+(((xe=(ie=e.usage_metadata)==null?void 0:ie.output_token_details)==null?void 0:xe.reasoning)??0)}},Le=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},nt=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},yn={input_tokens:Le.input_tokens+nt.input_tokens,output_tokens:Le.output_tokens+nt.output_tokens,total_tokens:Le.total_tokens+nt.total_tokens,...Object.keys(ve).length>0&&{input_token_details:ve},...Object.keys(Ie).length>0&&{output_token_details:Ie}};t.usage_metadata=yn}return new rs(t)}}class al extends fi{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return al}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class Hc extends hi{static lc_name(){return"ChatMessageChunk"}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new Hc({content:di(this.content,e.content),additional_kwargs:Bt(this.additional_kwargs,e.additional_kwargs),response_metadata:Bt(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class Vc extends hi{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new Vc({content:di(this.content,e.content),additional_kwargs:Bt(this.additional_kwargs,e.additional_kwargs),response_metadata:Bt(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class sl extends fi{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class qc extends hi{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new qc({content:di(this.content,e.content),additional_kwargs:Bt(this.additional_kwargs,e.additional_kwargs),response_metadata:Bt(this.response_metadata,e.response_metadata),id:this.id??e.id})}}class J0 extends fi{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class Wc extends hi{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new Wc({content:di(this.content,e.content),additional_kwargs:Bt(this.additional_kwargs,e.additional_kwargs),response_metadata:Bt(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function K0(r,e){return r.lc_error_code=e,r.message=`${r.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,r}function X0(r){return!!(r&&typeof r=="object"&&"type"in r&&r.type==="tool_call")}class kP extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}function CP(r){return X0(r)?r:typeof r.id=="string"&&r.type==="function"&&typeof r.function=="object"&&r.function!==null&&"arguments"in r.function&&typeof r.function.arguments=="string"&&"name"in r.function&&typeof r.function.name=="string"?{id:r.id,args:JSON.parse(r.function.arguments),name:r.function.name,type:"tool_call"}:r}function PP(r){return typeof r=="object"&&r!=null&&r.lc===1&&Array.isArray(r.id)&&r.kwargs!=null&&typeof r.kwargs=="object"}function rh(r){let e,t;if(PP(r)){const n=r.id.at(-1);n==="HumanMessage"||n==="HumanMessageChunk"?e="user":n==="AIMessage"||n==="AIMessageChunk"?e="assistant":n==="SystemMessage"||n==="SystemMessageChunk"?e="system":e="unknown",t=r.kwargs}else{const{type:n,...a}=r;e=n,t=a}if(e==="human"||e==="user")return new sl(t);if(e==="ai"||e==="assistant"){const{tool_calls:n,...a}=t;if(!Array.isArray(n))return new No(t);const o=n.map(CP);return new No({...a,tool_calls:o})}else{if(e==="system")return new J0(t);if(e==="tool"&&"tool_call_id"in t)return new SP({...t,content:t.content,tool_call_id:t.tool_call_id,name:t.name});throw K0(new Error(`Unable to coerce message from array: only human, AI, system, or tool message coercion is currently supported.

Received: ${JSON.stringify(r,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function _o(r){if(typeof r=="string")return new sl(r);if($m(r))return r;if(Array.isArray(r)){const[e,t]=r;return rh({type:e,content:t})}else if(bP(r)){const{role:e,...t}=r;return rh({...t,type:e})}else return rh(r)}function Q0(r,e="Human",t="AI"){const n=[];for(const a of r){let o;if(a._getType()==="human")o=e;else if(a._getType()==="ai")o=t;else if(a._getType()==="system")o="System";else if(a._getType()==="function")o="Function";else if(a._getType()==="tool")o="Tool";else if(a._getType()==="generic")o=a.role;else throw new Error(`Got unsupported message type: ${a._getType()}`);const l=a.name?`${a.name}, `:"",c=typeof a.content=="string"?a.content:JSON.stringify(a.content,null,2);n.push(`${o}: ${l}${c}`)}return n.join(`
`)}function RP(r){var t;const e=r._getType();if(e==="human")return new qc({...r});if(e==="ai"){let n={...r};return"tool_calls"in n&&(n={...n,tool_call_chunks:(t=n.tool_calls)==null?void 0:t.map(a=>({...a,type:"tool_call_chunk",index:void 0,args:JSON.stringify(a.args)}))}),new rs({...n})}else{if(e==="system")return new Wc({...r});if(e==="function")return new Vc({...r});if(al.isInstance(r))return new Hc({...r});throw new Error("Unknown message type.")}}var Me;(function(r){r.assertEqual=a=>a;function e(a){}r.assertIs=e;function t(a){throw new Error}r.assertNever=t,r.arrayToEnum=a=>{const o={};for(const l of a)o[l]=l;return o},r.getValidEnumValues=a=>{const o=r.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),l={};for(const c of o)l[c]=a[c];return r.objectValues(l)},r.objectValues=a=>r.objectKeys(a).map(function(o){return a[o]}),r.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const o=[];for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&o.push(l);return o},r.find=(a,o)=>{for(const l of a)if(o(l))return l},r.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function n(a,o=" | "){return a.map(l=>typeof l=="string"?`'${l}'`:l).join(o)}r.joinValues=n,r.jsonStringifyReplacer=(a,o)=>typeof o=="bigint"?o.toString():o})(Me||(Me={}));var jp;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(jp||(jp={}));const ue=Me.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),fa=r=>{switch(typeof r){case"undefined":return ue.undefined;case"string":return ue.string;case"number":return isNaN(r)?ue.nan:ue.number;case"boolean":return ue.boolean;case"function":return ue.function;case"bigint":return ue.bigint;case"symbol":return ue.symbol;case"object":return Array.isArray(r)?ue.array:r===null?ue.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?ue.promise:typeof Map<"u"&&r instanceof Map?ue.map:typeof Set<"u"&&r instanceof Set?ue.set:typeof Date<"u"&&r instanceof Date?ue.date:ue.object;default:return ue.unknown}},ee=Me.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),OP=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class hn extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(o){return o.message},n={_errors:[]},a=o=>{for(const l of o.issues)if(l.code==="invalid_union")l.unionErrors.map(a);else if(l.code==="invalid_return_type")a(l.returnTypeError);else if(l.code==="invalid_arguments")a(l.argumentsError);else if(l.path.length===0)n._errors.push(t(l));else{let c=n,d=0;for(;d<l.path.length;){const f=l.path[d];d===l.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(t(l))):c[f]=c[f]||{_errors:[]},c=c[f],d++}}};return a(this),n}static assert(e){if(!(e instanceof hn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Me.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const a of this.issues)a.path.length>0?(t[a.path[0]]=t[a.path[0]]||[],t[a.path[0]].push(e(a))):n.push(e(a));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}hn.create=r=>new hn(r);const ei=(r,e)=>{let t;switch(r.code){case ee.invalid_type:r.received===ue.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case ee.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,Me.jsonStringifyReplacer)}`;break;case ee.unrecognized_keys:t=`Unrecognized key(s) in object: ${Me.joinValues(r.keys,", ")}`;break;case ee.invalid_union:t="Invalid input";break;case ee.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Me.joinValues(r.options)}`;break;case ee.invalid_enum_value:t=`Invalid enum value. Expected ${Me.joinValues(r.options)}, received '${r.received}'`;break;case ee.invalid_arguments:t="Invalid function arguments";break;case ee.invalid_return_type:t="Invalid function return type";break;case ee.invalid_date:t="Invalid date";break;case ee.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:Me.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case ee.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case ee.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case ee.custom:t="Invalid input";break;case ee.invalid_intersection_types:t="Intersection results could not be merged";break;case ee.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case ee.not_finite:t="Number must be finite";break;default:t=e.defaultError,Me.assertNever(r)}return{message:t}};let Y0=ei;function TP(r){Y0=r}function mc(){return Y0}const gc=r=>{const{data:e,path:t,errorMaps:n,issueData:a}=r,o=[...t,...a.path||[]],l={...a,path:o};if(a.message!==void 0)return{...a,path:o,message:a.message};let c="";const d=n.filter(f=>!!f).slice().reverse();for(const f of d)c=f(l,{data:e,defaultError:c}).message;return{...a,path:o,message:c}},AP=[];function se(r,e){const t=mc(),n=gc({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===ei?void 0:ei].filter(a=>!!a)});r.common.issues.push(n)}class Lt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const a of t){if(a.status==="aborted")return Ee;a.status==="dirty"&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const a of t){const o=await a.key,l=await a.value;n.push({key:o,value:l})}return Lt.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const a of t){const{key:o,value:l}=a;if(o.status==="aborted"||l.status==="aborted")return Ee;o.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),o.value!=="__proto__"&&(typeof l.value<"u"||a.alwaysSet)&&(n[o.value]=l.value)}return{status:e.value,value:n}}}const Ee=Object.freeze({status:"aborted"}),Bs=r=>({status:"dirty",value:r}),Ht=r=>({status:"valid",value:r}),Lp=r=>r.status==="aborted",Mp=r=>r.status==="dirty",$o=r=>r.status==="valid",jo=r=>typeof Promise<"u"&&r instanceof Promise;function yc(r,e,t,n){if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(r)}function ex(r,e,t,n,a){if(typeof e=="function"?r!==e||!a:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t}var ge;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ge||(ge={}));var bo,xo;class cr{constructor(e,t,n,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const gw=(r,e)=>{if($o(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new hn(r.common.issues);return this._error=t,this._error}}};function Ce(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:a}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(l,c)=>{var d,f;const{message:p}=r;return l.code==="invalid_enum_value"?{message:p??c.defaultError}:typeof c.data>"u"?{message:(d=p??n)!==null&&d!==void 0?d:c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:(f=p??t)!==null&&f!==void 0?f:c.defaultError}},description:a}}class Oe{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return fa(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:fa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Lt,ctx:{common:e.parent.common,data:e.data,parsedType:fa(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(jo(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const a={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fa(e)},o=this._parseSync({data:e,path:a.path,parent:a});return gw(a,o)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fa(e)},a=this._parse({data:e,path:n.path,parent:n}),o=await(jo(a)?a:Promise.resolve(a));return gw(n,o)}refine(e,t){const n=a=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(a):t;return this._refinement((a,o)=>{const l=e(a),c=()=>o.addIssue({code:ee.custom,...n(a)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,t){return this._refinement((n,a)=>e(n)?!0:(a.addIssue(typeof t=="function"?t(n,a):t),!1))}_refinement(e){return new Gn({schema:this,typeName:H.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ur.create(this,this._def)}nullable(){return wa.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return qn.create(this,this._def)}promise(){return ni.create(this,this._def)}or(e){return Fo.create([this,e],this._def)}and(e){return Uo.create(this,e,this._def)}transform(e){return new Gn({...Ce(this._def),schema:this,typeName:H.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new qo({...Ce(this._def),innerType:this,defaultValue:t,typeName:H.ZodDefault})}brand(){return new Mm({typeName:H.ZodBranded,type:this,...Ce(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Wo({...Ce(this._def),innerType:this,catchValue:t,typeName:H.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return il.create(this,e)}readonly(){return Zo.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const IP=/^c[^\s-]{8,}$/i,NP=/^[0-9a-z]+$/,$P=/^[0-9A-HJKMNP-TV-Z]{26}$/,jP=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,LP=/^[a-z0-9_-]{21}$/i,MP=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,DP=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,FP="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ah;const UP=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,zP=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,BP=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,tx="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",HP=new RegExp(`^${tx}$`);function nx(r){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`),e}function VP(r){return new RegExp(`^${nx(r)}$`)}function rx(r){let e=`${tx}T${nx(r)}`;const t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function qP(r,e){return!!((e==="v4"||!e)&&UP.test(r)||(e==="v6"||!e)&&zP.test(r))}class Vn extends Oe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ue.string){const o=this._getOrReturnCtx(e);return se(o,{code:ee.invalid_type,expected:ue.string,received:o.parsedType}),Ee}const n=new Lt;let a;for(const o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(a=this._getOrReturnCtx(e,a),se(a,{code:ee.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="max")e.data.length>o.value&&(a=this._getOrReturnCtx(e,a),se(a,{code:ee.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="length"){const l=e.data.length>o.value,c=e.data.length<o.value;(l||c)&&(a=this._getOrReturnCtx(e,a),l?se(a,{code:ee.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):c&&se(a,{code:ee.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),n.dirty())}else if(o.kind==="email")DP.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"email",code:ee.invalid_string,message:o.message}),n.dirty());else if(o.kind==="emoji")ah||(ah=new RegExp(FP,"u")),ah.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"emoji",code:ee.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")jP.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"uuid",code:ee.invalid_string,message:o.message}),n.dirty());else if(o.kind==="nanoid")LP.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"nanoid",code:ee.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")IP.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"cuid",code:ee.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid2")NP.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"cuid2",code:ee.invalid_string,message:o.message}),n.dirty());else if(o.kind==="ulid")$P.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"ulid",code:ee.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),se(a,{validation:"url",code:ee.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"regex",code:ee.invalid_string,message:o.message}),n.dirty())):o.kind==="trim"?e.data=e.data.trim():o.kind==="includes"?e.data.includes(o.value,o.position)||(a=this._getOrReturnCtx(e,a),se(a,{code:ee.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),n.dirty()):o.kind==="toLowerCase"?e.data=e.data.toLowerCase():o.kind==="toUpperCase"?e.data=e.data.toUpperCase():o.kind==="startsWith"?e.data.startsWith(o.value)||(a=this._getOrReturnCtx(e,a),se(a,{code:ee.invalid_string,validation:{startsWith:o.value},message:o.message}),n.dirty()):o.kind==="endsWith"?e.data.endsWith(o.value)||(a=this._getOrReturnCtx(e,a),se(a,{code:ee.invalid_string,validation:{endsWith:o.value},message:o.message}),n.dirty()):o.kind==="datetime"?rx(o).test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{code:ee.invalid_string,validation:"datetime",message:o.message}),n.dirty()):o.kind==="date"?HP.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{code:ee.invalid_string,validation:"date",message:o.message}),n.dirty()):o.kind==="time"?VP(o).test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{code:ee.invalid_string,validation:"time",message:o.message}),n.dirty()):o.kind==="duration"?MP.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"duration",code:ee.invalid_string,message:o.message}),n.dirty()):o.kind==="ip"?qP(e.data,o.version)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"ip",code:ee.invalid_string,message:o.message}),n.dirty()):o.kind==="base64"?BP.test(e.data)||(a=this._getOrReturnCtx(e,a),se(a,{validation:"base64",code:ee.invalid_string,message:o.message}),n.dirty()):Me.assertNever(o);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(a=>e.test(a),{validation:t,code:ee.invalid_string,...ge.errToObj(n)})}_addCheck(e){return new Vn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ge.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ge.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ge.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ge.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ge.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ge.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ge.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ge.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ge.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ge.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(n=e==null?void 0:e.local)!==null&&n!==void 0?n:!1,...ge.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ge.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ge.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...ge.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...ge.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...ge.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...ge.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...ge.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...ge.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...ge.errToObj(t)})}nonempty(e){return this.min(1,ge.errToObj(e))}trim(){return new Vn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Vn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Vn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Vn.create=r=>{var e;return new Vn({checks:[],typeName:H.ZodString,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...Ce(r)})};function WP(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,a=t>n?t:n,o=parseInt(r.toFixed(a).replace(".","")),l=parseInt(e.toFixed(a).replace(".",""));return o%l/Math.pow(10,a)}class ga extends Oe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ue.number){const o=this._getOrReturnCtx(e);return se(o,{code:ee.invalid_type,expected:ue.number,received:o.parsedType}),Ee}let n;const a=new Lt;for(const o of this._def.checks)o.kind==="int"?Me.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{code:ee.invalid_type,expected:"integer",received:"float",message:o.message}),a.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),se(n,{code:ee.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),se(n,{code:ee.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),a.dirty()):o.kind==="multipleOf"?WP(e.data,o.value)!==0&&(n=this._getOrReturnCtx(e,n),se(n,{code:ee.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):o.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),se(n,{code:ee.not_finite,message:o.message}),a.dirty()):Me.assertNever(o);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ge.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ge.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ge.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ge.toString(t))}setLimit(e,t,n,a){return new ga({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:ge.toString(a)}]})}_addCheck(e){return new ga({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ge.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ge.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ge.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ge.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ge.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ge.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:ge.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ge.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ge.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Me.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}ga.create=r=>new ga({checks:[],typeName:H.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...Ce(r)});class ya extends Oe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ue.bigint){const o=this._getOrReturnCtx(e);return se(o,{code:ee.invalid_type,expected:ue.bigint,received:o.parsedType}),Ee}let n;const a=new Lt;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),se(n,{code:ee.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),se(n,{code:ee.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="multipleOf"?e.data%o.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),se(n,{code:ee.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):Me.assertNever(o);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ge.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ge.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ge.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ge.toString(t))}setLimit(e,t,n,a){return new ya({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:ge.toString(a)}]})}_addCheck(e){return new ya({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ge.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ge.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ge.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ge.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ge.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ya.create=r=>{var e;return new ya({checks:[],typeName:H.ZodBigInt,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...Ce(r)})};class Lo extends Oe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ue.boolean){const n=this._getOrReturnCtx(e);return se(n,{code:ee.invalid_type,expected:ue.boolean,received:n.parsedType}),Ee}return Ht(e.data)}}Lo.create=r=>new Lo({typeName:H.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...Ce(r)});class Ka extends Oe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ue.date){const o=this._getOrReturnCtx(e);return se(o,{code:ee.invalid_type,expected:ue.date,received:o.parsedType}),Ee}if(isNaN(e.data.getTime())){const o=this._getOrReturnCtx(e);return se(o,{code:ee.invalid_date}),Ee}const n=new Lt;let a;for(const o of this._def.checks)o.kind==="min"?e.data.getTime()<o.value&&(a=this._getOrReturnCtx(e,a),se(a,{code:ee.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),n.dirty()):o.kind==="max"?e.data.getTime()>o.value&&(a=this._getOrReturnCtx(e,a),se(a,{code:ee.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),n.dirty()):Me.assertNever(o);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ka({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ge.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ge.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ka.create=r=>new Ka({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:H.ZodDate,...Ce(r)});class vc extends Oe{_parse(e){if(this._getType(e)!==ue.symbol){const n=this._getOrReturnCtx(e);return se(n,{code:ee.invalid_type,expected:ue.symbol,received:n.parsedType}),Ee}return Ht(e.data)}}vc.create=r=>new vc({typeName:H.ZodSymbol,...Ce(r)});class Mo extends Oe{_parse(e){if(this._getType(e)!==ue.undefined){const n=this._getOrReturnCtx(e);return se(n,{code:ee.invalid_type,expected:ue.undefined,received:n.parsedType}),Ee}return Ht(e.data)}}Mo.create=r=>new Mo({typeName:H.ZodUndefined,...Ce(r)});class Do extends Oe{_parse(e){if(this._getType(e)!==ue.null){const n=this._getOrReturnCtx(e);return se(n,{code:ee.invalid_type,expected:ue.null,received:n.parsedType}),Ee}return Ht(e.data)}}Do.create=r=>new Do({typeName:H.ZodNull,...Ce(r)});class ti extends Oe{constructor(){super(...arguments),this._any=!0}_parse(e){return Ht(e.data)}}ti.create=r=>new ti({typeName:H.ZodAny,...Ce(r)});class qa extends Oe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ht(e.data)}}qa.create=r=>new qa({typeName:H.ZodUnknown,...Ce(r)});class jr extends Oe{_parse(e){const t=this._getOrReturnCtx(e);return se(t,{code:ee.invalid_type,expected:ue.never,received:t.parsedType}),Ee}}jr.create=r=>new jr({typeName:H.ZodNever,...Ce(r)});class wc extends Oe{_parse(e){if(this._getType(e)!==ue.undefined){const n=this._getOrReturnCtx(e);return se(n,{code:ee.invalid_type,expected:ue.void,received:n.parsedType}),Ee}return Ht(e.data)}}wc.create=r=>new wc({typeName:H.ZodVoid,...Ce(r)});class qn extends Oe{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),a=this._def;if(t.parsedType!==ue.array)return se(t,{code:ee.invalid_type,expected:ue.array,received:t.parsedType}),Ee;if(a.exactLength!==null){const l=t.data.length>a.exactLength.value,c=t.data.length<a.exactLength.value;(l||c)&&(se(t,{code:l?ee.too_big:ee.too_small,minimum:c?a.exactLength.value:void 0,maximum:l?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&t.data.length<a.minLength.value&&(se(t,{code:ee.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&t.data.length>a.maxLength.value&&(se(t,{code:ee.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((l,c)=>a.type._parseAsync(new cr(t,l,t.path,c)))).then(l=>Lt.mergeArray(n,l));const o=[...t.data].map((l,c)=>a.type._parseSync(new cr(t,l,t.path,c)));return Lt.mergeArray(n,o)}get element(){return this._def.type}min(e,t){return new qn({...this._def,minLength:{value:e,message:ge.toString(t)}})}max(e,t){return new qn({...this._def,maxLength:{value:e,message:ge.toString(t)}})}length(e,t){return new qn({...this._def,exactLength:{value:e,message:ge.toString(t)}})}nonempty(e){return this.min(1,e)}}qn.create=(r,e)=>new qn({type:r,minLength:null,maxLength:null,exactLength:null,typeName:H.ZodArray,...Ce(e)});function Fs(r){if(r instanceof it){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=ur.create(Fs(n))}return new it({...r._def,shape:()=>e})}else return r instanceof qn?new qn({...r._def,type:Fs(r.element)}):r instanceof ur?ur.create(Fs(r.unwrap())):r instanceof wa?wa.create(Fs(r.unwrap())):r instanceof dr?dr.create(r.items.map(e=>Fs(e))):r}class it extends Oe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Me.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==ue.object){const f=this._getOrReturnCtx(e);return se(f,{code:ee.invalid_type,expected:ue.object,received:f.parsedType}),Ee}const{status:n,ctx:a}=this._processInputParams(e),{shape:o,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof jr&&this._def.unknownKeys==="strip"))for(const f in a.data)l.includes(f)||c.push(f);const d=[];for(const f of l){const p=o[f],y=a.data[f];d.push({key:{status:"valid",value:f},value:p._parse(new cr(a,y,a.path,f)),alwaysSet:f in a.data})}if(this._def.catchall instanceof jr){const f=this._def.unknownKeys;if(f==="passthrough")for(const p of c)d.push({key:{status:"valid",value:p},value:{status:"valid",value:a.data[p]}});else if(f==="strict")c.length>0&&(se(a,{code:ee.unrecognized_keys,keys:c}),n.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const p of c){const y=a.data[p];d.push({key:{status:"valid",value:p},value:f._parse(new cr(a,y,a.path,p)),alwaysSet:p in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const f=[];for(const p of d){const y=await p.key,g=await p.value;f.push({key:y,value:g,alwaysSet:p.alwaysSet})}return f}).then(f=>Lt.mergeObjectSync(n,f)):Lt.mergeObjectSync(n,d)}get shape(){return this._def.shape()}strict(e){return ge.errToObj,new it({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var a,o,l,c;const d=(l=(o=(a=this._def).errorMap)===null||o===void 0?void 0:o.call(a,t,n).message)!==null&&l!==void 0?l:n.defaultError;return t.code==="unrecognized_keys"?{message:(c=ge.errToObj(e).message)!==null&&c!==void 0?c:d}:{message:d}}}:{}})}strip(){return new it({...this._def,unknownKeys:"strip"})}passthrough(){return new it({...this._def,unknownKeys:"passthrough"})}extend(e){return new it({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new it({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:H.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new it({...this._def,catchall:e})}pick(e){const t={};return Me.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new it({...this._def,shape:()=>t})}omit(e){const t={};return Me.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new it({...this._def,shape:()=>t})}deepPartial(){return Fs(this)}partial(e){const t={};return Me.objectKeys(this.shape).forEach(n=>{const a=this.shape[n];e&&!e[n]?t[n]=a:t[n]=a.optional()}),new it({...this._def,shape:()=>t})}required(e){const t={};return Me.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let o=this.shape[n];for(;o instanceof ur;)o=o._def.innerType;t[n]=o}}),new it({...this._def,shape:()=>t})}keyof(){return ax(Me.objectKeys(this.shape))}}it.create=(r,e)=>new it({shape:()=>r,unknownKeys:"strip",catchall:jr.create(),typeName:H.ZodObject,...Ce(e)});it.strictCreate=(r,e)=>new it({shape:()=>r,unknownKeys:"strict",catchall:jr.create(),typeName:H.ZodObject,...Ce(e)});it.lazycreate=(r,e)=>new it({shape:r,unknownKeys:"strip",catchall:jr.create(),typeName:H.ZodObject,...Ce(e)});class Fo extends Oe{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function a(o){for(const c of o)if(c.result.status==="valid")return c.result;for(const c of o)if(c.result.status==="dirty")return t.common.issues.push(...c.ctx.common.issues),c.result;const l=o.map(c=>new hn(c.ctx.common.issues));return se(t,{code:ee.invalid_union,unionErrors:l}),Ee}if(t.common.async)return Promise.all(n.map(async o=>{const l={...t,common:{...t.common,issues:[]},parent:null};return{result:await o._parseAsync({data:t.data,path:t.path,parent:l}),ctx:l}})).then(a);{let o;const l=[];for(const d of n){const f={...t,common:{...t.common,issues:[]},parent:null},p=d._parseSync({data:t.data,path:t.path,parent:f});if(p.status==="valid")return p;p.status==="dirty"&&!o&&(o={result:p,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(o)return t.common.issues.push(...o.ctx.common.issues),o.result;const c=l.map(d=>new hn(d));return se(t,{code:ee.invalid_union,unionErrors:c}),Ee}}get options(){return this._def.options}}Fo.create=(r,e)=>new Fo({options:r,typeName:H.ZodUnion,...Ce(e)});const Rr=r=>r instanceof Bo?Rr(r.schema):r instanceof Gn?Rr(r.innerType()):r instanceof Ho?[r.value]:r instanceof va?r.options:r instanceof Vo?Me.objectValues(r.enum):r instanceof qo?Rr(r._def.innerType):r instanceof Mo?[void 0]:r instanceof Do?[null]:r instanceof ur?[void 0,...Rr(r.unwrap())]:r instanceof wa?[null,...Rr(r.unwrap())]:r instanceof Mm||r instanceof Zo?Rr(r.unwrap()):r instanceof Wo?Rr(r._def.innerType):[];class Zc extends Oe{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ue.object)return se(t,{code:ee.invalid_type,expected:ue.object,received:t.parsedType}),Ee;const n=this.discriminator,a=t.data[n],o=this.optionsMap.get(a);return o?t.common.async?o._parseAsync({data:t.data,path:t.path,parent:t}):o._parseSync({data:t.data,path:t.path,parent:t}):(se(t,{code:ee.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Ee)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const a=new Map;for(const o of t){const l=Rr(o.shape[e]);if(!l.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const c of l){if(a.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);a.set(c,o)}}return new Zc({typeName:H.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:a,...Ce(n)})}}function Dp(r,e){const t=fa(r),n=fa(e);if(r===e)return{valid:!0,data:r};if(t===ue.object&&n===ue.object){const a=Me.objectKeys(e),o=Me.objectKeys(r).filter(c=>a.indexOf(c)!==-1),l={...r,...e};for(const c of o){const d=Dp(r[c],e[c]);if(!d.valid)return{valid:!1};l[c]=d.data}return{valid:!0,data:l}}else if(t===ue.array&&n===ue.array){if(r.length!==e.length)return{valid:!1};const a=[];for(let o=0;o<r.length;o++){const l=r[o],c=e[o],d=Dp(l,c);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return t===ue.date&&n===ue.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class Uo extends Oe{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),a=(o,l)=>{if(Lp(o)||Lp(l))return Ee;const c=Dp(o.value,l.value);return c.valid?((Mp(o)||Mp(l))&&t.dirty(),{status:t.value,value:c.data}):(se(n,{code:ee.invalid_intersection_types}),Ee)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,l])=>a(o,l)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Uo.create=(r,e,t)=>new Uo({left:r,right:e,typeName:H.ZodIntersection,...Ce(t)});class dr extends Oe{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ue.array)return se(n,{code:ee.invalid_type,expected:ue.array,received:n.parsedType}),Ee;if(n.data.length<this._def.items.length)return se(n,{code:ee.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ee;!this._def.rest&&n.data.length>this._def.items.length&&(se(n,{code:ee.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const o=[...n.data].map((l,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new cr(n,l,n.path,c)):null}).filter(l=>!!l);return n.common.async?Promise.all(o).then(l=>Lt.mergeArray(t,l)):Lt.mergeArray(t,o)}get items(){return this._def.items}rest(e){return new dr({...this._def,rest:e})}}dr.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new dr({items:r,typeName:H.ZodTuple,rest:null,...Ce(e)})};class zo extends Oe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ue.object)return se(n,{code:ee.invalid_type,expected:ue.object,received:n.parsedType}),Ee;const a=[],o=this._def.keyType,l=this._def.valueType;for(const c in n.data)a.push({key:o._parse(new cr(n,c,n.path,c)),value:l._parse(new cr(n,n.data[c],n.path,c)),alwaysSet:c in n.data});return n.common.async?Lt.mergeObjectAsync(t,a):Lt.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof Oe?new zo({keyType:e,valueType:t,typeName:H.ZodRecord,...Ce(n)}):new zo({keyType:Vn.create(),valueType:e,typeName:H.ZodRecord,...Ce(t)})}}class _c extends Oe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ue.map)return se(n,{code:ee.invalid_type,expected:ue.map,received:n.parsedType}),Ee;const a=this._def.keyType,o=this._def.valueType,l=[...n.data.entries()].map(([c,d],f)=>({key:a._parse(new cr(n,c,n.path,[f,"key"])),value:o._parse(new cr(n,d,n.path,[f,"value"]))}));if(n.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of l){const f=await d.key,p=await d.value;if(f.status==="aborted"||p.status==="aborted")return Ee;(f.status==="dirty"||p.status==="dirty")&&t.dirty(),c.set(f.value,p.value)}return{status:t.value,value:c}})}else{const c=new Map;for(const d of l){const f=d.key,p=d.value;if(f.status==="aborted"||p.status==="aborted")return Ee;(f.status==="dirty"||p.status==="dirty")&&t.dirty(),c.set(f.value,p.value)}return{status:t.value,value:c}}}}_c.create=(r,e,t)=>new _c({valueType:e,keyType:r,typeName:H.ZodMap,...Ce(t)});class Xa extends Oe{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ue.set)return se(n,{code:ee.invalid_type,expected:ue.set,received:n.parsedType}),Ee;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(se(n,{code:ee.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(se(n,{code:ee.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());const o=this._def.valueType;function l(d){const f=new Set;for(const p of d){if(p.status==="aborted")return Ee;p.status==="dirty"&&t.dirty(),f.add(p.value)}return{status:t.value,value:f}}const c=[...n.data.values()].map((d,f)=>o._parse(new cr(n,d,n.path,f)));return n.common.async?Promise.all(c).then(d=>l(d)):l(c)}min(e,t){return new Xa({...this._def,minSize:{value:e,message:ge.toString(t)}})}max(e,t){return new Xa({...this._def,maxSize:{value:e,message:ge.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Xa.create=(r,e)=>new Xa({valueType:r,minSize:null,maxSize:null,typeName:H.ZodSet,...Ce(e)});class Ks extends Oe{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ue.function)return se(t,{code:ee.invalid_type,expected:ue.function,received:t.parsedType}),Ee;function n(c,d){return gc({data:c,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,mc(),ei].filter(f=>!!f),issueData:{code:ee.invalid_arguments,argumentsError:d}})}function a(c,d){return gc({data:c,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,mc(),ei].filter(f=>!!f),issueData:{code:ee.invalid_return_type,returnTypeError:d}})}const o={errorMap:t.common.contextualErrorMap},l=t.data;if(this._def.returns instanceof ni){const c=this;return Ht(async function(...d){const f=new hn([]),p=await c._def.args.parseAsync(d,o).catch(w=>{throw f.addIssue(n(d,w)),f}),y=await Reflect.apply(l,this,p);return await c._def.returns._def.type.parseAsync(y,o).catch(w=>{throw f.addIssue(a(y,w)),f})})}else{const c=this;return Ht(function(...d){const f=c._def.args.safeParse(d,o);if(!f.success)throw new hn([n(d,f.error)]);const p=Reflect.apply(l,this,f.data),y=c._def.returns.safeParse(p,o);if(!y.success)throw new hn([a(p,y.error)]);return y.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Ks({...this._def,args:dr.create(e).rest(qa.create())})}returns(e){return new Ks({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new Ks({args:e||dr.create([]).rest(qa.create()),returns:t||qa.create(),typeName:H.ZodFunction,...Ce(n)})}}class Bo extends Oe{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Bo.create=(r,e)=>new Bo({getter:r,typeName:H.ZodLazy,...Ce(e)});class Ho extends Oe{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return se(t,{received:t.data,code:ee.invalid_literal,expected:this._def.value}),Ee}return{status:"valid",value:e.data}}get value(){return this._def.value}}Ho.create=(r,e)=>new Ho({value:r,typeName:H.ZodLiteral,...Ce(e)});function ax(r,e){return new va({values:r,typeName:H.ZodEnum,...Ce(e)})}class va extends Oe{constructor(){super(...arguments),bo.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return se(t,{expected:Me.joinValues(n),received:t.parsedType,code:ee.invalid_type}),Ee}if(yc(this,bo)||ex(this,bo,new Set(this._def.values)),!yc(this,bo).has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return se(t,{received:t.data,code:ee.invalid_enum_value,options:n}),Ee}return Ht(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return va.create(e,{...this._def,...t})}exclude(e,t=this._def){return va.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}bo=new WeakMap;va.create=ax;class Vo extends Oe{constructor(){super(...arguments),xo.set(this,void 0)}_parse(e){const t=Me.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==ue.string&&n.parsedType!==ue.number){const a=Me.objectValues(t);return se(n,{expected:Me.joinValues(a),received:n.parsedType,code:ee.invalid_type}),Ee}if(yc(this,xo)||ex(this,xo,new Set(Me.getValidEnumValues(this._def.values))),!yc(this,xo).has(e.data)){const a=Me.objectValues(t);return se(n,{received:n.data,code:ee.invalid_enum_value,options:a}),Ee}return Ht(e.data)}get enum(){return this._def.values}}xo=new WeakMap;Vo.create=(r,e)=>new Vo({values:r,typeName:H.ZodNativeEnum,...Ce(e)});class ni extends Oe{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ue.promise&&t.common.async===!1)return se(t,{code:ee.invalid_type,expected:ue.promise,received:t.parsedType}),Ee;const n=t.parsedType===ue.promise?t.data:Promise.resolve(t.data);return Ht(n.then(a=>this._def.type.parseAsync(a,{path:t.path,errorMap:t.common.contextualErrorMap})))}}ni.create=(r,e)=>new ni({type:r,typeName:H.ZodPromise,...Ce(e)});class Gn extends Oe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===H.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),a=this._def.effect||null,o={addIssue:l=>{se(n,l),l.fatal?t.abort():t.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),a.type==="preprocess"){const l=a.transform(n.data,o);if(n.common.async)return Promise.resolve(l).then(async c=>{if(t.value==="aborted")return Ee;const d=await this._def.schema._parseAsync({data:c,path:n.path,parent:n});return d.status==="aborted"?Ee:d.status==="dirty"||t.value==="dirty"?Bs(d.value):d});{if(t.value==="aborted")return Ee;const c=this._def.schema._parseSync({data:l,path:n.path,parent:n});return c.status==="aborted"?Ee:c.status==="dirty"||t.value==="dirty"?Bs(c.value):c}}if(a.type==="refinement"){const l=c=>{const d=a.refinement(c,o);if(n.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(n.common.async===!1){const c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?Ee:(c.status==="dirty"&&t.dirty(),l(c.value),{status:t.value,value:c.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>c.status==="aborted"?Ee:(c.status==="dirty"&&t.dirty(),l(c.value).then(()=>({status:t.value,value:c.value}))))}if(a.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!$o(l))return l;const c=a.transform(l.value,o);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:c}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>$o(l)?Promise.resolve(a.transform(l.value,o)).then(c=>({status:t.value,value:c})):l);Me.assertNever(a)}}Gn.create=(r,e,t)=>new Gn({schema:r,typeName:H.ZodEffects,effect:e,...Ce(t)});Gn.createWithPreprocess=(r,e,t)=>new Gn({schema:e,effect:{type:"preprocess",transform:r},typeName:H.ZodEffects,...Ce(t)});class ur extends Oe{_parse(e){return this._getType(e)===ue.undefined?Ht(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ur.create=(r,e)=>new ur({innerType:r,typeName:H.ZodOptional,...Ce(e)});class wa extends Oe{_parse(e){return this._getType(e)===ue.null?Ht(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}wa.create=(r,e)=>new wa({innerType:r,typeName:H.ZodNullable,...Ce(e)});class qo extends Oe{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===ue.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}qo.create=(r,e)=>new qo({innerType:r,typeName:H.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ce(e)});class Wo extends Oe{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return jo(a)?a.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new hn(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new hn(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Wo.create=(r,e)=>new Wo({innerType:r,typeName:H.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ce(e)});class bc extends Oe{_parse(e){if(this._getType(e)!==ue.nan){const n=this._getOrReturnCtx(e);return se(n,{code:ee.invalid_type,expected:ue.nan,received:n.parsedType}),Ee}return{status:"valid",value:e.data}}}bc.create=r=>new bc({typeName:H.ZodNaN,...Ce(r)});const ZP=Symbol("zod_brand");class Mm extends Oe{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class il extends Oe{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Ee:o.status==="dirty"?(t.dirty(),Bs(o.value)):this._def.out._parseAsync({data:o.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Ee:a.status==="dirty"?(t.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(e,t){return new il({in:e,out:t,typeName:H.ZodPipeline})}}class Zo extends Oe{_parse(e){const t=this._def.innerType._parse(e),n=a=>($o(a)&&(a.value=Object.freeze(a.value)),a);return jo(t)?t.then(a=>n(a)):n(t)}unwrap(){return this._def.innerType}}Zo.create=(r,e)=>new Zo({innerType:r,typeName:H.ZodReadonly,...Ce(e)});function sx(r,e={},t){return r?ti.create().superRefine((n,a)=>{var o,l;if(!r(n)){const c=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,d=(l=(o=c.fatal)!==null&&o!==void 0?o:t)!==null&&l!==void 0?l:!0,f=typeof c=="string"?{message:c}:c;a.addIssue({code:"custom",...f,fatal:d})}}):ti.create()}const GP={object:it.lazycreate};var H;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(H||(H={}));const JP=(r,e={message:`Input not instance of ${r.name}`})=>sx(t=>t instanceof r,e),ix=Vn.create,ox=ga.create,KP=bc.create,XP=ya.create,lx=Lo.create,QP=Ka.create,YP=vc.create,eR=Mo.create,tR=Do.create,nR=ti.create,rR=qa.create,aR=jr.create,sR=wc.create,iR=qn.create,oR=it.create,lR=it.strictCreate,uR=Fo.create,cR=Zc.create,dR=Uo.create,fR=dr.create,hR=zo.create,pR=_c.create,mR=Xa.create,gR=Ks.create,yR=Bo.create,vR=Ho.create,wR=va.create,_R=Vo.create,bR=ni.create,yw=Gn.create,xR=ur.create,SR=wa.create,ER=Gn.createWithPreprocess,kR=il.create,CR=()=>ix().optional(),PR=()=>ox().optional(),RR=()=>lx().optional(),OR={string:r=>Vn.create({...r,coerce:!0}),number:r=>ga.create({...r,coerce:!0}),boolean:r=>Lo.create({...r,coerce:!0}),bigint:r=>ya.create({...r,coerce:!0}),date:r=>Ka.create({...r,coerce:!0})},TR=Ee;var Wa=Object.freeze({__proto__:null,defaultErrorMap:ei,setErrorMap:TP,getErrorMap:mc,makeIssue:gc,EMPTY_PATH:AP,addIssueToContext:se,ParseStatus:Lt,INVALID:Ee,DIRTY:Bs,OK:Ht,isAborted:Lp,isDirty:Mp,isValid:$o,isAsync:jo,get util(){return Me},get objectUtil(){return jp},ZodParsedType:ue,getParsedType:fa,ZodType:Oe,datetimeRegex:rx,ZodString:Vn,ZodNumber:ga,ZodBigInt:ya,ZodBoolean:Lo,ZodDate:Ka,ZodSymbol:vc,ZodUndefined:Mo,ZodNull:Do,ZodAny:ti,ZodUnknown:qa,ZodNever:jr,ZodVoid:wc,ZodArray:qn,ZodObject:it,ZodUnion:Fo,ZodDiscriminatedUnion:Zc,ZodIntersection:Uo,ZodTuple:dr,ZodRecord:zo,ZodMap:_c,ZodSet:Xa,ZodFunction:Ks,ZodLazy:Bo,ZodLiteral:Ho,ZodEnum:va,ZodNativeEnum:Vo,ZodPromise:ni,ZodEffects:Gn,ZodTransformer:Gn,ZodOptional:ur,ZodNullable:wa,ZodDefault:qo,ZodCatch:Wo,ZodNaN:bc,BRAND:ZP,ZodBranded:Mm,ZodPipeline:il,ZodReadonly:Zo,custom:sx,Schema:Oe,ZodSchema:Oe,late:GP,get ZodFirstPartyTypeKind(){return H},coerce:OR,any:nR,array:iR,bigint:XP,boolean:lx,date:QP,discriminatedUnion:cR,effect:yw,enum:wR,function:gR,instanceof:JP,intersection:dR,lazy:yR,literal:vR,map:pR,nan:KP,nativeEnum:_R,never:aR,null:tR,nullable:SR,number:ox,object:oR,oboolean:RR,onumber:PR,optional:xR,ostring:CR,pipeline:kR,preprocess:ER,promise:bR,record:hR,set:mR,strictObject:lR,string:ix,symbol:YP,transformer:yw,tuple:fR,undefined:eR,union:uR,unknown:rR,void:sR,NEVER:TR,ZodIssueCode:ee,quotelessJson:OP,ZodError:hn}),oo={exports:{}},sh={},ih,vw;function AR(){if(vw)return ih;vw=1;function r(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return ih=r,r.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},r.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},r.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var a=this;return this._timer=setTimeout(function(){a._attempts++,a._operationTimeoutCb&&(a._timeout=setTimeout(function(){a._operationTimeoutCb(a._attempts)},a._operationTimeout),a._options.unref&&a._timeout.unref()),a._fn(a._attempts)},n),this._options.unref&&this._timer.unref(),!0},r.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},r.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},r.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},r.prototype.start=r.prototype.try,r.prototype.errors=function(){return this._errors},r.prototype.attempts=function(){return this._attempts},r.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,n=0,a=0;a<this._errors.length;a++){var o=this._errors[a],l=o.message,c=(e[l]||0)+1;e[l]=c,c>=n&&(t=o,n=c)}return t},ih}var ww;function IR(){return ww||(ww=1,function(r){var e=AR();r.operation=function(t){var n=r.timeouts(t);return new e(n,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},r.timeouts=function(t){if(t instanceof Array)return[].concat(t);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var a in t)n[a]=t[a];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var o=[],l=0;l<n.retries;l++)o.push(this.createTimeout(l,n));return t&&t.forever&&!o.length&&o.push(this.createTimeout(l,n)),o.sort(function(c,d){return c-d}),o},r.createTimeout=function(t,n){var a=n.randomize?Math.random()+1:1,o=Math.round(a*Math.max(n.minTimeout,1)*Math.pow(n.factor,t));return o=Math.min(o,n.maxTimeout),o},r.wrap=function(t,n,a){if(n instanceof Array&&(a=n,n=null),!a){a=[];for(var o in t)typeof t[o]=="function"&&a.push(o)}for(var l=0;l<a.length;l++){var c=a[l],d=t[c];t[c]=(function(p){var y=r.operation(n),g=Array.prototype.slice.call(arguments,1),w=g.pop();g.push(function(_){y.retry(_)||(_&&(arguments[0]=y.mainError()),w.apply(this,arguments))}),y.attempt(function(){p.apply(t,g)})}).bind(t,d),t[c].options=n}}}(sh)),sh}var oh,_w;function NR(){return _w||(_w=1,oh=IR()),oh}var bw;function $R(){if(bw)return oo.exports;bw=1;const r=NR(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class t extends Error{constructor(c){super(),c instanceof Error?(this.originalError=c,{message:c}=c):(this.originalError=new Error(c),this.originalError.stack=this.stack),this.name="AbortError",this.message=c}}const n=(l,c,d)=>{const f=d.retries-(c-1);return l.attemptNumber=c,l.retriesLeft=f,l},a=l=>e.includes(l),o=(l,c)=>new Promise((d,f)=>{c={onFailedAttempt:()=>{},retries:10,...c};const p=r.operation(c);p.attempt(async y=>{try{d(await l(y))}catch(g){if(!(g instanceof Error)){f(new TypeError(`Non-error was thrown: "${g}". You should only throw errors.`));return}if(g instanceof t)p.stop(),f(g.originalError);else if(g instanceof TypeError&&!a(g.message))p.stop(),f(g);else{n(g,y,c);try{await c.onFailedAttempt(g)}catch(w){f(w);return}p.retry(g)||f(p.mainError())}}})});return oo.exports=o,oo.exports.default=o,oo.exports.AbortError=t,oo.exports}var jR=$R();const xc=Ya(jR),LR=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function ko(r){return typeof r=="string"&&LR.test(r)}var Pt=[];for(var lh=0;lh<256;++lh)Pt.push((lh+256).toString(16).slice(1));function MR(r,e=0){return(Pt[r[e+0]]+Pt[r[e+1]]+Pt[r[e+2]]+Pt[r[e+3]]+"-"+Pt[r[e+4]]+Pt[r[e+5]]+"-"+Pt[r[e+6]]+Pt[r[e+7]]+"-"+Pt[r[e+8]]+Pt[r[e+9]]+"-"+Pt[r[e+10]]+Pt[r[e+11]]+Pt[r[e+12]]+Pt[r[e+13]]+Pt[r[e+14]]+Pt[r[e+15]]).toLowerCase()}var Du,DR=new Uint8Array(16);function FR(){if(!Du&&(Du=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Du))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Du(DR)}var UR=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const xw={randomUUID:UR};function fn(r,e,t){if(xw.randomUUID&&!e&&!r)return xw.randomUUID();r=r||{};var n=r.random||(r.rng||FR)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,MR(n)}var Fu={},uh={exports:{}},Sw;function zR(){return Sw||(Sw=1,function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function a(d,f,p){this.fn=d,this.context=f,this.once=p||!1}function o(d,f,p,y,g){if(typeof p!="function")throw new TypeError("The listener must be a function");var w=new a(p,y||d,g),_=t?t+f:f;return d._events[_]?d._events[_].fn?d._events[_]=[d._events[_],w]:d._events[_].push(w):(d._events[_]=w,d._eventsCount++),d}function l(d,f){--d._eventsCount===0?d._events=new n:delete d._events[f]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var f=[],p,y;if(this._eventsCount===0)return f;for(y in p=this._events)e.call(p,y)&&f.push(t?y.slice(1):y);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(p)):f},c.prototype.listeners=function(f){var p=t?t+f:f,y=this._events[p];if(!y)return[];if(y.fn)return[y.fn];for(var g=0,w=y.length,_=new Array(w);g<w;g++)_[g]=y[g].fn;return _},c.prototype.listenerCount=function(f){var p=t?t+f:f,y=this._events[p];return y?y.fn?1:y.length:0},c.prototype.emit=function(f,p,y,g,w,_){var S=t?t+f:f;if(!this._events[S])return!1;var b=this._events[S],k=arguments.length,E,P;if(b.fn){switch(b.once&&this.removeListener(f,b.fn,void 0,!0),k){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,p),!0;case 3:return b.fn.call(b.context,p,y),!0;case 4:return b.fn.call(b.context,p,y,g),!0;case 5:return b.fn.call(b.context,p,y,g,w),!0;case 6:return b.fn.call(b.context,p,y,g,w,_),!0}for(P=1,E=new Array(k-1);P<k;P++)E[P-1]=arguments[P];b.fn.apply(b.context,E)}else{var N=b.length,j;for(P=0;P<N;P++)switch(b[P].once&&this.removeListener(f,b[P].fn,void 0,!0),k){case 1:b[P].fn.call(b[P].context);break;case 2:b[P].fn.call(b[P].context,p);break;case 3:b[P].fn.call(b[P].context,p,y);break;case 4:b[P].fn.call(b[P].context,p,y,g);break;default:if(!E)for(j=1,E=new Array(k-1);j<k;j++)E[j-1]=arguments[j];b[P].fn.apply(b[P].context,E)}}return!0},c.prototype.on=function(f,p,y){return o(this,f,p,y,!1)},c.prototype.once=function(f,p,y){return o(this,f,p,y,!0)},c.prototype.removeListener=function(f,p,y,g){var w=t?t+f:f;if(!this._events[w])return this;if(!p)return l(this,w),this;var _=this._events[w];if(_.fn)_.fn===p&&(!g||_.once)&&(!y||_.context===y)&&l(this,w);else{for(var S=0,b=[],k=_.length;S<k;S++)(_[S].fn!==p||g&&!_[S].once||y&&_[S].context!==y)&&b.push(_[S]);b.length?this._events[w]=b.length===1?b[0]:b:l(this,w)}return this},c.prototype.removeAllListeners=function(f){var p;return f?(p=t?t+f:f,this._events[p]&&l(this,p)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,r.exports=c}(uh)),uh.exports}var lo={exports:{}},ch,Ew;function BR(){return Ew||(Ew=1,ch=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(n=>{n(e())}).then(()=>t),t=>new Promise(n=>{n(e())}).then(()=>{throw t})))),ch}var kw;function HR(){if(kw)return lo.exports;kw=1;const r=BR();class e extends Error{constructor(a){super(a),this.name="TimeoutError"}}const t=(n,a,o)=>new Promise((l,c)=>{if(typeof a!="number"||a<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(a===1/0){l(n);return}const d=setTimeout(()=>{if(typeof o=="function"){try{l(o())}catch(y){c(y)}return}const f=typeof o=="string"?o:`Promise timed out after ${a} milliseconds`,p=o instanceof Error?o:new e(f);typeof n.cancel=="function"&&n.cancel(),c(p)},a);r(n.then(l,c),()=>{clearTimeout(d)})});return lo.exports=t,lo.exports.default=t,lo.exports.TimeoutError=e,lo.exports}var Uu={},zu={},Cw;function VR(){if(Cw)return zu;Cw=1,Object.defineProperty(zu,"__esModule",{value:!0});function r(e,t,n){let a=0,o=e.length;for(;o>0;){const l=o/2|0;let c=a+l;n(e[c],t)<=0?(a=++c,o-=l+1):o=l}return a}return zu.default=r,zu}var Pw;function qR(){if(Pw)return Uu;Pw=1,Object.defineProperty(Uu,"__esModule",{value:!0});const r=VR();class e{constructor(){this._queue=[]}enqueue(n,a){a=Object.assign({priority:0},a);const o={priority:a.priority,run:n};if(this.size&&this._queue[this.size-1].priority>=a.priority){this._queue.push(o);return}const l=r.default(this._queue,o,(c,d)=>d.priority-c.priority);this._queue.splice(l,0,o)}dequeue(){const n=this._queue.shift();return n==null?void 0:n.run}filter(n){return this._queue.filter(a=>a.priority===n.priority).map(a=>a.run)}get size(){return this._queue.length}}return Uu.default=e,Uu}var Rw;function WR(){if(Rw)return Fu;Rw=1,Object.defineProperty(Fu,"__esModule",{value:!0});const r=zR(),e=HR(),t=qR(),n=()=>{},a=new e.TimeoutError;class o extends r{constructor(c){var d,f,p,y;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=n,this._resolveIdle=n,c=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:t.default},c),!(typeof c.intervalCap=="number"&&c.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(f=(d=c.intervalCap)===null||d===void 0?void 0:d.toString())!==null&&f!==void 0?f:""}\` (${typeof c.intervalCap})`);if(c.interval===void 0||!(Number.isFinite(c.interval)&&c.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(y=(p=c.interval)===null||p===void 0?void 0:p.toString())!==null&&y!==void 0?y:""}\` (${typeof c.interval})`);this._carryoverConcurrencyCount=c.carryoverConcurrencyCount,this._isIntervalIgnored=c.intervalCap===1/0||c.interval===0,this._intervalCap=c.intervalCap,this._interval=c.interval,this._queue=new c.queueClass,this._queueClass=c.queueClass,this.concurrency=c.concurrency,this._timeout=c.timeout,this._throwOnTimeout=c.throwOnTimeout===!0,this._isPaused=c.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=n,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=n,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const c=Date.now();if(this._intervalId===void 0){const d=this._intervalEnd-c;if(d<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},d)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const c=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const d=this._queue.dequeue();return d?(this.emit("active"),d(),c&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(c){if(!(typeof c=="number"&&c>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${c}\` (${typeof c})`);this._concurrency=c,this._processQueue()}async add(c,d={}){return new Promise((f,p)=>{const y=async()=>{this._pendingCount++,this._intervalCount++;try{const g=this._timeout===void 0&&d.timeout===void 0?c():e.default(Promise.resolve(c()),d.timeout===void 0?this._timeout:d.timeout,()=>{(d.throwOnTimeout===void 0?this._throwOnTimeout:d.throwOnTimeout)&&p(a)});f(await g)}catch(g){p(g)}this._next()};this._queue.enqueue(y,d),this._tryToStartAnother(),this.emit("add")})}async addAll(c,d){return Promise.all(c.map(async f=>this.add(f,d)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(c=>{const d=this._resolveEmpty;this._resolveEmpty=()=>{d(),c()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(c=>{const d=this._resolveIdle;this._resolveIdle=()=>{d(),c()}})}get size(){return this._queue.size}sizeBy(c){return this._queue.filter(c).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(c){this._timeout=c}}return Fu.default=o,Fu}var ZR=WR();const $r=Ya(ZR),GR=(...r)=>fetch(...r),JR=Symbol.for("ls:fetch_implementation"),we=()=>globalThis[JR]??GR,KR=[400,401,403,404,405,406,407,408],XR=[409];let Ow=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,"default"in $r?this.queue=new $r.default({concurrency:this.maxConcurrency}):this.queue=new $r({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...t){const n=this.onFailedResponseHook;return this.queue.add(()=>xc(()=>e(...t).catch(a=>{throw a instanceof Error?a:new Error(a)}),{async onFailedAttempt(a){if(a.message.startsWith("Cancel")||a.message.startsWith("TimeoutError")||a.message.startsWith("AbortError")||(a==null?void 0:a.code)==="ECONNABORTED")throw a;const o=a==null?void 0:a.response,l=o==null?void 0:o.status;if(l){if(KR.includes(+l))throw a;if(XR.includes(+l))return;n&&await n(o)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...n){return e.signal?Promise.race([this.call(t,...n),new Promise((a,o)=>{var l;(l=e.signal)==null||l.addEventListener("abort",()=>{o(new Error("AbortError"))})})]):this.call(t,...n)}fetch(...e){return this.call(()=>we()(...e).then(t=>t.ok?t:Promise.reject(t)))}};function Tw(r){return typeof(r==null?void 0:r._getType)=="function"}function Aw(r){const e={type:r._getType(),data:{content:r.content}};return r!=null&&r.additional_kwargs&&Object.keys(r.additional_kwargs).length>0&&(e.data.additional_kwargs={...r.additional_kwargs}),e}function Ne(r,e){if(!ko(r)){const t=e!==void 0?`Invalid UUID for ${e}: ${r}`:`Invalid UUID: ${r}`;throw new Error(t)}return r}const Iw={};function ux(r){Iw[r]||(console.warn(r),Iw[r]=!0)}var Bu={exports:{}},dh,Nw;function Gc(){if(Nw)return dh;Nw=1;const r="2.0.0",e=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,n=16,a=e-6;return dh={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:a,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:r,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},dh}var fh,$w;function Jc(){if($w)return fh;$w=1;var r={};return fh=typeof process=="object"&&r&&r.NODE_DEBUG&&/\bsemver\b/i.test(r.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{},fh}var jw;function ol(){return jw||(jw=1,function(r,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:a}=Gc(),o=Jc();e=r.exports={};const l=e.re=[],c=e.safeRe=[],d=e.src=[],f=e.t={};let p=0;const y="[a-zA-Z0-9-]",g=[["\\s",1],["\\d",a],[y,n]],w=S=>{for(const[b,k]of g)S=S.split(`${b}*`).join(`${b}{0,${k}}`).split(`${b}+`).join(`${b}{1,${k}}`);return S},_=(S,b,k)=>{const E=w(b),P=p++;o(S,P,b),f[S]=P,d[P]=b,l[P]=new RegExp(b,k?"g":void 0),c[P]=new RegExp(E,k?"g":void 0)};_("NUMERICIDENTIFIER","0|[1-9]\\d*"),_("NUMERICIDENTIFIERLOOSE","\\d+"),_("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${y}*`),_("MAINVERSION",`(${d[f.NUMERICIDENTIFIER]})\\.(${d[f.NUMERICIDENTIFIER]})\\.(${d[f.NUMERICIDENTIFIER]})`),_("MAINVERSIONLOOSE",`(${d[f.NUMERICIDENTIFIERLOOSE]})\\.(${d[f.NUMERICIDENTIFIERLOOSE]})\\.(${d[f.NUMERICIDENTIFIERLOOSE]})`),_("PRERELEASEIDENTIFIER",`(?:${d[f.NUMERICIDENTIFIER]}|${d[f.NONNUMERICIDENTIFIER]})`),_("PRERELEASEIDENTIFIERLOOSE",`(?:${d[f.NUMERICIDENTIFIERLOOSE]}|${d[f.NONNUMERICIDENTIFIER]})`),_("PRERELEASE",`(?:-(${d[f.PRERELEASEIDENTIFIER]}(?:\\.${d[f.PRERELEASEIDENTIFIER]})*))`),_("PRERELEASELOOSE",`(?:-?(${d[f.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${d[f.PRERELEASEIDENTIFIERLOOSE]})*))`),_("BUILDIDENTIFIER",`${y}+`),_("BUILD",`(?:\\+(${d[f.BUILDIDENTIFIER]}(?:\\.${d[f.BUILDIDENTIFIER]})*))`),_("FULLPLAIN",`v?${d[f.MAINVERSION]}${d[f.PRERELEASE]}?${d[f.BUILD]}?`),_("FULL",`^${d[f.FULLPLAIN]}$`),_("LOOSEPLAIN",`[v=\\s]*${d[f.MAINVERSIONLOOSE]}${d[f.PRERELEASELOOSE]}?${d[f.BUILD]}?`),_("LOOSE",`^${d[f.LOOSEPLAIN]}$`),_("GTLT","((?:<|>)?=?)"),_("XRANGEIDENTIFIERLOOSE",`${d[f.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),_("XRANGEIDENTIFIER",`${d[f.NUMERICIDENTIFIER]}|x|X|\\*`),_("XRANGEPLAIN",`[v=\\s]*(${d[f.XRANGEIDENTIFIER]})(?:\\.(${d[f.XRANGEIDENTIFIER]})(?:\\.(${d[f.XRANGEIDENTIFIER]})(?:${d[f.PRERELEASE]})?${d[f.BUILD]}?)?)?`),_("XRANGEPLAINLOOSE",`[v=\\s]*(${d[f.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[f.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[f.XRANGEIDENTIFIERLOOSE]})(?:${d[f.PRERELEASELOOSE]})?${d[f.BUILD]}?)?)?`),_("XRANGE",`^${d[f.GTLT]}\\s*${d[f.XRANGEPLAIN]}$`),_("XRANGELOOSE",`^${d[f.GTLT]}\\s*${d[f.XRANGEPLAINLOOSE]}$`),_("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),_("COERCE",`${d[f.COERCEPLAIN]}(?:$|[^\\d])`),_("COERCEFULL",d[f.COERCEPLAIN]+`(?:${d[f.PRERELEASE]})?(?:${d[f.BUILD]})?(?:$|[^\\d])`),_("COERCERTL",d[f.COERCE],!0),_("COERCERTLFULL",d[f.COERCEFULL],!0),_("LONETILDE","(?:~>?)"),_("TILDETRIM",`(\\s*)${d[f.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",_("TILDE",`^${d[f.LONETILDE]}${d[f.XRANGEPLAIN]}$`),_("TILDELOOSE",`^${d[f.LONETILDE]}${d[f.XRANGEPLAINLOOSE]}$`),_("LONECARET","(?:\\^)"),_("CARETTRIM",`(\\s*)${d[f.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",_("CARET",`^${d[f.LONECARET]}${d[f.XRANGEPLAIN]}$`),_("CARETLOOSE",`^${d[f.LONECARET]}${d[f.XRANGEPLAINLOOSE]}$`),_("COMPARATORLOOSE",`^${d[f.GTLT]}\\s*(${d[f.LOOSEPLAIN]})$|^$`),_("COMPARATOR",`^${d[f.GTLT]}\\s*(${d[f.FULLPLAIN]})$|^$`),_("COMPARATORTRIM",`(\\s*)${d[f.GTLT]}\\s*(${d[f.LOOSEPLAIN]}|${d[f.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",_("HYPHENRANGE",`^\\s*(${d[f.XRANGEPLAIN]})\\s+-\\s+(${d[f.XRANGEPLAIN]})\\s*$`),_("HYPHENRANGELOOSE",`^\\s*(${d[f.XRANGEPLAINLOOSE]})\\s+-\\s+(${d[f.XRANGEPLAINLOOSE]})\\s*$`),_("STAR","(<|>)?=?\\s*\\*"),_("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),_("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Bu,Bu.exports)),Bu.exports}var hh,Lw;function Dm(){if(Lw)return hh;Lw=1;const r=Object.freeze({loose:!0}),e=Object.freeze({});return hh=n=>n?typeof n!="object"?r:n:e,hh}var ph,Mw;function cx(){if(Mw)return ph;Mw=1;const r=/^[0-9]+$/,e=(n,a)=>{const o=r.test(n),l=r.test(a);return o&&l&&(n=+n,a=+a),n===a?0:o&&!l?-1:l&&!o?1:n<a?-1:1};return ph={compareIdentifiers:e,rcompareIdentifiers:(n,a)=>e(a,n)},ph}var mh,Dw;function Vt(){if(Dw)return mh;Dw=1;const r=Jc(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:t}=Gc(),{safeRe:n,t:a}=ol(),o=Dm(),{compareIdentifiers:l}=cx();class c{constructor(f,p){if(p=o(p),f instanceof c){if(f.loose===!!p.loose&&f.includePrerelease===!!p.includePrerelease)return f;f=f.version}else if(typeof f!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof f}".`);if(f.length>e)throw new TypeError(`version is longer than ${e} characters`);r("SemVer",f,p),this.options=p,this.loose=!!p.loose,this.includePrerelease=!!p.includePrerelease;const y=f.trim().match(p.loose?n[a.LOOSE]:n[a.FULL]);if(!y)throw new TypeError(`Invalid Version: ${f}`);if(this.raw=f,this.major=+y[1],this.minor=+y[2],this.patch=+y[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");y[4]?this.prerelease=y[4].split(".").map(g=>{if(/^[0-9]+$/.test(g)){const w=+g;if(w>=0&&w<t)return w}return g}):this.prerelease=[],this.build=y[5]?y[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(f){if(r("SemVer.compare",this.version,this.options,f),!(f instanceof c)){if(typeof f=="string"&&f===this.version)return 0;f=new c(f,this.options)}return f.version===this.version?0:this.compareMain(f)||this.comparePre(f)}compareMain(f){return f instanceof c||(f=new c(f,this.options)),l(this.major,f.major)||l(this.minor,f.minor)||l(this.patch,f.patch)}comparePre(f){if(f instanceof c||(f=new c(f,this.options)),this.prerelease.length&&!f.prerelease.length)return-1;if(!this.prerelease.length&&f.prerelease.length)return 1;if(!this.prerelease.length&&!f.prerelease.length)return 0;let p=0;do{const y=this.prerelease[p],g=f.prerelease[p];if(r("prerelease compare",p,y,g),y===void 0&&g===void 0)return 0;if(g===void 0)return 1;if(y===void 0)return-1;if(y===g)continue;return l(y,g)}while(++p)}compareBuild(f){f instanceof c||(f=new c(f,this.options));let p=0;do{const y=this.build[p],g=f.build[p];if(r("build compare",p,y,g),y===void 0&&g===void 0)return 0;if(g===void 0)return 1;if(y===void 0)return-1;if(y===g)continue;return l(y,g)}while(++p)}inc(f,p,y){switch(f){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",p,y);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",p,y);break;case"prepatch":this.prerelease.length=0,this.inc("patch",p,y),this.inc("pre",p,y);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",p,y),this.inc("pre",p,y);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const g=Number(y)?1:0;if(!p&&y===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[g];else{let w=this.prerelease.length;for(;--w>=0;)typeof this.prerelease[w]=="number"&&(this.prerelease[w]++,w=-2);if(w===-1){if(p===this.prerelease.join(".")&&y===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(g)}}if(p){let w=[p,g];y===!1&&(w=[p]),l(this.prerelease[0],p)===0?isNaN(this.prerelease[1])&&(this.prerelease=w):this.prerelease=w}break}default:throw new Error(`invalid increment argument: ${f}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return mh=c,mh}var gh,Fw;function pi(){if(Fw)return gh;Fw=1;const r=Vt();return gh=(t,n,a=!1)=>{if(t instanceof r)return t;try{return new r(t,n)}catch(o){if(!a)return null;throw o}},gh}var yh,Uw;function QR(){if(Uw)return yh;Uw=1;const r=pi();return yh=(t,n)=>{const a=r(t,n);return a?a.version:null},yh}var vh,zw;function YR(){if(zw)return vh;zw=1;const r=pi();return vh=(t,n)=>{const a=r(t.trim().replace(/^[=v]+/,""),n);return a?a.version:null},vh}var wh,Bw;function eO(){if(Bw)return wh;Bw=1;const r=Vt();return wh=(t,n,a,o,l)=>{typeof a=="string"&&(l=o,o=a,a=void 0);try{return new r(t instanceof r?t.version:t,a).inc(n,o,l).version}catch{return null}},wh}var _h,Hw;function tO(){if(Hw)return _h;Hw=1;const r=pi();return _h=(t,n)=>{const a=r(t,null,!0),o=r(n,null,!0),l=a.compare(o);if(l===0)return null;const c=l>0,d=c?a:o,f=c?o:a,p=!!d.prerelease.length;if(!!f.prerelease.length&&!p)return!f.patch&&!f.minor?"major":d.patch?"patch":d.minor?"minor":"major";const g=p?"pre":"";return a.major!==o.major?g+"major":a.minor!==o.minor?g+"minor":a.patch!==o.patch?g+"patch":"prerelease"},_h}var bh,Vw;function nO(){if(Vw)return bh;Vw=1;const r=Vt();return bh=(t,n)=>new r(t,n).major,bh}var xh,qw;function rO(){if(qw)return xh;qw=1;const r=Vt();return xh=(t,n)=>new r(t,n).minor,xh}var Sh,Ww;function aO(){if(Ww)return Sh;Ww=1;const r=Vt();return Sh=(t,n)=>new r(t,n).patch,Sh}var Eh,Zw;function sO(){if(Zw)return Eh;Zw=1;const r=pi();return Eh=(t,n)=>{const a=r(t,n);return a&&a.prerelease.length?a.prerelease:null},Eh}var kh,Gw;function Xn(){if(Gw)return kh;Gw=1;const r=Vt();return kh=(t,n,a)=>new r(t,a).compare(new r(n,a)),kh}var Ch,Jw;function iO(){if(Jw)return Ch;Jw=1;const r=Xn();return Ch=(t,n,a)=>r(n,t,a),Ch}var Ph,Kw;function oO(){if(Kw)return Ph;Kw=1;const r=Xn();return Ph=(t,n)=>r(t,n,!0),Ph}var Rh,Xw;function Fm(){if(Xw)return Rh;Xw=1;const r=Vt();return Rh=(t,n,a)=>{const o=new r(t,a),l=new r(n,a);return o.compare(l)||o.compareBuild(l)},Rh}var Oh,Qw;function lO(){if(Qw)return Oh;Qw=1;const r=Fm();return Oh=(t,n)=>t.sort((a,o)=>r(a,o,n)),Oh}var Th,Yw;function uO(){if(Yw)return Th;Yw=1;const r=Fm();return Th=(t,n)=>t.sort((a,o)=>r(o,a,n)),Th}var Ah,e_;function Kc(){if(e_)return Ah;e_=1;const r=Xn();return Ah=(t,n,a)=>r(t,n,a)>0,Ah}var Ih,t_;function Um(){if(t_)return Ih;t_=1;const r=Xn();return Ih=(t,n,a)=>r(t,n,a)<0,Ih}var Nh,n_;function dx(){if(n_)return Nh;n_=1;const r=Xn();return Nh=(t,n,a)=>r(t,n,a)===0,Nh}var $h,r_;function fx(){if(r_)return $h;r_=1;const r=Xn();return $h=(t,n,a)=>r(t,n,a)!==0,$h}var jh,a_;function zm(){if(a_)return jh;a_=1;const r=Xn();return jh=(t,n,a)=>r(t,n,a)>=0,jh}var Lh,s_;function Bm(){if(s_)return Lh;s_=1;const r=Xn();return Lh=(t,n,a)=>r(t,n,a)<=0,Lh}var Mh,i_;function hx(){if(i_)return Mh;i_=1;const r=dx(),e=fx(),t=Kc(),n=zm(),a=Um(),o=Bm();return Mh=(c,d,f,p)=>{switch(d){case"===":return typeof c=="object"&&(c=c.version),typeof f=="object"&&(f=f.version),c===f;case"!==":return typeof c=="object"&&(c=c.version),typeof f=="object"&&(f=f.version),c!==f;case"":case"=":case"==":return r(c,f,p);case"!=":return e(c,f,p);case">":return t(c,f,p);case">=":return n(c,f,p);case"<":return a(c,f,p);case"<=":return o(c,f,p);default:throw new TypeError(`Invalid operator: ${d}`)}},Mh}var Dh,o_;function cO(){if(o_)return Dh;o_=1;const r=Vt(),e=pi(),{safeRe:t,t:n}=ol();return Dh=(o,l)=>{if(o instanceof r)return o;if(typeof o=="number"&&(o=String(o)),typeof o!="string")return null;l=l||{};let c=null;if(!l.rtl)c=o.match(l.includePrerelease?t[n.COERCEFULL]:t[n.COERCE]);else{const w=l.includePrerelease?t[n.COERCERTLFULL]:t[n.COERCERTL];let _;for(;(_=w.exec(o))&&(!c||c.index+c[0].length!==o.length);)(!c||_.index+_[0].length!==c.index+c[0].length)&&(c=_),w.lastIndex=_.index+_[1].length+_[2].length;w.lastIndex=-1}if(c===null)return null;const d=c[2],f=c[3]||"0",p=c[4]||"0",y=l.includePrerelease&&c[5]?`-${c[5]}`:"",g=l.includePrerelease&&c[6]?`+${c[6]}`:"";return e(`${d}.${f}.${p}${y}${g}`,l)},Dh}var Fh,l_;function dO(){if(l_)return Fh;l_=1;class r{constructor(){this.max=1e3,this.map=new Map}get(t){const n=this.map.get(t);if(n!==void 0)return this.map.delete(t),this.map.set(t,n),n}delete(t){return this.map.delete(t)}set(t,n){if(!this.delete(t)&&n!==void 0){if(this.map.size>=this.max){const o=this.map.keys().next().value;this.delete(o)}this.map.set(t,n)}return this}}return Fh=r,Fh}var Uh,u_;function Qn(){if(u_)return Uh;u_=1;const r=/\s+/g;class e{constructor(G,ne){if(ne=a(ne),G instanceof e)return G.loose===!!ne.loose&&G.includePrerelease===!!ne.includePrerelease?G:new e(G.raw,ne);if(G instanceof o)return this.raw=G.value,this.set=[[G]],this.formatted=void 0,this;if(this.options=ne,this.loose=!!ne.loose,this.includePrerelease=!!ne.includePrerelease,this.raw=G.trim().replace(r," "),this.set=this.raw.split("||").map(Q=>this.parseRange(Q.trim())).filter(Q=>Q.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const Q=this.set[0];if(this.set=this.set.filter(B=>!S(B[0])),this.set.length===0)this.set=[Q];else if(this.set.length>1){for(const B of this.set)if(B.length===1&&b(B[0])){this.set=[B];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let G=0;G<this.set.length;G++){G>0&&(this.formatted+="||");const ne=this.set[G];for(let Q=0;Q<ne.length;Q++)Q>0&&(this.formatted+=" "),this.formatted+=ne[Q].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(G){const Q=((this.options.includePrerelease&&w)|(this.options.loose&&_))+":"+G,B=n.get(Q);if(B)return B;const F=this.options.loose,V=F?d[f.HYPHENRANGELOOSE]:d[f.HYPHENRANGE];G=G.replace(V,me(this.options.includePrerelease)),l("hyphen replace",G),G=G.replace(d[f.COMPARATORTRIM],p),l("comparator trim",G),G=G.replace(d[f.TILDETRIM],y),l("tilde trim",G),G=G.replace(d[f.CARETTRIM],g),l("caret trim",G);let O=G.split(" ").map(ie=>E(ie,this.options)).join(" ").split(/\s+/).map(ie=>he(ie,this.options));F&&(O=O.filter(ie=>(l("loose invalid filter",ie,this.options),!!ie.match(d[f.COMPARATORLOOSE])))),l("range list",O);const $=new Map,J=O.map(ie=>new o(ie,this.options));for(const ie of J){if(S(ie))return[ie];$.set(ie.value,ie)}$.size>1&&$.has("")&&$.delete("");const re=[...$.values()];return n.set(Q,re),re}intersects(G,ne){if(!(G instanceof e))throw new TypeError("a Range is required");return this.set.some(Q=>k(Q,ne)&&G.set.some(B=>k(B,ne)&&Q.every(F=>B.every(V=>F.intersects(V,ne)))))}test(G){if(!G)return!1;if(typeof G=="string")try{G=new c(G,this.options)}catch{return!1}for(let ne=0;ne<this.set.length;ne++)if(Ue(this.set[ne],G,this.options))return!0;return!1}}Uh=e;const t=dO(),n=new t,a=Dm(),o=Xc(),l=Jc(),c=Vt(),{safeRe:d,t:f,comparatorTrimReplace:p,tildeTrimReplace:y,caretTrimReplace:g}=ol(),{FLAG_INCLUDE_PRERELEASE:w,FLAG_LOOSE:_}=Gc(),S=Y=>Y.value==="<0.0.0-0",b=Y=>Y.value==="",k=(Y,G)=>{let ne=!0;const Q=Y.slice();let B=Q.pop();for(;ne&&Q.length;)ne=Q.every(F=>B.intersects(F,G)),B=Q.pop();return ne},E=(Y,G)=>(l("comp",Y,G),Y=D(Y,G),l("caret",Y),Y=N(Y,G),l("tildes",Y),Y=q(Y,G),l("xrange",Y),Y=oe(Y,G),l("stars",Y),Y),P=Y=>!Y||Y.toLowerCase()==="x"||Y==="*",N=(Y,G)=>Y.trim().split(/\s+/).map(ne=>j(ne,G)).join(" "),j=(Y,G)=>{const ne=G.loose?d[f.TILDELOOSE]:d[f.TILDE];return Y.replace(ne,(Q,B,F,V,O)=>{l("tilde",Y,Q,B,F,V,O);let $;return P(B)?$="":P(F)?$=`>=${B}.0.0 <${+B+1}.0.0-0`:P(V)?$=`>=${B}.${F}.0 <${B}.${+F+1}.0-0`:O?(l("replaceTilde pr",O),$=`>=${B}.${F}.${V}-${O} <${B}.${+F+1}.0-0`):$=`>=${B}.${F}.${V} <${B}.${+F+1}.0-0`,l("tilde return",$),$})},D=(Y,G)=>Y.trim().split(/\s+/).map(ne=>z(ne,G)).join(" "),z=(Y,G)=>{l("caret",Y,G);const ne=G.loose?d[f.CARETLOOSE]:d[f.CARET],Q=G.includePrerelease?"-0":"";return Y.replace(ne,(B,F,V,O,$)=>{l("caret",Y,B,F,V,O,$);let J;return P(F)?J="":P(V)?J=`>=${F}.0.0${Q} <${+F+1}.0.0-0`:P(O)?F==="0"?J=`>=${F}.${V}.0${Q} <${F}.${+V+1}.0-0`:J=`>=${F}.${V}.0${Q} <${+F+1}.0.0-0`:$?(l("replaceCaret pr",$),F==="0"?V==="0"?J=`>=${F}.${V}.${O}-${$} <${F}.${V}.${+O+1}-0`:J=`>=${F}.${V}.${O}-${$} <${F}.${+V+1}.0-0`:J=`>=${F}.${V}.${O}-${$} <${+F+1}.0.0-0`):(l("no pr"),F==="0"?V==="0"?J=`>=${F}.${V}.${O}${Q} <${F}.${V}.${+O+1}-0`:J=`>=${F}.${V}.${O}${Q} <${F}.${+V+1}.0-0`:J=`>=${F}.${V}.${O} <${+F+1}.0.0-0`),l("caret return",J),J})},q=(Y,G)=>(l("replaceXRanges",Y,G),Y.split(/\s+/).map(ne=>K(ne,G)).join(" ")),K=(Y,G)=>{Y=Y.trim();const ne=G.loose?d[f.XRANGELOOSE]:d[f.XRANGE];return Y.replace(ne,(Q,B,F,V,O,$)=>{l("xRange",Y,Q,B,F,V,O,$);const J=P(F),re=J||P(V),ie=re||P(O),xe=ie;return B==="="&&xe&&(B=""),$=G.includePrerelease?"-0":"",J?B===">"||B==="<"?Q="<0.0.0-0":Q="*":B&&xe?(re&&(V=0),O=0,B===">"?(B=">=",re?(F=+F+1,V=0,O=0):(V=+V+1,O=0)):B==="<="&&(B="<",re?F=+F+1:V=+V+1),B==="<"&&($="-0"),Q=`${B+F}.${V}.${O}${$}`):re?Q=`>=${F}.0.0${$} <${+F+1}.0.0-0`:ie&&(Q=`>=${F}.${V}.0${$} <${F}.${+V+1}.0-0`),l("xRange return",Q),Q})},oe=(Y,G)=>(l("replaceStars",Y,G),Y.trim().replace(d[f.STAR],"")),he=(Y,G)=>(l("replaceGTE0",Y,G),Y.trim().replace(d[G.includePrerelease?f.GTE0PRE:f.GTE0],"")),me=Y=>(G,ne,Q,B,F,V,O,$,J,re,ie,xe)=>(P(Q)?ne="":P(B)?ne=`>=${Q}.0.0${Y?"-0":""}`:P(F)?ne=`>=${Q}.${B}.0${Y?"-0":""}`:V?ne=`>=${ne}`:ne=`>=${ne}${Y?"-0":""}`,P(J)?$="":P(re)?$=`<${+J+1}.0.0-0`:P(ie)?$=`<${J}.${+re+1}.0-0`:xe?$=`<=${J}.${re}.${ie}-${xe}`:Y?$=`<${J}.${re}.${+ie+1}-0`:$=`<=${$}`,`${ne} ${$}`.trim()),Ue=(Y,G,ne)=>{for(let Q=0;Q<Y.length;Q++)if(!Y[Q].test(G))return!1;if(G.prerelease.length&&!ne.includePrerelease){for(let Q=0;Q<Y.length;Q++)if(l(Y[Q].semver),Y[Q].semver!==o.ANY&&Y[Q].semver.prerelease.length>0){const B=Y[Q].semver;if(B.major===G.major&&B.minor===G.minor&&B.patch===G.patch)return!0}return!1}return!0};return Uh}var zh,c_;function Xc(){if(c_)return zh;c_=1;const r=Symbol("SemVer ANY");class e{static get ANY(){return r}constructor(p,y){if(y=t(y),p instanceof e){if(p.loose===!!y.loose)return p;p=p.value}p=p.trim().split(/\s+/).join(" "),l("comparator",p,y),this.options=y,this.loose=!!y.loose,this.parse(p),this.semver===r?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(p){const y=this.options.loose?n[a.COMPARATORLOOSE]:n[a.COMPARATOR],g=p.match(y);if(!g)throw new TypeError(`Invalid comparator: ${p}`);this.operator=g[1]!==void 0?g[1]:"",this.operator==="="&&(this.operator=""),g[2]?this.semver=new c(g[2],this.options.loose):this.semver=r}toString(){return this.value}test(p){if(l("Comparator.test",p,this.options.loose),this.semver===r||p===r)return!0;if(typeof p=="string")try{p=new c(p,this.options)}catch{return!1}return o(p,this.operator,this.semver,this.options)}intersects(p,y){if(!(p instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new d(p.value,y).test(this.value):p.operator===""?p.value===""?!0:new d(this.value,y).test(p.semver):(y=t(y),y.includePrerelease&&(this.value==="<0.0.0-0"||p.value==="<0.0.0-0")||!y.includePrerelease&&(this.value.startsWith("<0.0.0")||p.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&p.operator.startsWith(">")||this.operator.startsWith("<")&&p.operator.startsWith("<")||this.semver.version===p.semver.version&&this.operator.includes("=")&&p.operator.includes("=")||o(this.semver,"<",p.semver,y)&&this.operator.startsWith(">")&&p.operator.startsWith("<")||o(this.semver,">",p.semver,y)&&this.operator.startsWith("<")&&p.operator.startsWith(">")))}}zh=e;const t=Dm(),{safeRe:n,t:a}=ol(),o=hx(),l=Jc(),c=Vt(),d=Qn();return zh}var Bh,d_;function Qc(){if(d_)return Bh;d_=1;const r=Qn();return Bh=(t,n,a)=>{try{n=new r(n,a)}catch{return!1}return n.test(t)},Bh}var Hh,f_;function fO(){if(f_)return Hh;f_=1;const r=Qn();return Hh=(t,n)=>new r(t,n).set.map(a=>a.map(o=>o.value).join(" ").trim().split(" ")),Hh}var Vh,h_;function hO(){if(h_)return Vh;h_=1;const r=Vt(),e=Qn();return Vh=(n,a,o)=>{let l=null,c=null,d=null;try{d=new e(a,o)}catch{return null}return n.forEach(f=>{d.test(f)&&(!l||c.compare(f)===-1)&&(l=f,c=new r(l,o))}),l},Vh}var qh,p_;function pO(){if(p_)return qh;p_=1;const r=Vt(),e=Qn();return qh=(n,a,o)=>{let l=null,c=null,d=null;try{d=new e(a,o)}catch{return null}return n.forEach(f=>{d.test(f)&&(!l||c.compare(f)===1)&&(l=f,c=new r(l,o))}),l},qh}var Wh,m_;function mO(){if(m_)return Wh;m_=1;const r=Vt(),e=Qn(),t=Kc();return Wh=(a,o)=>{a=new e(a,o);let l=new r("0.0.0");if(a.test(l)||(l=new r("0.0.0-0"),a.test(l)))return l;l=null;for(let c=0;c<a.set.length;++c){const d=a.set[c];let f=null;d.forEach(p=>{const y=new r(p.semver.version);switch(p.operator){case">":y.prerelease.length===0?y.patch++:y.prerelease.push(0),y.raw=y.format();case"":case">=":(!f||t(y,f))&&(f=y);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${p.operator}`)}}),f&&(!l||t(l,f))&&(l=f)}return l&&a.test(l)?l:null},Wh}var Zh,g_;function gO(){if(g_)return Zh;g_=1;const r=Qn();return Zh=(t,n)=>{try{return new r(t,n).range||"*"}catch{return null}},Zh}var Gh,y_;function Hm(){if(y_)return Gh;y_=1;const r=Vt(),e=Xc(),{ANY:t}=e,n=Qn(),a=Qc(),o=Kc(),l=Um(),c=Bm(),d=zm();return Gh=(p,y,g,w)=>{p=new r(p,w),y=new n(y,w);let _,S,b,k,E;switch(g){case">":_=o,S=c,b=l,k=">",E=">=";break;case"<":_=l,S=d,b=o,k="<",E="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(p,y,w))return!1;for(let P=0;P<y.set.length;++P){const N=y.set[P];let j=null,D=null;if(N.forEach(z=>{z.semver===t&&(z=new e(">=0.0.0")),j=j||z,D=D||z,_(z.semver,j.semver,w)?j=z:b(z.semver,D.semver,w)&&(D=z)}),j.operator===k||j.operator===E||(!D.operator||D.operator===k)&&S(p,D.semver))return!1;if(D.operator===E&&b(p,D.semver))return!1}return!0},Gh}var Jh,v_;function yO(){if(v_)return Jh;v_=1;const r=Hm();return Jh=(t,n,a)=>r(t,n,">",a),Jh}var Kh,w_;function vO(){if(w_)return Kh;w_=1;const r=Hm();return Kh=(t,n,a)=>r(t,n,"<",a),Kh}var Xh,__;function wO(){if(__)return Xh;__=1;const r=Qn();return Xh=(t,n,a)=>(t=new r(t,a),n=new r(n,a),t.intersects(n,a)),Xh}var Qh,b_;function _O(){if(b_)return Qh;b_=1;const r=Qc(),e=Xn();return Qh=(t,n,a)=>{const o=[];let l=null,c=null;const d=t.sort((g,w)=>e(g,w,a));for(const g of d)r(g,n,a)?(c=g,l||(l=g)):(c&&o.push([l,c]),c=null,l=null);l&&o.push([l,null]);const f=[];for(const[g,w]of o)g===w?f.push(g):!w&&g===d[0]?f.push("*"):w?g===d[0]?f.push(`<=${w}`):f.push(`${g} - ${w}`):f.push(`>=${g}`);const p=f.join(" || "),y=typeof n.raw=="string"?n.raw:String(n);return p.length<y.length?p:n},Qh}var Yh,x_;function bO(){if(x_)return Yh;x_=1;const r=Qn(),e=Xc(),{ANY:t}=e,n=Qc(),a=Xn(),o=(y,g,w={})=>{if(y===g)return!0;y=new r(y,w),g=new r(g,w);let _=!1;e:for(const S of y.set){for(const b of g.set){const k=d(S,b,w);if(_=_||k!==null,k)continue e}if(_)return!1}return!0},l=[new e(">=0.0.0-0")],c=[new e(">=0.0.0")],d=(y,g,w)=>{if(y===g)return!0;if(y.length===1&&y[0].semver===t){if(g.length===1&&g[0].semver===t)return!0;w.includePrerelease?y=l:y=c}if(g.length===1&&g[0].semver===t){if(w.includePrerelease)return!0;g=c}const _=new Set;let S,b;for(const q of y)q.operator===">"||q.operator===">="?S=f(S,q,w):q.operator==="<"||q.operator==="<="?b=p(b,q,w):_.add(q.semver);if(_.size>1)return null;let k;if(S&&b){if(k=a(S.semver,b.semver,w),k>0)return null;if(k===0&&(S.operator!==">="||b.operator!=="<="))return null}for(const q of _){if(S&&!n(q,String(S),w)||b&&!n(q,String(b),w))return null;for(const K of g)if(!n(q,String(K),w))return!1;return!0}let E,P,N,j,D=b&&!w.includePrerelease&&b.semver.prerelease.length?b.semver:!1,z=S&&!w.includePrerelease&&S.semver.prerelease.length?S.semver:!1;D&&D.prerelease.length===1&&b.operator==="<"&&D.prerelease[0]===0&&(D=!1);for(const q of g){if(j=j||q.operator===">"||q.operator===">=",N=N||q.operator==="<"||q.operator==="<=",S){if(z&&q.semver.prerelease&&q.semver.prerelease.length&&q.semver.major===z.major&&q.semver.minor===z.minor&&q.semver.patch===z.patch&&(z=!1),q.operator===">"||q.operator===">="){if(E=f(S,q,w),E===q&&E!==S)return!1}else if(S.operator===">="&&!n(S.semver,String(q),w))return!1}if(b){if(D&&q.semver.prerelease&&q.semver.prerelease.length&&q.semver.major===D.major&&q.semver.minor===D.minor&&q.semver.patch===D.patch&&(D=!1),q.operator==="<"||q.operator==="<="){if(P=p(b,q,w),P===q&&P!==b)return!1}else if(b.operator==="<="&&!n(b.semver,String(q),w))return!1}if(!q.operator&&(b||S)&&k!==0)return!1}return!(S&&N&&!b&&k!==0||b&&j&&!S&&k!==0||z||D)},f=(y,g,w)=>{if(!y)return g;const _=a(y.semver,g.semver,w);return _>0?y:_<0||g.operator===">"&&y.operator===">="?g:y},p=(y,g,w)=>{if(!y)return g;const _=a(y.semver,g.semver,w);return _<0?y:_>0||g.operator==="<"&&y.operator==="<="?g:y};return Yh=o,Yh}var ep,S_;function xO(){if(S_)return ep;S_=1;const r=ol(),e=Gc(),t=Vt(),n=cx(),a=pi(),o=QR(),l=YR(),c=eO(),d=tO(),f=nO(),p=rO(),y=aO(),g=sO(),w=Xn(),_=iO(),S=oO(),b=Fm(),k=lO(),E=uO(),P=Kc(),N=Um(),j=dx(),D=fx(),z=zm(),q=Bm(),K=hx(),oe=cO(),he=Xc(),me=Qn(),Ue=Qc(),Y=fO(),G=hO(),ne=pO(),Q=mO(),B=gO(),F=Hm(),V=yO(),O=vO(),$=wO(),J=_O(),re=bO();return ep={parse:a,valid:o,clean:l,inc:c,diff:d,major:f,minor:p,patch:y,prerelease:g,compare:w,rcompare:_,compareLoose:S,compareBuild:b,sort:k,rsort:E,gt:P,lt:N,eq:j,neq:D,gte:z,lte:q,cmp:K,coerce:oe,Comparator:he,Range:me,satisfies:Ue,toComparators:Y,maxSatisfying:G,minSatisfying:ne,minVersion:Q,validRange:B,outside:F,gtr:V,ltr:O,intersects:$,simplifyRange:J,subset:re,SemVer:t,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:n.compareIdentifiers,rcompareIdentifiers:n.rcompareIdentifiers},ep}var E_=xO();function SO(r,e){const t=E_.parse(r),n=E_.parse(e);if(!t||!n)throw new Error("Invalid version format.");return t.compare(n)>=0}function ia(r){if(!r||r.split("/").length>2||r.startsWith("/")||r.endsWith("/")||r.split(":").length>2)throw new Error(`Invalid identifier format: ${r}`);const[e,t]=r.split(":"),n=t||"latest";if(e.includes("/")){const[a,o]=e.split("/",2);if(!a||!o)throw new Error(`Invalid identifier format: ${r}`);return[a,o,n]}else{if(!e)throw new Error(`Invalid identifier format: ${r}`);return["-",e,n]}}class EO extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function Ae(r,e,t){let n;if(r.ok){t&&(n=await r.text());return}n=await r.text();const a=`Failed to ${e}. Received status [${r.status}]: ${r.statusText}. Server response: ${n}`;throw r.status===409?new EO(a):new Error(a)}var k_="[...]",kO={result:"[Circular]"},Sc=[],Hs=[];function CO(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function Us(r,e,t,n){var l;try{return JSON.stringify(r,e,t)}catch(c){if(!((l=c.message)!=null&&l.includes("Converting circular structure to JSON")))return console.warn("[WARNING]: LangSmith received unserializable value."),"[Unserializable]";console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),typeof n>"u"&&(n=CO()),Fp(r,"",0,[],void 0,0,n);var a;try{Hs.length===0?a=JSON.stringify(r,e,t):a=JSON.stringify(r,PO(e),t)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Sc.length!==0;){var o=Sc.pop();o.length===4?Object.defineProperty(o[0],o[1],o[3]):o[0][o[1]]=o[2]}}return a}}function tp(r,e,t,n){var a=Object.getOwnPropertyDescriptor(n,t);a.get!==void 0?a.configurable?(Object.defineProperty(n,t,{value:r}),Sc.push([n,t,e,a])):Hs.push([e,t,r]):(n[t]=r,Sc.push([n,t,e]))}function Fp(r,e,t,n,a,o,l){o+=1;var c;if(typeof r=="object"&&r!==null){for(c=0;c<n.length;c++)if(n[c]===r){tp(kO,r,e,a);return}if(typeof l.depthLimit<"u"&&o>l.depthLimit){tp(k_,r,e,a);return}if(typeof l.edgesLimit<"u"&&t+1>l.edgesLimit){tp(k_,r,e,a);return}if(n.push(r),Array.isArray(r))for(c=0;c<r.length;c++)Fp(r[c],c,c,n,r,o,l);else{var d=Object.keys(r);for(c=0;c<d.length;c++){var f=d[c];Fp(r[f],f,c,n,r,o,l)}}n.pop()}}function PO(r){return r=typeof r<"u"?r:function(e,t){return t},function(e,t){if(Hs.length>0)for(var n=0;n<Hs.length;n++){var a=Hs[n];if(a[1]===e&&a[0]===t){t=a[2],Hs.splice(n,1);break}}return r.call(this,e,t)}}function C_(r){const e=gx(),t=UO(),n=r.extra??{},a=n.metadata;return r.extra={...n,runtime:{...e,...n==null?void 0:n.runtime},metadata:{...t,...t.revision_id||r.revision_id?{revision_id:r.revision_id??t.revision_id}:{},...a}},r}const RO=()=>{const r=Ba("TRACING_SAMPLING_RATE");if(r===void 0)return;const e=parseFloat(r);if(e<0||e>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${e}`);return e},OO=r=>{const t=r.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"};async function TO(r){const e=[];for await(const t of r)e.push(t);return e}function np(r){if(r!==void 0)return r.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const AO=async r=>{if((r==null?void 0:r.status)===429){const e=parseInt(r.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(t=>setTimeout(t,e)),!0}return!1};class IO{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t;const n=new Promise(o=>{t=o}),a=Us(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:t,itemPromise:n,size:a}),this.sizeBytes+=a,n}pop(e){var a;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const t=[];let n=0;for(;n+(((a=this.peek())==null?void 0:a.size)??0)<e&&this.items.length>0;){const o=this.items.shift();o&&(t.push(o),n+=o.size,this.sizeBytes-=o.size)}if(t.length===0&&this.items.length>0){const o=this.items.shift();t.push(o),n+=o.size,this.sizeBytes-=o.size}return[t.map(o=>({action:o.action,item:o.payload})),()=>t.forEach(o=>o.itemPromiseResolve())]}}const NO=20971520,$O=1e3;class Go{constructor(e={}){var n;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new IO}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:ha("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const t=Go.getDefaultClientConfig();if(this.tracingSampleRate=RO(),this.apiUrl=np(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=np(e.apiKey??t.apiKey),this.webUrl=np(e.webUrl??t.webUrl),(n=this.webUrl)!=null&&n.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new Ow(e.callerOptions??{}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.batchIngestCaller=new Ow({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:AO}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{}}static getDefaultClientConfig(){const e=Ba("API_KEY"),t=Ba("ENDPOINT")??"https://api.smith.langchain.com",n=Ba("HIDE_INPUTS")==="true",a=Ba("HIDE_OUTPUTS")==="true";return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:n,hideOutputs:a}}getHostUrl(){return this.webUrl?this.webUrl:OO(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${px}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const t={...e};return t.inputs!==void 0&&(t.inputs=this.processInputs(t.inputs)),t.outputs!==void 0&&(t.outputs=this.processOutputs(t.outputs)),t}async _getResponse(e,t){const n=(t==null?void 0:t.toString())??"",a=`${this.apiUrl}${e}?${n}`,o=await this.caller.call(we(),a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(o,`Failed to fetch ${e}`),o}async _get(e,t){return(await this._getResponse(e,t)).json()}async*_getPaginated(e,t=new URLSearchParams,n){let a=Number(t.get("offset"))||0;const o=Number(t.get("limit"))||100;for(;;){t.set("offset",String(a)),t.set("limit",String(o));const l=`${this.apiUrl}${e}?${t}`,c=await this.caller.call(we(),l,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(c,`Failed to fetch ${e}`);const d=n?n(await c.json()):await c.json();if(d.length===0||(yield d,d.length<o))break;a+=d.length}}async*_getCursorPaginatedList(e,t=null,n="POST",a="runs"){const o=t?{...t}:{};for(;;){const c=await(await this.caller.call(we(),`${this.apiUrl}${e}`,{method:n,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(o)})).json();if(!c||!c[a])break;yield c[a];const d=c.cursors;if(!d||!d.next)break;o.cursor=d.next}}_filterForSampling(e,t=!1){if(this.tracingSampleRate===void 0)return e;if(t){const n=[];for(const a of e)this.filteredPostUuids.has(a.id)?this.filteredPostUuids.delete(a.id):n.push(a);return n}else{const n=[];for(const a of e)a.id!==a.trace_id&&!this.filteredPostUuids.has(a.trace_id)||Math.random()<this.tracingSampleRate?n.push(a):this.filteredPostUuids.add(a.id);return n}}async _getBatchSizeLimitBytes(){var t;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((t=e.batch_ingest_config)==null?void 0:t.size_limit_bytes)??NO}drainAutoBatchQueue(e){for(;this.autoBatchQueue.items.length>0;){const[t,n]=this.autoBatchQueue.pop(e);if(!t.length){n();break}this._processBatch(t,n).catch(console.error)}}async _processBatch(e,t){var n;if(!e.length){t();return}try{const a={runCreates:e.filter(l=>l.action==="create").map(l=>l.item),runUpdates:e.filter(l=>l.action==="update").map(l=>l.item)},o=await this._ensureServerInfo();(n=o==null?void 0:o.batch_ingest_config)!=null&&n.use_multipart_endpoint?await this.multipartIngestRuns(a):await this.batchIngestRuns(a)}finally{t()}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=C_(e.item));const t=this.autoBatchQueue.push(e),n=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>n&&this.drainAutoBatchQueue(n),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(n)},this.autoBatchAggregationDelayMs)),t}async _getServerInfo(){const e=await we()(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout($O),...this.fetchOptions});return await Ae(e,"get server info"),e.json()}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch{console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to batch operations and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async createRun(e){if(!this._filterForSampling([e]).length)return;const t={...this.headers,"Content-Type":"application/json"},n=e.project_name;delete e.project_name;const a=this.prepareRunCreateOrUpdateInputs({session_name:n,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&a.trace_id!==void 0&&a.dotted_order!==void 0){this.processRunOperation({action:"create",item:a}).catch(console.error);return}const o=C_(a),l=await this.caller.call(we(),`${this.apiUrl}/runs`,{method:"POST",headers:t,body:Us(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(l,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;let n=(e==null?void 0:e.map(c=>this.prepareRunCreateOrUpdateInputs(c)))??[],a=(t==null?void 0:t.map(c=>this.prepareRunCreateOrUpdateInputs(c)))??[];if(n.length>0&&a.length>0){const c=n.reduce((f,p)=>(p.id&&(f[p.id]=p),f),{}),d=[];for(const f of a)f.id!==void 0&&c[f.id]?c[f.id]={...c[f.id],...f}:d.push(f);n=Object.values(c),a=d}const o={post:this._filterForSampling(n),patch:this._filterForSampling(a,!0)};if(!o.post.length&&!o.patch.length)return;const l={post:[],patch:[]};for(const c of["post","patch"]){const d=c,f=o[d].reverse();let p=f.pop();for(;p!==void 0;)l[d].push(p),p=f.pop()}(l.post.length>0||l.patch.length>0)&&await this._postBatchIngestRuns(Us(l))}async _postBatchIngestRuns(e){const t={...this.headers,"Content-Type":"application/json",Accept:"application/json"},n=await this.batchIngestCaller.call(we(),`${this.apiUrl}/runs/batch`,{method:"POST",headers:t,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(n,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;const n={};let a=[];for(const p of e??[]){const y=this.prepareRunCreateOrUpdateInputs(p);y.id!==void 0&&y.attachments!==void 0&&(n[y.id]=y.attachments),delete y.attachments,a.push(y)}let o=[];for(const p of t??[])o.push(this.prepareRunCreateOrUpdateInputs(p));if(a.find(p=>p.trace_id===void 0||p.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(o.find(p=>p.trace_id===void 0||p.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(a.length>0&&o.length>0){const p=a.reduce((g,w)=>(w.id&&(g[w.id]=w),g),{}),y=[];for(const g of o)g.id!==void 0&&p[g.id]?p[g.id]={...p[g.id],...g}:y.push(g);a=Object.values(p),o=y}if(a.length===0&&o.length===0)return;const d=[],f=[];for(const[p,y]of[["post",a],["patch",o]])for(const g of y){const{inputs:w,outputs:_,events:S,attachments:b,...k}=g,E={inputs:w,outputs:_,events:S},P=Us(k);f.push({name:`${p}.${k.id}`,payload:new Blob([P],{type:`application/json; length=${P.length}`})});for(const[N,j]of Object.entries(E)){if(j===void 0)continue;const D=Us(j);f.push({name:`${p}.${k.id}.${N}`,payload:new Blob([D],{type:`application/json; length=${D.length}`})})}if(k.id!==void 0){const N=n[k.id];if(N){delete n[k.id];for(const[j,[D,z]]of Object.entries(N)){if(j.includes(".")){console.warn(`Skipping attachment '${j}' for run ${k.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}f.push({name:`attachment.${k.id}.${j}`,payload:new Blob([z],{type:`${D}; length=${z.byteLength}`})})}}}d.push(`trace=${k.trace_id},id=${k.id}`)}await this._sendMultipartRequest(f,d.join("; "))}async _sendMultipartRequest(e,t){try{const n="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),a=[];for(const d of e)a.push(new Blob([`--${n}\r
`])),a.push(new Blob([`Content-Disposition: form-data; name="${d.name}"\r
`,`Content-Type: ${d.payload.type}\r
\r
`])),a.push(d.payload),a.push(new Blob([`\r
`]));a.push(new Blob([`--${n}--\r
`]));const l=await new Blob(a).arrayBuffer(),c=await this.batchIngestCaller.call(we(),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers,"Content-Type":`multipart/form-data; boundary=${n}`},body:l,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(c,"ingest multipart runs",!0)}catch(n){console.warn(`${n.message.trim()}

Context: ${t}`)}}async updateRun(e,t){Ne(e),t.inputs&&(t.inputs=this.processInputs(t.inputs)),t.outputs&&(t.outputs=this.processOutputs(t.outputs));const n={...t,id:e};if(!this._filterForSampling([n],!0).length)return;if(this.autoBatchTracing&&n.trace_id!==void 0&&n.dotted_order!==void 0){if(t.end_time!==void 0&&n.parent_run_id===void 0&&this.blockOnRootRunFinalization){await this.processRunOperation({action:"update",item:n}).catch(console.error);return}else this.processRunOperation({action:"update",item:n}).catch(console.error);return}const a={...this.headers,"Content-Type":"application/json"},o=await this.caller.call(we(),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:a,body:Us(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(o,"update run",!0)}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){Ne(e);let n=await this._get(`/runs/${e}`);return t&&n.child_run_ids&&(n=await this._loadChildRuns(n)),n}async getRunUrl({runId:e,run:t,projectOpts:n}){if(t!==void 0){let a;t.session_id?a=t.session_id:n!=null&&n.projectName?a=(await this.readProject({projectName:n==null?void 0:n.projectName})).id:n!=null&&n.projectId?a=n==null?void 0:n.projectId:a=(await this.readProject({projectName:Ba("PROJECT")||"default"})).id;const o=await this._getTenantId();return`${this.getHostUrl()}/o/${o}/projects/p/${a}/r/${t.id}?poll=true`}else if(e!==void 0){const a=await this.readRun(e);if(!a.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${a.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const t=await TO(this.listRuns({id:e.child_run_ids})),n={},a={};t.sort((o,l)=>((o==null?void 0:o.dotted_order)??"").localeCompare((l==null?void 0:l.dotted_order)??""));for(const o of t){if(o.parent_run_id===null||o.parent_run_id===void 0)throw new Error(`Child run ${o.id} has no parent`);o.parent_run_id in n||(n[o.parent_run_id]=[]),n[o.parent_run_id].push(o),a[o.id]=o}e.child_runs=n[e.id]||[];for(const o in n)o!==e.id&&(a[o].child_runs=n[o]);return e}async*listRuns(e){const{projectId:t,projectName:n,parentRunId:a,traceId:o,referenceExampleId:l,startTime:c,executionOrder:d,isRoot:f,runType:p,error:y,id:g,query:w,filter:_,traceFilter:S,treeFilter:b,limit:k,select:E}=e;let P=[];if(t&&(P=Array.isArray(t)?t:[t]),n){const z=Array.isArray(n)?n:[n],q=await Promise.all(z.map(K=>this.readProject({projectName:K}).then(oe=>oe.id)));P.push(...q)}const N=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],j={session:P.length?P:null,run_type:p,reference_example:l,query:w,filter:_,trace_filter:S,tree_filter:b,execution_order:d,parent_run:a,start_time:c?c.toISOString():null,error:y,id:g,limit:k,trace:o,select:E||N,is_root:f};let D=0;for await(const z of this._getCursorPaginatedList("/runs/query",j))if(k){if(D>=k)break;if(z.length+D>k){yield*z.slice(0,k-D);break}D+=z.length,yield*z}else yield*z}async getRunStats({id:e,trace:t,parentRun:n,runType:a,projectNames:o,projectIds:l,referenceExampleIds:c,startTime:d,endTime:f,error:p,query:y,filter:g,traceFilter:w,treeFilter:_,isRoot:S,dataSourceType:b}){let k=l||[];o&&(k=[...l||[],...await Promise.all(o.map(D=>this.readProject({projectName:D}).then(z=>z.id)))]);const P=Object.fromEntries(Object.entries({id:e,trace:t,parent_run:n,run_type:a,session:k,reference_example:c,start_time:d,end_time:f,error:p,query:y,filter:g,trace_filter:w,tree_filter:_,is_root:S,data_source_type:b}).filter(([D,z])=>z!==void 0));return await(await this.caller.call(we(),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(P),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:t}={}){const n={run_id:e,share_token:t||fn()};Ne(e);const o=await(await this.caller.call(we(),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(o===null||!("share_token"in o))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${o.share_token}/r`}async unshareRun(e){Ne(e);const t=await this.caller.call(we(),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(t,"unshare run",!0)}async readRunSharedLink(e){Ne(e);const n=await(await this.caller.call(we(),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(n===null||!("share_token"in n)))return`${this.getHostUrl()}/public/${n.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){const n=new URLSearchParams({share_token:e});if(t!==void 0)for(const l of t)n.append("id",l);return Ne(e),await(await this.caller.call(we(),`${this.apiUrl}/public/${e}/runs${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id),Ne(e);const a=await(await this.caller.call(we(),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async shareDataset(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id);const n={dataset_id:e};Ne(e);const o=await(await this.caller.call(we(),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return o.url=`${this.getHostUrl()}/public/${o.share_token}/d`,o}async unshareDataset(e){Ne(e);const t=await this.caller.call(we(),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(t,"unshare dataset",!0)}async readSharedDataset(e){return Ne(e),await(await this.caller.call(we(),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,t){const n={};t!=null&&t.exampleIds&&(n.id=t.exampleIds);const a=new URLSearchParams;Object.entries(n).forEach(([c,d])=>{Array.isArray(d)?d.forEach(f=>a.append(c,f)):a.append(c,d)});const o=await this.caller.call(we(),`${this.apiUrl}/public/${e}/examples?${a.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),l=await o.json();if(!o.ok)throw"detail"in l?new Error(`Failed to list shared examples.
Status: ${o.status}
Message: ${l.detail.join(`
`)}`):new Error(`Failed to list shared examples: ${o.status} ${o.statusText}`);return l.map(c=>({...c,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:n=null,upsert:a=!1,projectExtra:o=null,referenceDatasetId:l=null}){const c=a?"?upsert=true":"",d=`${this.apiUrl}/sessions${c}`,f=o||{};n&&(f.metadata=n);const p={name:e,extra:f,description:t};l!==null&&(p.reference_dataset_id=l);const y=await this.caller.call(we(),d,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(p),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(y,"create project"),await y.json()}async updateProject(e,{name:t=null,description:n=null,metadata:a=null,projectExtra:o=null,endTime:l=null}){const c=`${this.apiUrl}/sessions/${e}`;let d=o;a&&(d={...d||{},metadata:a});const f={name:t,extra:d,description:n,end_time:l?new Date(l).toISOString():null},p=await this.caller.call(we(),c,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(f),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(p,"update project"),await p.json()}async hasProject({projectId:e,projectName:t}){let n="/sessions";const a=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)Ne(e),n+=`/${e}`;else if(t!==void 0)a.append("name",t);else throw new Error("Must provide projectName or projectId");const o=await this.caller.call(we(),`${this.apiUrl}${n}?${a}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const l=await o.json();return o.ok?Array.isArray(l)?l.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:t,includeStats:n}){let a="/sessions";const o=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)Ne(e),a+=`/${e}`;else if(t!==void 0)o.append("name",t);else throw new Error("Must provide projectName or projectId");n!==void 0&&o.append("include_stats",n.toString());const l=await this._get(a,o);let c;if(Array.isArray(l)){if(l.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);c=l[0]}else c=l;return c}async getProjectUrl({projectId:e,projectName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either projectName or projectId");const n=await this.readProject({projectId:e,projectName:t}),a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${n.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");const n=await this.readDataset({datasetId:e,datasetName:t}),a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/datasets/${n.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:t,nameContains:n,referenceDatasetId:a,referenceDatasetName:o,referenceFree:l,metadata:c}={}){const d=new URLSearchParams;if(e!==void 0)for(const f of e)d.append("id",f);if(t!==void 0&&d.append("name",t),n!==void 0&&d.append("name_contains",n),a!==void 0)d.append("reference_dataset",a);else if(o!==void 0){const f=await this.readDataset({datasetName:o});d.append("reference_dataset",f.id)}l!==void 0&&d.append("reference_free",l.toString()),c!==void 0&&d.append("metadata",JSON.stringify(c));for await(const f of this._getPaginated("/sessions",d))yield*f}async deleteProject({projectId:e,projectName:t}){let n;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?n=(await this.readProject({projectName:t})).id:n=e,Ne(n);const a=await this.caller.call(we(),`${this.apiUrl}/sessions/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(a,`delete session ${n} (${t})`,!0)}async uploadCsv({csvFile:e,fileName:t,inputKeys:n,outputKeys:a,description:o,dataType:l,name:c}){const d=`${this.apiUrl}/datasets/upload`,f=new FormData;f.append("file",e,t),n.forEach(g=>{f.append("input_keys",g)}),a.forEach(g=>{f.append("output_keys",g)}),o&&f.append("description",o),l&&f.append("data_type",l),c&&f.append("name",c);const p=await this.caller.call(we(),d,{method:"POST",headers:this.headers,body:f,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(p,"upload CSV"),await p.json()}async createDataset(e,{description:t,dataType:n,inputsSchema:a,outputsSchema:o,metadata:l}={}){const c={name:e,description:t,extra:l?{metadata:l}:void 0};n&&(c.data_type=n),a&&(c.inputs_schema_definition=a),o&&(c.outputs_schema_definition=o);const d=await this.caller.call(we(),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(d,"create dataset"),await d.json()}async readDataset({datasetId:e,datasetName:t}){let n="/datasets";const a=new URLSearchParams({limit:"1"});if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)Ne(e),n+=`/${e}`;else if(t!==void 0)a.append("name",t);else throw new Error("Must provide datasetName or datasetId");const o=await this._get(n,a);let l;if(Array.isArray(o)){if(o.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);l=o[0]}else l=o;return l}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(n){if(n instanceof Error&&n.message.toLocaleLowerCase().includes("not found"))return!1;throw n}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:n,toVersion:a}){let o=e;if(o===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");if(o!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");o===void 0&&(o=(await this.readDataset({datasetName:t})).id);const l=new URLSearchParams({from_version:typeof n=="string"?n:n.toISOString(),to_version:typeof a=="string"?a:a.toISOString()});return await this._get(`/datasets/${o}/versions/diff`,l)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){const n="/datasets";if(e===void 0)if(t!==void 0)e=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide datasetName or datasetId");return(await(await this._getResponse(`${n}/${e}/openai_ft`)).text()).trim().split(`
`).map(c=>JSON.parse(c))}async*listDatasets({limit:e=100,offset:t=0,datasetIds:n,datasetName:a,datasetNameContains:o,metadata:l}={}){const c="/datasets",d=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(n!==void 0)for(const f of n)d.append("id",f);a!==void 0&&d.append("name",a),o!==void 0&&d.append("name_contains",o),l!==void 0&&d.append("metadata",JSON.stringify(l));for await(const f of this._getPaginated(c,d))yield*f}async updateDataset(e){const{datasetId:t,datasetName:n,...a}=e;if(!t&&!n)throw new Error("Must provide either datasetName or datasetId");const o=t??(await this.readDataset({datasetName:n})).id;Ne(o);const l=await this.caller.call(we(),`${this.apiUrl}/datasets/${o}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(l,"update dataset"),await l.json()}async deleteDataset({datasetId:e,datasetName:t}){let n="/datasets",a=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(a=(await this.readDataset({datasetName:t})).id),a!==void 0)Ne(a),n+=`/${a}`;else throw new Error("Must provide datasetName or datasetId");const o=await this.caller.call(we(),this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(o,`delete ${n}`),await o.json()}async indexDataset({datasetId:e,datasetName:t,tag:n}){let a=e;if(!a&&!t)throw new Error("Must provide either datasetName or datasetId");if(a&&t)throw new Error("Must provide either datasetName or datasetId, not both");a||(a=(await this.readDataset({datasetName:t})).id),Ne(a);const o={tag:n},l=await this.caller.call(we(),`${this.apiUrl}/datasets/${a}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(l,"index dataset"),await l.json()}async similarExamples(e,t,n,{filter:a}={}){const o={limit:n,inputs:e};a!==void 0&&(o.filter=a),Ne(t);const l=await this.caller.call(we(),`${this.apiUrl}/datasets/${t}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(l,"fetch similar examples"),(await l.json()).examples}async createExample(e,t,{datasetId:n,datasetName:a,createdAt:o,exampleId:l,metadata:c,split:d,sourceRunId:f}){let p=n;if(p===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(p!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");p===void 0&&(p=(await this.readDataset({datasetName:a})).id);const y=o||new Date,g={dataset_id:p,inputs:e,outputs:t,created_at:y==null?void 0:y.toISOString(),id:l,metadata:c,split:d,source_run_id:f},w=await this.caller.call(we(),`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(g),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(w,"create example"),await w.json()}async createExamples(e){const{inputs:t,outputs:n,metadata:a,sourceRunIds:o,exampleIds:l,datasetId:c,datasetName:d}=e;let f=c;if(f===void 0&&d===void 0)throw new Error("Must provide either datasetName or datasetId");if(f!==void 0&&d!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");f===void 0&&(f=(await this.readDataset({datasetName:d})).id);const p=t.map((w,_)=>({dataset_id:f,inputs:w,outputs:n?n[_]:void 0,metadata:a?a[_]:void 0,split:e.splits?e.splits[_]:void 0,id:l?l[_]:void 0,source_run_id:o?o[_]:void 0})),y=await this.caller.call(we(),`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(p),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(y,"create examples"),await y.json()}async createLLMExample(e,t,n){return this.createExample({input:e},{output:t},n)}async createChatExample(e,t,n){const a=e.map(l=>Tw(l)?Aw(l):l),o=Tw(t)?Aw(t):t;return this.createExample({input:a},{output:o},n)}async readExample(e){Ne(e);const t=`/examples/${e}`;return await this._get(t)}async*listExamples({datasetId:e,datasetName:t,exampleIds:n,asOf:a,splits:o,inlineS3Urls:l,metadata:c,limit:d,offset:f,filter:p}={}){let y;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)y=e;else if(t!==void 0)y=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const g=new URLSearchParams({dataset:y}),w=a?typeof a=="string"?a:a==null?void 0:a.toISOString():void 0;w&&g.append("as_of",w);const _=l??!0;if(g.append("inline_s3_urls",_.toString()),n!==void 0)for(const b of n)g.append("id",b);if(o!==void 0)for(const b of o)g.append("splits",b);if(c!==void 0){const b=JSON.stringify(c);g.append("metadata",b)}d!==void 0&&g.append("limit",d.toString()),f!==void 0&&g.append("offset",f.toString()),p!==void 0&&g.append("filter",p);let S=0;for await(const b of this._getPaginated("/examples",g)){for(const k of b)yield k,S++;if(d!==void 0&&S>=d)break}}async deleteExample(e){Ne(e);const t=`/examples/${e}`,n=await this.caller.call(we(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(n,`delete ${t}`),await n.json()}async updateExample(e,t){Ne(e);const n=await this.caller.call(we(),`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(n,"update example"),await n.json()}async updateExamples(e){const t=await this.caller.call(we(),`${this.apiUrl}/examples/bulk`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(t,"update examples"),await t.json()}async listDatasetSplits({datasetId:e,datasetName:t,asOf:n}){let a;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?a=(await this.readDataset({datasetName:t})).id:a=e,Ne(a);const o=new URLSearchParams,l=n?typeof n=="string"?n:n==null?void 0:n.toISOString():void 0;return l&&o.append("as_of",l),await this._get(`/datasets/${a}/splits`,o)}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:n,exampleIds:a,remove:o=!1}){let l;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?l=(await this.readDataset({datasetName:t})).id:l=e,Ne(l);const c={split_name:n,examples:a.map(f=>(Ne(f),f)),remove:o},d=await this.caller.call(we(),`${this.apiUrl}/datasets/${l}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(d,"update dataset splits",!0)}async evaluateRun(e,t,{sourceInfo:n,loadChildRuns:a,referenceExample:o}={loadChildRuns:!1}){ux("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let l;if(typeof e=="string")l=await this.readRun(e,{loadChildRuns:a});else if(typeof e=="object"&&"id"in e)l=e;else throw new Error(`Invalid run type: ${typeof e}`);l.reference_example_id!==null&&l.reference_example_id!==void 0&&(o=await this.readExample(l.reference_example_id));const c=await t.evaluateRun(l,o),[d,f]=await this._logEvaluationFeedback(c,l,n);return f[0]}async createFeedback(e,t,{score:n,value:a,correction:o,comment:l,sourceInfo:c,feedbackSourceType:d="api",sourceRunId:f,feedbackId:p,feedbackConfig:y,projectId:g,comparativeExperimentId:w}){var E;if(!e&&!g)throw new Error("One of runId or projectId must be provided");if(e&&g)throw new Error("Only one of runId or projectId can be provided");const _={type:d??"api",metadata:c??{}};f!==void 0&&(_==null?void 0:_.metadata)!==void 0&&!_.metadata.__run&&(_.metadata.__run={run_id:f}),(_==null?void 0:_.metadata)!==void 0&&((E=_.metadata.__run)==null?void 0:E.run_id)!==void 0&&Ne(_.metadata.__run.run_id);const S={id:p??fn(),run_id:e,key:t,score:n,value:a,correction:o,comment:l,feedback_source:_,comparative_experiment_id:w,feedbackConfig:y,session_id:g},b=`${this.apiUrl}/feedback`,k=await this.caller.call(we(),b,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(S),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(k,"create feedback",!0),S}async updateFeedback(e,{score:t,value:n,correction:a,comment:o}){const l={};t!=null&&(l.score=t),n!=null&&(l.value=n),a!=null&&(l.correction=a),o!=null&&(l.comment=o),Ne(e);const c=await this.caller.call(we(),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(c,"update feedback",!0)}async readFeedback(e){Ne(e);const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){Ne(e);const t=`/feedback/${e}`,n=await this.caller.call(we(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(n,`delete ${t}`),await n.json()}async*listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:n}={}){const a=new URLSearchParams;if(e&&a.append("run",e.join(",")),t)for(const o of t)a.append("key",o);if(n)for(const o of n)a.append("source",o);for await(const o of this._getPaginated("/feedback",a))yield*o}async createPresignedFeedbackToken(e,t,{expiration:n,feedbackConfig:a}={}){const o={run_id:e,feedback_key:t,feedback_config:a};return n?typeof n=="string"?o.expires_at=n:(n!=null&&n.hours||n!=null&&n.minutes||n!=null&&n.days)&&(o.expires_in=n):o.expires_in={hours:3},await(await this.caller.call(we(),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:n,createdAt:a,description:o,metadata:l,id:c}){var p;if(t.length===0)throw new Error("At least one experiment is required");if(n||(n=(await this.readProject({projectId:t[0]})).reference_dataset_id),!n==null)throw new Error("A reference dataset is required");const d={id:c,name:e,experiment_ids:t,reference_dataset_id:n,description:o,created_at:(p=a??new Date)==null?void 0:p.toISOString(),extra:{}};return l&&(d.extra.metadata=l),await(await this.caller.call(we(),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){Ne(e);const t=new URLSearchParams({run_id:e});for await(const n of this._getPaginated("/feedback/tokens",t))yield*n}_selectEvalResults(e){let t;return"results"in e?t=e.results:t=[e],t}async _logEvaluationFeedback(e,t,n){const a=this._selectEvalResults(e),o=[];for(const l of a){let c=n||{};l.evaluatorInfo&&(c={...l.evaluatorInfo,...c});let d=null;l.targetRunId?d=l.targetRunId:t&&(d=t.id),o.push(await this.createFeedback(d,l.key,{score:l.score,value:l.value,comment:l.comment,correction:l.correction,sourceInfo:c,sourceRunId:l.sourceRunId,feedbackConfig:l.feedbackConfig,feedbackSourceType:"model"}))}return[a,o]}async logEvaluationFeedback(e,t,n){const[a]=await this._logEvaluationFeedback(e,t,n);return a}async*listAnnotationQueues(e={}){const{queueIds:t,name:n,nameContains:a,limit:o}=e,l=new URLSearchParams;t&&t.forEach((d,f)=>{Ne(d,`queueIds[${f}]`),l.append("ids",d)}),n&&l.append("name",n),a&&l.append("name_contains",a),l.append("limit",(o!==void 0?Math.min(o,100):100).toString());let c=0;for await(const d of this._getPaginated("/annotation-queues",l))if(yield*d,c++,o!==void 0&&c>=o)break}async createAnnotationQueue(e){const{name:t,description:n,queueId:a}=e,o={name:t,description:n,id:a||fn()},l=await this.caller.call(we(),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(o).filter(([d,f])=>f!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(l,"create annotation queue"),await l.json()}async readAnnotationQueue(e){const t=await this.listAnnotationQueues({queueIds:[e]}).next();if(t.done)throw new Error(`Annotation queue with ID ${e} not found`);return t.value}async updateAnnotationQueue(e,t){const{name:n,description:a}=t,o=await this.caller.call(we(),`${this.apiUrl}/annotation-queues/${Ne(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:n,description:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(o,"update annotation queue")}async deleteAnnotationQueue(e){const t=await this.caller.call(we(),`${this.apiUrl}/annotation-queues/${Ne(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(t,"delete annotation queue")}async addRunsToAnnotationQueue(e,t){const n=await this.caller.call(we(),`${this.apiUrl}/annotation-queues/${Ne(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t.map((a,o)=>Ne(a,`runIds[${o}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(n,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,t){const n=`/annotation-queues/${Ne(e,"queueId")}/run`,a=await this.caller.call(we(),`${this.apiUrl}${n}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(a,"get run from annotation queue"),await a.json()}async _currentTenantIsOwner(e){const t=await this._getSettings();return e=="-"||t.tenant_handle===e}async _ownerConflictError(e,t){const n=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${n.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){const t=await this.caller.call(we(),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),n=await t.json();if(!t.ok){const a=typeof n.detail=="string"?n.detail:JSON.stringify(n.detail),o=new Error(`Error ${t.status}: ${t.statusText}
${a}`);throw o.statusCode=t.status,o}if(n.commits.length!==0)return n.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){const[n,a,o]=ia(e),l=await this.caller.call(we(),`${this.apiUrl}/likes/${n}/${a}`,{method:"POST",body:JSON.stringify({like:t}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(l,`${t?"like":"unlike"} prompt`),await l.json()}async _getPromptUrl(e){const[t,n,a]=ia(e);if(await this._currentTenantIsOwner(t)){const o=await this._getSettings();return a!=="latest"?`${this.getHostUrl()}/prompts/${n}/${a.substring(0,8)}?organizationId=${o.id}`:`${this.getHostUrl()}/prompts/${n}?organizationId=${o.id}`}else return a!=="latest"?`${this.getHostUrl()}/hub/${t}/${n}/${a.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${n}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,n=>n.commits))yield*t}async*listPrompts(e){const t=new URLSearchParams;t.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&t.append("is_public",e.isPublic.toString()),e!=null&&e.query&&t.append("query",e.query);for await(const n of this._getPaginated("/repos",t,a=>a.repos))yield*n}async getPrompt(e){const[t,n,a]=ia(e),o=await this.caller.call(we(),`${this.apiUrl}/repos/${t}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(o.status===404)return null;await Ae(o,"get prompt");const l=await o.json();return l.repo?l.repo:null}async createPrompt(e,t){const n=await this._getSettings();if(t!=null&&t.isPublic&&!n.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[a,o,l]=ia(e);if(!await this._currentTenantIsOwner(a))throw await this._ownerConflictError("create a prompt",a);const c={repo_handle:o,...(t==null?void 0:t.description)&&{description:t.description},...(t==null?void 0:t.readme)&&{readme:t.readme},...(t==null?void 0:t.tags)&&{tags:t.tags},is_public:!!(t!=null&&t.isPublic)},d=await this.caller.call(we(),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(d,"create prompt");const{repo:f}=await d.json();return f}async createCommit(e,t,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[a,o,l]=ia(e),c=(n==null?void 0:n.parentCommitHash)==="latest"||!(n!=null&&n.parentCommitHash)?await this._getLatestCommitHash(`${a}/${o}`):n==null?void 0:n.parentCommitHash,d={manifest:JSON.parse(JSON.stringify(t)),parent_commit:c},f=await this.caller.call(we(),`${this.apiUrl}/commits/${a}/${o}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(f,"create commit");const p=await f.json();return this._getPromptUrl(`${a}/${o}${p.commit_hash?`:${p.commit_hash}`:""}`)}async updatePrompt(e,t){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,a]=ia(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("update a prompt",n);const o={};if((t==null?void 0:t.description)!==void 0&&(o.description=t.description),(t==null?void 0:t.readme)!==void 0&&(o.readme=t.readme),(t==null?void 0:t.tags)!==void 0&&(o.tags=t.tags),(t==null?void 0:t.isPublic)!==void 0&&(o.is_public=t.isPublic),(t==null?void 0:t.isArchived)!==void 0&&(o.is_archived=t.isArchived),Object.keys(o).length===0)throw new Error("No valid update options provided");const l=await this.caller.call(we(),`${this.apiUrl}/repos/${n}/${a}`,{method:"PATCH",body:JSON.stringify(o),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ae(l,"update prompt"),l.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[t,n,a]=ia(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);return await(await this.caller.call(we(),`${this.apiUrl}/repos/${t}/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,t){const[n,a,o]=ia(e),l=await this._getServerInfo(),c=SO(l.version,"0.5.23");let d=o;if(!c&&o==="latest"){const y=await this._getLatestCommitHash(`${n}/${a}`);if(y)d=y;else throw new Error("No commits found")}const f=await this.caller.call(we(),`${this.apiUrl}/commits/${n}/${a}/${d}${t!=null&&t.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ae(f,"pull prompt commit");const p=await f.json();return{owner:n,repo:a,commit_hash:p.commit_hash,manifest:p.manifest,examples:p.examples}}async _pullPrompt(e,t){const n=await this.pullPromptCommit(e,{includeModel:t==null?void 0:t.includeModel});return JSON.stringify(n.manifest)}async pushPrompt(e,t){return await this.promptExists(e)?t&&Object.keys(t).some(a=>a!=="object")&&await this.updatePrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}):await this.createPrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}),t!=null&&t.object?await this.createCommit(e,t==null?void 0:t.object,{parentCommitHash:t==null?void 0:t.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,t={}){const{sourceApiUrl:n=this.apiUrl,datasetName:a}=t,[o,l]=this.parseTokenOrUrl(e,n),c=new Go({apiUrl:o,apiKey:"placeholder"}),d=await c.readSharedDataset(l),f=a||d.name;try{if(await this.hasDataset({datasetId:f})){console.log(`Dataset ${f} already exists in your tenant. Skipping.`);return}}catch{}const p=await c.listSharedExamples(l),y=await this.createDataset(f,{description:d.description,dataType:d.data_type||"kv",inputsSchema:d.inputs_schema_definition??void 0,outputsSchema:d.outputs_schema_definition??void 0});try{await this.createExamples({inputs:p.map(g=>g.inputs),outputs:p.flatMap(g=>g.outputs?[g.outputs]:[]),datasetId:y.id})}catch(g){throw console.error(`An error occurred while creating dataset ${f}. You should delete it manually.`),g}}parseTokenOrUrl(e,t,n=2,a="dataset"){try{return Ne(e),[t,e]}catch{}try{const l=new URL(e).pathname.split("/").filter(c=>c!=="");if(l.length>=n){const c=l[l.length-n];return[t,c]}else throw new Error(`Invalid public ${a} URL: ${e}`)}catch{throw new Error(`Invalid public ${a} URL or token: ${e}`)}}awaitPendingTraceBatches(){return Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()])}}const px="0.2.8";var Co={};let kr;const jO=()=>typeof window<"u"&&typeof window.document<"u",LO=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",MO=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),mx=()=>typeof Deno<"u",DO=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!mx(),FO=()=>kr||(jO()?kr="browser":DO()?kr="node":LO()?kr="webworker":MO()?kr="jsdom":mx()?kr="deno":kr="other",kr);let rp;function gx(){if(rp===void 0){const r=FO(),e=BO();rp={library:"langsmith",runtime:r,sdk:"langsmith-js",sdk_version:px,...e}}return rp}function UO(){const r=zO()||{},e={},t=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[n,a]of Object.entries(r))(n.startsWith("LANGCHAIN_")||n.startsWith("LANGSMITH_"))&&typeof a=="string"&&!t.includes(n)&&!n.toLowerCase().includes("key")&&!n.toLowerCase().includes("secret")&&!n.toLowerCase().includes("token")&&(n==="LANGCHAIN_REVISION_ID"?e.revision_id=a:e[n]=a);return e}function zO(){try{return typeof process<"u"&&Co?Object.entries(Co).reduce((r,[e,t])=>(r[e]=String(t),r),{}):void 0}catch{return}}function ha(r){try{return typeof process<"u"?Co==null?void 0:Co[r]:void 0}catch{return}}function Ba(r){return ha(`LANGSMITH_${r}`)||ha(`LANGCHAIN_${r}`)}let ap;function BO(){if(ap!==void 0)return ap;const r=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const t of r){const n=ha(t);n!==void 0&&(e[t]=n)}return ap=e,e}const HO=r=>!!["TRACING_V2","TRACING"].find(t=>Ba(t)==="true"),sp=Symbol.for("lc:context_variables");function VO(r){return r.replace(/[-:.]/g,"")}function qO(r,e,t=1){const n=t.toFixed(0).slice(0,3).padStart(3,"0");return VO(`${new Date(r).toISOString().slice(0,-1)}${n}Z`)+e}class Ec{constructor(e,t){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t}static fromHeader(e){const t=e.split(",");let n={},a=[];for(const o of t){const[l,c]=o.split("="),d=decodeURIComponent(c);l==="langsmith-metadata"?n=JSON.parse(d):l==="langsmith-tags"&&(a=d.split(","))}return new Ec(n,a)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class cn{constructor(e){var c;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),yx(e)){Object.assign(this,{...e});return}const t=cn.getDefaultConfig(),{metadata:n,...a}=e,o=a.client??cn.getSharedClient(),l={...n,...(c=a==null?void 0:a.extra)==null?void 0:c.metadata};if(a.extra={...a.extra,metadata:l},Object.assign(this,{...t,...a,client:o}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const d=qO(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+d:this.dotted_order=d}}static getDefaultConfig(){return{id:fn(),run_type:"chain",project_name:ha("LANGCHAIN_PROJECT")??ha("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:ha("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:ha("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return cn.sharedClient||(cn.sharedClient=new Go),cn.sharedClient}createChild(e){var d,f,p,y,g,w;const t=this.child_execution_order+1,n=new cn({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});sp in this&&(n[sp]=this[sp]);const a=Symbol.for("lc:child_config"),o=((d=e.extra)==null?void 0:d[a])??this.extra[a];if(ZO(o)){const _={...o},S=WO(_.callbacks)?(p=(f=_.callbacks).copy)==null?void 0:p.call(f):void 0;S&&(Object.assign(S,{_parentRunId:n.id}),(w=(g=(y=S.handlers)==null?void 0:y.find(vx))==null?void 0:g.updateFromRunTree)==null||w.call(g,n),_.callbacks=S),n.extra[a]=_}const l=new Set;let c=this;for(;c!=null&&!l.has(c.id);)l.add(c.id),c.child_execution_order=Math.max(c.child_execution_order,t),c=c.parent_run;return this.child_runs.push(n),n}async end(e,t,n=Date.now(),a){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??n,a&&Object.keys(a).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...a}}:{metadata:a})}_convertToCreate(e,t,n=!0){var d;const a=e.extra??{};if(a.runtime||(a.runtime={}),t)for(const[f,p]of Object.entries(t))a.runtime[f]||(a.runtime[f]=p);let o,l;return n?(l=(d=e.parent_run)==null?void 0:d.id,o=[]):(o=e.child_runs.map(f=>this._convertToCreate(f,t,n)),l=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:a,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:o,parent_run_id:l,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments}}async postRun(e=!0){try{const t=gx(),n=await this._convertToCreate(this,t,!0);if(await this.client.createRun(n),!e){ux("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const a of this.child_runs)await a.postRun(!1)}}catch(t){console.error(`Error in postRun for run ${this.id}:`,t)}}async patchRun(){var e;try{const t={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:(e=this.parent_run)==null?void 0:e.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments};await this.client.updateRun(this.id,t)}catch(t){console.error(`Error in patchRun for run ${this.id}`,t)}}toJSON(){return this._convertToCreate(this,void 0,!1)}static fromRunnableConfig(e,t){var f,p,y,g;const n=e==null?void 0:e.callbacks;let a,o,l,c=HO();if(n){const w=((f=n==null?void 0:n.getParentRunId)==null?void 0:f.call(n))??"",_=(p=n==null?void 0:n.handlers)==null?void 0:p.find(S=>(S==null?void 0:S.name)=="langchain_tracer");a=(y=_==null?void 0:_.getRun)==null?void 0:y.call(_,w),o=_==null?void 0:_.projectName,l=_==null?void 0:_.client,c=c||!!_}return a?new cn({name:a.name,id:a.id,trace_id:a.trace_id,dotted_order:a.dotted_order,client:l,tracingEnabled:c,project_name:o,tags:[...new Set(((a==null?void 0:a.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(g=a==null?void 0:a.extra)==null?void 0:g.metadata,...e==null?void 0:e.metadata}}}).createChild(t):new cn({...t,client:l,tracingEnabled:c,project_name:o})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){var f;const n="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,a=n["langsmith-trace"];if(!a||typeof a!="string")return;const o=a.trim(),l=o.split(".").map(p=>{const[y,g]=p.split("Z");return{strTime:y,time:Date.parse(y+"Z"),uuid:g}}),c=l[0].uuid,d={...t,name:(t==null?void 0:t.name)??"parent",run_type:(t==null?void 0:t.run_type)??"chain",start_time:(t==null?void 0:t.start_time)??Date.now(),id:(f=l.at(-1))==null?void 0:f.uuid,trace_id:c,dotted_order:o};if(n.baggage&&typeof n.baggage=="string"){const p=Ec.fromHeader(n.baggage);d.metadata=p.metadata,d.tags=p.tags}return new cn(d)}toHeaders(e){var n;const t={"langsmith-trace":this.dotted_order,baggage:new Ec((n=this.extra)==null?void 0:n.metadata,this.tags).toHeader()};if(e)for(const[a,o]of Object.entries(t))e.set(a,o);return t}}Object.defineProperty(cn,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function yx(r){return r!==void 0&&typeof r.createChild=="function"&&typeof r.postRun=="function"}function vx(r){return typeof r=="object"&&r!=null&&typeof r.name=="string"&&r.name==="langchain_tracer"}function P_(r){return Array.isArray(r)&&r.some(e=>vx(e))}function WO(r){return typeof r=="object"&&r!=null&&Array.isArray(r.handlers)}function ZO(r){var e;return r!==void 0&&typeof r.callbacks=="object"&&(P_((e=r.callbacks)==null?void 0:e.handlers)||P_(r.callbacks))}let GO=class{getStore(){}run(e,t){return t()}};const ip=Symbol.for("ls:tracing_async_local_storage"),JO=new GO;let KO=class{getInstance(){return globalThis[ip]??JO}initializeGlobalInstance(e){globalThis[ip]===void 0&&(globalThis[ip]=e)}};const XO=new KO,QO=()=>{const r=XO.getInstance().getStore();if(!yx(r))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function or the tracing is enabled."].join(`
`));return r};function Vm(r){return typeof r=="function"&&"langsmith:traceable"in r}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const YO=Object.prototype.hasOwnProperty;function Up(r,e){return YO.call(r,e)}function zp(r){if(Array.isArray(r)){const t=new Array(r.length);for(let n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(r);let e=[];for(let t in r)Up(r,t)&&e.push(t);return e}function lr(r){switch(typeof r){case"object":return JSON.parse(JSON.stringify(r));case"undefined":return null;default:return r}}function Bp(r){let e=0;const t=r.length;let n;for(;e<t;){if(n=r.charCodeAt(e),n>=48&&n<=57){e++;continue}return!1}return!0}function Ls(r){return r.indexOf("/")===-1&&r.indexOf("~")===-1?r:r.replace(/~/g,"~0").replace(/\//g,"~1")}function eT(r){return r.replace(/~1/g,"/").replace(/~0/g,"~")}function Hp(r){if(r===void 0)return!0;if(r){if(Array.isArray(r)){for(let t=0,n=r.length;t<n;t++)if(Hp(r[t]))return!0}else if(typeof r=="object"){const t=zp(r),n=t.length;for(var e=0;e<n;e++)if(Hp(r[t[e]]))return!0}}return!1}function R_(r,e){const t=[r];for(const n in e){const a=typeof e[n]=="object"?JSON.stringify(e[n],null,2):e[n];typeof a<"u"&&t.push(`${n}: ${a}`)}return t.join(`
`)}class tT extends Error{constructor(e,t,n,a,o){super(R_(e,{name:t,index:n,operation:a,tree:o})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.setPrototypeOf(this,new.target.prototype),this.message=R_(e,{name:t,index:n,operation:a,tree:o})}}const ft=tT,Vs={add:function(r,e,t){return r[e]=this.value,{newDocument:t}},remove:function(r,e,t){var n=r[e];return delete r[e],{newDocument:t,removed:n}},replace:function(r,e,t){var n=r[e];return r[e]=this.value,{newDocument:t,removed:n}},move:function(r,e,t){let n=Vp(t,this.path);n&&(n=lr(n));const a=Po(t,{op:"remove",path:this.from}).removed;return Po(t,{op:"add",path:this.path,value:a}),{newDocument:t,removed:n}},copy:function(r,e,t){const n=Vp(t,this.from);return Po(t,{op:"add",path:this.path,value:lr(n)}),{newDocument:t}},test:function(r,e,t){return{newDocument:t,test:Cc(r[e],this.value)}},_get:function(r,e,t){return this.value=r[e],{newDocument:t}}};var nT={add:function(r,e,t){return Bp(e)?r.splice(e,0,this.value):r[e]=this.value,{newDocument:t,index:e}},remove:function(r,e,t){var n=r.splice(e,1);return{newDocument:t,removed:n[0]}},replace:function(r,e,t){var n=r[e];return r[e]=this.value,{newDocument:t,removed:n}},move:Vs.move,copy:Vs.copy,test:Vs.test,_get:Vs._get};function Vp(r,e){if(e=="")return r;var t={op:"_get",path:e};return Po(r,t),t.value}function Po(r,e,t=!1,n=!0,a=!0,o=0){if(t&&(typeof t=="function"?t(e,0,r,e.path):qp(e,0)),e.path===""){let l={newDocument:r};if(e.op==="add")return l.newDocument=e.value,l;if(e.op==="replace")return l.newDocument=e.value,l.removed=r,l;if(e.op==="move"||e.op==="copy")return l.newDocument=Vp(r,e.from),e.op==="move"&&(l.removed=r),l;if(e.op==="test"){if(l.test=Cc(r,e.value),l.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",o,e,r);return l.newDocument=r,l}else{if(e.op==="remove")return l.removed=r,l.newDocument=null,l;if(e.op==="_get")return e.value=r,l;if(t)throw new ft("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,e,r);return l}}else{n||(r=lr(r));const c=(e.path||"").split("/");let d=r,f=1,p=c.length,y,g,w;for(typeof t=="function"?w=t:w=qp;;){if(g=c[f],g&&g.indexOf("~")!=-1&&(g=eT(g)),a&&(g=="__proto__"||g=="prototype"&&f>0&&c[f-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&y===void 0&&(d[g]===void 0?y=c.slice(0,f).join("/"):f==p-1&&(y=e.path),y!==void 0&&w(e,0,r,y)),f++,Array.isArray(d)){if(g==="-")g=d.length;else{if(t&&!Bp(g))throw new ft("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,e,r);Bp(g)&&(g=~~g)}if(f>=p){if(t&&e.op==="add"&&g>d.length)throw new ft("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,e,r);const _=nT[e.op].call(e,d,g,r);if(_.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",o,e,r);return _}}else if(f>=p){const _=Vs[e.op].call(e,d,g,r);if(_.test===!1)throw new ft("Test operation failed","TEST_OPERATION_FAILED",o,e,r);return _}if(d=d[g],t&&f<p&&(!d||typeof d!="object"))throw new ft("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,e,r)}}}function kc(r,e,t,n=!0,a=!0){if(t&&!Array.isArray(e))throw new ft("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(r=lr(r));const o=new Array(e.length);for(let l=0,c=e.length;l<c;l++)o[l]=Po(r,e[l],t,!0,a,l),r=o[l].newDocument;return o.newDocument=r,o}function qp(r,e,t,n){if(typeof r!="object"||r===null||Array.isArray(r))throw new ft("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,r,t);if(Vs[r.op]){if(typeof r.path!="string")throw new ft("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,r,t);if(r.path.indexOf("/")!==0&&r.path.length>0)throw new ft('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,r,t);if((r.op==="move"||r.op==="copy")&&typeof r.from!="string")throw new ft("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,r,t);if((r.op==="add"||r.op==="replace"||r.op==="test")&&r.value===void 0)throw new ft("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,r,t);if((r.op==="add"||r.op==="replace"||r.op==="test")&&Hp(r.value))throw new ft("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,r,t);if(t){if(r.op=="add"){var a=r.path.split("/").length,o=n.split("/").length;if(a!==o+1&&a!==o)throw new ft("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,r,t)}else if(r.op==="replace"||r.op==="remove"||r.op==="_get"){if(r.path!==n)throw new ft("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,r,t)}else if(r.op==="move"||r.op==="copy"){var l={op:"_get",path:r.from,value:void 0},c=rT([l],t);if(c&&c.name==="OPERATION_PATH_UNRESOLVABLE")throw new ft("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,r,t)}}}else throw new ft("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,r,t)}function rT(r,e,t){try{if(!Array.isArray(r))throw new ft("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)kc(lr(e),lr(r),t||!0);else{t=t||qp;for(var n=0;n<r.length;n++)t(r[n],n,e,void 0)}}catch(a){if(a instanceof ft)return a;throw a}}function Cc(r,e){if(r===e)return!0;if(r&&e&&typeof r=="object"&&typeof e=="object"){var t=Array.isArray(r),n=Array.isArray(e),a,o,l;if(t&&n){if(o=r.length,o!=e.length)return!1;for(a=o;a--!==0;)if(!Cc(r[a],e[a]))return!1;return!0}if(t!=n)return!1;var c=Object.keys(r);if(o=c.length,o!==Object.keys(e).length)return!1;for(a=o;a--!==0;)if(!e.hasOwnProperty(c[a]))return!1;for(a=o;a--!==0;)if(l=c[a],!Cc(r[l],e[l]))return!1;return!0}return r!==r&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function wx(r,e,t,n,a){if(e!==r){typeof e.toJSON=="function"&&(e=e.toJSON());for(var o=zp(e),l=zp(r),c=!1,d=l.length-1;d>=0;d--){var f=l[d],p=r[f];if(Up(e,f)&&!(e[f]===void 0&&p!==void 0&&Array.isArray(e)===!1)){var y=e[f];typeof p=="object"&&p!=null&&typeof y=="object"&&y!=null&&Array.isArray(p)===Array.isArray(y)?wx(p,y,t,n+"/"+Ls(f),a):p!==y&&(a&&t.push({op:"test",path:n+"/"+Ls(f),value:lr(p)}),t.push({op:"replace",path:n+"/"+Ls(f),value:lr(y)}))}else Array.isArray(r)===Array.isArray(e)?(a&&t.push({op:"test",path:n+"/"+Ls(f),value:lr(p)}),t.push({op:"remove",path:n+"/"+Ls(f)}),c=!0):(a&&t.push({op:"test",path:n,value:r}),t.push({op:"replace",path:n,value:e}))}if(!(!c&&o.length==l.length))for(var d=0;d<o.length;d++){var f=o[d];!Up(r,f)&&e[f]!==void 0&&t.push({op:"add",path:n+"/"+Ls(f),value:lr(e[f])})}}}function aT(r,e,t=!1){var n=[];return wx(r,e,n,"",t),n}var op={};const sT=()=>typeof window<"u"&&typeof window.document<"u",iT=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",oT=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),_x=()=>typeof Deno<"u",lT=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!_x(),uT=()=>{let r;return sT()?r="browser":lT()?r="node":iT()?r="webworker":oT()?r="jsdom":_x()?r="deno":r="other",r};let lp;async function cT(){return lp===void 0&&(lp={library:"langchain-js",runtime:uT()}),lp}function zt(r){try{return typeof process<"u"?op==null?void 0:op[r]:void 0}catch{return}}class dT{}class ll extends dT{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,G0(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:zt("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Ja.prototype.toJSON.call(this)}toJSONNotImplemented(){return Ja.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends ll{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:fn()}),Object.assign(this,e)}}return new t}}function up(r,e){return r&&!Array.isArray(r)&&typeof r=="object"?r:{[e]:r}}function fT(r){return r.replace(/[-:.]/g,"")}function hT(r,e,t){const n=t.toFixed(0).slice(0,3).padStart(3,"0");return fT(`${new Date(r).toISOString().slice(0,-1)}${n}Z`)+e}function uo(r){return typeof r._addRunToRunMap=="function"}class ul extends ll{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){const t=hT(e.start_time,e.id,e.execution_order),n={...e};if(n.parent_run_id!==void 0){const a=this.runMap.get(n.parent_run_id);a&&(this._addChildRun(a,n),a.child_execution_order=Math.max(a.child_execution_order,n.child_execution_order),n.trace_id=a.trace_id,a.dotted_order!==void 0&&(n.dotted_order=[a.dotted_order,t].join(".")))}else n.trace_id=n.id,n.dotted_order=t;return this.runMap.set(n.id,n),n}async _endTrace(e){var n;const t=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((n=this.onRunUpdate)==null?void 0:n.call(this,e))}_getExecutionOrder(e){const t=e!==void 0&&this.runMap.get(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,n,a,o,l,c,d){const f=this._getExecutionOrder(a),p=Date.now(),y=c?{...o,metadata:c}:o,g={id:n,name:d??e.id[e.id.length-1],parent_run_id:a,start_time:p,serialized:e,events:[{name:"start",time:new Date(p).toISOString()}],inputs:{prompts:t},execution_order:f,child_runs:[],child_execution_order:f,run_type:"llm",extra:y??{},tags:l||[]};return this._addRunToRunMap(g)}async handleLLMStart(e,t,n,a,o,l,c,d){var p,y;const f=this.runMap.get(n)??this._createRunForLLMStart(e,t,n,a,o,l,c,d);return await((p=this.onRunCreate)==null?void 0:p.call(this,f)),await((y=this.onLLMStart)==null?void 0:y.call(this,f)),f}_createRunForChatModelStart(e,t,n,a,o,l,c,d){const f=this._getExecutionOrder(a),p=Date.now(),y=c?{...o,metadata:c}:o,g={id:n,name:d??e.id[e.id.length-1],parent_run_id:a,start_time:p,serialized:e,events:[{name:"start",time:new Date(p).toISOString()}],inputs:{messages:t},execution_order:f,child_runs:[],child_execution_order:f,run_type:"llm",extra:y??{},tags:l||[]};return this._addRunToRunMap(g)}async handleChatModelStart(e,t,n,a,o,l,c,d){var p,y;const f=this.runMap.get(n)??this._createRunForChatModelStart(e,t,n,a,o,l,c,d);return await((p=this.onRunCreate)==null?void 0:p.call(this,f)),await((y=this.onLLMStart)==null?void 0:y.call(this,f)),f}async handleLLMEnd(e,t){var a;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="llm")throw new Error("No LLM run to end.");return n.end_time=Date.now(),n.outputs=e,n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await((a=this.onLLMEnd)==null?void 0:a.call(this,n)),await this._endTrace(n),n}async handleLLMError(e,t){var a;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="llm")throw new Error("No LLM run to end.");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await((a=this.onLLMError)==null?void 0:a.call(this,n)),await this._endTrace(n),n}_createRunForChainStart(e,t,n,a,o,l,c,d){const f=this._getExecutionOrder(a),p=Date.now(),y={id:n,name:d??e.id[e.id.length-1],parent_run_id:a,start_time:p,serialized:e,events:[{name:"start",time:new Date(p).toISOString()}],inputs:t,execution_order:f,child_execution_order:f,run_type:c??"chain",child_runs:[],extra:l?{metadata:l}:{},tags:o||[]};return this._addRunToRunMap(y)}async handleChainStart(e,t,n,a,o,l,c,d){var p,y;const f=this.runMap.get(n)??this._createRunForChainStart(e,t,n,a,o,l,c,d);return await((p=this.onRunCreate)==null?void 0:p.call(this,f)),await((y=this.onChainStart)==null?void 0:y.call(this,f)),f}async handleChainEnd(e,t,n,a,o){var c;const l=this.runMap.get(t);if(!l)throw new Error("No chain run to end.");return l.end_time=Date.now(),l.outputs=up(e,"output"),l.events.push({name:"end",time:new Date(l.end_time).toISOString()}),(o==null?void 0:o.inputs)!==void 0&&(l.inputs=up(o.inputs,"input")),await((c=this.onChainEnd)==null?void 0:c.call(this,l)),await this._endTrace(l),l}async handleChainError(e,t,n,a,o){var c;const l=this.runMap.get(t);if(!l)throw new Error("No chain run to end.");return l.end_time=Date.now(),l.error=this.stringifyError(e),l.events.push({name:"error",time:new Date(l.end_time).toISOString()}),(o==null?void 0:o.inputs)!==void 0&&(l.inputs=up(o.inputs,"input")),await((c=this.onChainError)==null?void 0:c.call(this,l)),await this._endTrace(l),l}_createRunForToolStart(e,t,n,a,o,l,c){const d=this._getExecutionOrder(a),f=Date.now(),p={id:n,name:c??e.id[e.id.length-1],parent_run_id:a,start_time:f,serialized:e,events:[{name:"start",time:new Date(f).toISOString()}],inputs:{input:t},execution_order:d,child_execution_order:d,run_type:"tool",child_runs:[],extra:l?{metadata:l}:{},tags:o||[]};return this._addRunToRunMap(p)}async handleToolStart(e,t,n,a,o,l,c){var f,p;const d=this.runMap.get(n)??this._createRunForToolStart(e,t,n,a,o,l,c);return await((f=this.onRunCreate)==null?void 0:f.call(this,d)),await((p=this.onToolStart)==null?void 0:p.call(this,d)),d}async handleToolEnd(e,t){var a;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.outputs={output:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await((a=this.onToolEnd)==null?void 0:a.call(this,n)),await this._endTrace(n),n}async handleToolError(e,t){var a;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await((a=this.onToolError)==null?void 0:a.call(this,n)),await this._endTrace(n),n}async handleAgentAction(e,t){var o;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="chain")return;const a=n;a.actions=a.actions||[],a.actions.push(e),a.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((o=this.onAgentAction)==null?void 0:o.call(this,n))}async handleAgentEnd(e,t){var a;const n=this.runMap.get(t);!n||(n==null?void 0:n.run_type)!=="chain"||(n.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((a=this.onAgentEnd)==null?void 0:a.call(this,n)))}_createRunForRetrieverStart(e,t,n,a,o,l,c){const d=this._getExecutionOrder(a),f=Date.now(),p={id:n,name:c??e.id[e.id.length-1],parent_run_id:a,start_time:f,serialized:e,events:[{name:"start",time:new Date(f).toISOString()}],inputs:{query:t},execution_order:d,child_execution_order:d,run_type:"retriever",child_runs:[],extra:l?{metadata:l}:{},tags:o||[]};return this._addRunToRunMap(p)}async handleRetrieverStart(e,t,n,a,o,l,c){var f,p;const d=this.runMap.get(n)??this._createRunForRetrieverStart(e,t,n,a,o,l,c);return await((f=this.onRunCreate)==null?void 0:f.call(this,d)),await((p=this.onRetrieverStart)==null?void 0:p.call(this,d)),d}async handleRetrieverEnd(e,t){var a;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.outputs={documents:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await((a=this.onRetrieverEnd)==null?void 0:a.call(this,n)),await this._endTrace(n),n}async handleRetrieverError(e,t){var a;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await((a=this.onRetrieverError)==null?void 0:a.call(this,n)),await this._endTrace(n),n}async handleText(e,t){var a;const n=this.runMap.get(t);!n||(n==null?void 0:n.run_type)!=="chain"||(n.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((a=this.onText)==null?void 0:a.call(this,n)))}async handleLLMNewToken(e,t,n,a,o,l){var d;const c=this.runMap.get(n);if(!c||(c==null?void 0:c.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return c.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:l==null?void 0:l.chunk}}),await((d=this.onLLMNewToken)==null?void 0:d.call(this,c,e,{chunk:l==null?void 0:l.chunk})),c}}const bx=Symbol.for("ls:tracing_async_local_storage"),pT=r=>{globalThis[bx]=r},qs=()=>globalThis[bx];var nc={exports:{}};nc.exports;var O_;function mT(){return O_||(O_=1,function(r){const t=(o=0)=>l=>`\x1B[${38+o};5;${l}m`,n=(o=0)=>(l,c,d)=>`\x1B[${38+o};2;${l};${c};${d}m`;function a(){const o=new Map,l={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};l.color.gray=l.color.blackBright,l.bgColor.bgGray=l.bgColor.bgBlackBright,l.color.grey=l.color.blackBright,l.bgColor.bgGrey=l.bgColor.bgBlackBright;for(const[c,d]of Object.entries(l)){for(const[f,p]of Object.entries(d))l[f]={open:`\x1B[${p[0]}m`,close:`\x1B[${p[1]}m`},d[f]=l[f],o.set(p[0],p[1]);Object.defineProperty(l,c,{value:d,enumerable:!1})}return Object.defineProperty(l,"codes",{value:o,enumerable:!1}),l.color.close="\x1B[39m",l.bgColor.close="\x1B[49m",l.color.ansi256=t(),l.color.ansi16m=n(),l.bgColor.ansi256=t(10),l.bgColor.ansi16m=n(10),Object.defineProperties(l,{rgbToAnsi256:{value:(c,d,f)=>c===d&&d===f?c<8?16:c>248?231:Math.round((c-8)/247*24)+232:16+36*Math.round(c/255*5)+6*Math.round(d/255*5)+Math.round(f/255*5),enumerable:!1},hexToRgb:{value:c=>{const d=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(c.toString(16));if(!d)return[0,0,0];let{colorString:f}=d.groups;f.length===3&&(f=f.split("").map(y=>y+y).join(""));const p=Number.parseInt(f,16);return[p>>16&255,p>>8&255,p&255]},enumerable:!1},hexToAnsi256:{value:c=>l.rgbToAnsi256(...l.hexToRgb(c)),enumerable:!1}}),l}Object.defineProperty(r,"exports",{enumerable:!0,get:a})}(nc)),nc.exports}var gT=mT();const xx=Ya(gT);function Ut(r,e){return`${r.open}${e}${r.close}`}function Cn(r,e){try{return JSON.stringify(r,null,2)}catch{return e}}function T_(r){return typeof r=="string"?r.trim():r==null?r:Cn(r,r.toString())}function oa(r){if(!r.end_time)return"";const e=r.end_time-r.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Qt}=xx;class A_ extends ul{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let n=e;for(;n.parent_run_id;){const a=this.runMap.get(n.parent_run_id);if(a)t.push(a),n=a;else break}return t}getBreadcrumbs(e){const n=[...this.getParents(e).reverse(),e].map((a,o,l)=>{const c=`${a.execution_order}:${a.run_type}:${a.name}`;return o===l.length-1?Ut(xx.bold,c):c}).join(" > ");return Ut(Qt.grey,n)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.green,"[chain/start]")} [${t}] Entering Chain run with input: ${Cn(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.cyan,"[chain/end]")} [${t}] [${oa(e)}] Exiting Chain run with output: ${Cn(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.red,"[chain/error]")} [${t}] [${oa(e)}] Chain run errored with error: ${Cn(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),n="prompts"in e.inputs?{prompts:e.inputs.prompts.map(a=>a.trim())}:e.inputs;console.log(`${Ut(Qt.green,"[llm/start]")} [${t}] Entering LLM run with input: ${Cn(n,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.cyan,"[llm/end]")} [${t}] [${oa(e)}] Exiting LLM run with output: ${Cn(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.red,"[llm/error]")} [${t}] [${oa(e)}] LLM run errored with error: ${Cn(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.green,"[tool/start]")} [${t}] Entering Tool run with input: "${T_(e.inputs.input)}"`)}onToolEnd(e){var n;const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.cyan,"[tool/end]")} [${t}] [${oa(e)}] Exiting Tool run with output: "${T_((n=e.outputs)==null?void 0:n.output)}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.red,"[tool/error]")} [${t}] [${oa(e)}] Tool run errored with error: ${Cn(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${Cn(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.cyan,"[retriever/end]")} [${t}] [${oa(e)}] Exiting Retriever run with output: ${Cn(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${Ut(Qt.red,"[retriever/error]")} [${t}] [${oa(e)}] Retriever run errored with error: ${Cn(e.error,"[error]")}`)}onAgentAction(e){const t=e,n=this.getBreadcrumbs(e);console.log(`${Ut(Qt.blue,"[agent/action]")} [${n}] Agent selected action: ${Cn(t.actions[t.actions.length-1],"[action]")}`)}}let cp;const yT=()=>{if(cp===void 0){const r=zt("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};cp=new Go(r)}return cp};class Ro extends ul{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:n,client:a}=e;this.projectName=n??zt("LANGCHAIN_PROJECT")??zt("LANGCHAIN_SESSION"),this.exampleId=t,this.client=a??yT();const o=Ro.getTraceableRunTree();o&&this.updateFromRunTree(o)}async _convertToCreate(e,t=void 0){return{...e,extra:{...e.extra,runtime:await cT()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async onRunCreate(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async onRunUpdate(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id};await this.client.updateRun(e.id,t)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let t=e;const n=new Set;for(;t.parent_run&&!(n.has(t.id)||(n.add(t.id),!t.parent_run));)t=t.parent_run;n.clear();const a=[t];for(;a.length>0;){const o=a.shift();!o||n.has(o.id)||(n.add(o.id),this.runMap.set(o.id,o),o.child_runs&&a.push(...o.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const t={},n=[];for(const[a,o]of this.runMap){const l=new cn({...o,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});t[a]=l,n.push([a,o.dotted_order])}n.sort((a,o)=>!a[1]||!o[1]?0:a[1].localeCompare(o[1]));for(const[a]of n){const o=this.runMap.get(a),l=t[a];if(!(!o||!l)&&o.parent_run_id){const c=t[o.parent_run_id];c&&(c.child_runs.push(l),l.parent_run=c)}}return t[e]}static getTraceableRunTree(){try{return QO()}catch{return}}}let Oo;function vT(){const r="default"in $r?$r.default:$r;return new r({autoStart:!0,concurrency:1})}function wT(){return typeof Oo>"u"&&(Oo=vT()),Oo}async function yt(r,e){e===!0?qs()!==void 0?await qs().run(void 0,async()=>r()):await r():(Oo=wT(),Oo.add(async()=>{qs()!==void 0?await qs().run(void 0,async()=>r()):await r()}))}const _T=r=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(t=>zt(t)==="true");class bT{setHandler(e){return this.setHandlers([e])}}class Yc{constructor(e,t,n,a,o,l,c,d){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:d})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>yt(async()=>{var n;try{await((n=t.handleText)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}async handleCustomEvent(e,t,n,a,o){await Promise.all(this.handlers.map(l=>yt(async()=>{var c;try{await((c=l.handleCustomEvent)==null?void 0:c.call(l,e,t,this.runId,this.tags,this.metadata))}catch(d){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleCustomEvent: ${d}`),l.raiseError)throw d}},l.awaitHandlers)))}}class xT extends Yc{getChild(e){const t=new pn(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>yt(async()=>{var n;if(!t.ignoreRetriever)try{await((n=t.handleRetrieverEnd)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw a}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>yt(async()=>{var n;if(!t.ignoreRetriever)try{await((n=t.handleRetrieverError)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${a}`),t.raiseError)throw e}},t.awaitHandlers)))}}class I_ extends Yc{async handleLLMNewToken(e,t,n,a,o,l){await Promise.all(this.handlers.map(c=>yt(async()=>{var d;if(!c.ignoreLLM)try{await((d=c.handleLLMNewToken)==null?void 0:d.call(c,e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,l))}catch(f){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleLLMNewToken: ${f}`),c.raiseError)throw f}},c.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(t=>yt(async()=>{var n;if(!t.ignoreLLM)try{await((n=t.handleLLMError)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleLLMError: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(t=>yt(async()=>{var n;if(!t.ignoreLLM)try{await((n=t.handleLLMEnd)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleLLMEnd: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}}class ST extends Yc{getChild(e){const t=new pn(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,n,a,o){await Promise.all(this.handlers.map(l=>yt(async()=>{var c;if(!l.ignoreChain)try{await((c=l.handleChainError)==null?void 0:c.call(l,e,this.runId,this._parentRunId,this.tags,o))}catch(d){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainError: ${d}`),l.raiseError)throw d}},l.awaitHandlers)))}async handleChainEnd(e,t,n,a,o){await Promise.all(this.handlers.map(l=>yt(async()=>{var c;if(!l.ignoreChain)try{await((c=l.handleChainEnd)==null?void 0:c.call(l,e,this.runId,this._parentRunId,this.tags,o))}catch(d){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainEnd: ${d}`),l.raiseError)throw d}},l.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>yt(async()=>{var n;if(!t.ignoreAgent)try{await((n=t.handleAgentAction)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>yt(async()=>{var n;if(!t.ignoreAgent)try{await((n=t.handleAgentEnd)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}}class ET extends Yc{getChild(e){const t=new pn(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>yt(async()=>{var n;if(!t.ignoreAgent)try{await((n=t.handleToolError)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>yt(async()=>{var n;if(!t.ignoreAgent)try{await((n=t.handleToolEnd)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${a}`),t.raiseError)throw a}},t.awaitHandlers)))}}class pn extends bT{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(t==null?void 0:t.handlers)??this.handlers,this.inheritableHandlers=(t==null?void 0:t.inheritableHandlers)??this.inheritableHandlers,this.tags=(t==null?void 0:t.tags)??this.tags,this.inheritableTags=(t==null?void 0:t.inheritableTags)??this.inheritableTags,this.metadata=(t==null?void 0:t.metadata)??this.metadata,this.inheritableMetadata=(t==null?void 0:t.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,n=void 0,a=void 0,o=void 0,l=void 0,c=void 0,d=void 0){return Promise.all(t.map(async(f,p)=>{const y=p===0&&n?n:fn();return await Promise.all(this.handlers.map(g=>{if(!g.ignoreLLM)return uo(g)&&g._createRunForLLMStart(e,[f],y,this._parentRunId,o,this.tags,this.metadata,d),yt(async()=>{var w;try{await((w=g.handleLLMStart)==null?void 0:w.call(g,e,[f],y,this._parentRunId,o,this.tags,this.metadata,d))}catch(_){if((g.raiseError?console.error:console.warn)(`Error in handler ${g.constructor.name}, handleLLMStart: ${_}`),g.raiseError)throw _}},g.awaitHandlers)})),new I_(y,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,n=void 0,a=void 0,o=void 0,l=void 0,c=void 0,d=void 0){return Promise.all(t.map(async(f,p)=>{const y=p===0&&n?n:fn();return await Promise.all(this.handlers.map(g=>{if(!g.ignoreLLM)return uo(g)&&g._createRunForChatModelStart(e,[f],y,this._parentRunId,o,this.tags,this.metadata,d),yt(async()=>{var w,_;try{if(g.handleChatModelStart)await((w=g.handleChatModelStart)==null?void 0:w.call(g,e,[f],y,this._parentRunId,o,this.tags,this.metadata,d));else if(g.handleLLMStart){const S=Q0(f);await((_=g.handleLLMStart)==null?void 0:_.call(g,e,[S],y,this._parentRunId,o,this.tags,this.metadata,d))}}catch(S){if((g.raiseError?console.error:console.warn)(`Error in handler ${g.constructor.name}, handleLLMStart: ${S}`),g.raiseError)throw S}},g.awaitHandlers)})),new I_(y,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,n=fn(),a=void 0,o=void 0,l=void 0,c=void 0){return await Promise.all(this.handlers.map(d=>{if(!d.ignoreChain)return uo(d)&&d._createRunForChainStart(e,t,n,this._parentRunId,this.tags,this.metadata,a,c),yt(async()=>{var f;try{await((f=d.handleChainStart)==null?void 0:f.call(d,e,t,n,this._parentRunId,this.tags,this.metadata,a,c))}catch(p){if((d.raiseError?console.error:console.warn)(`Error in handler ${d.constructor.name}, handleChainStart: ${p}`),d.raiseError)throw p}},d.awaitHandlers)})),new ST(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,n=fn(),a=void 0,o=void 0,l=void 0,c=void 0){return await Promise.all(this.handlers.map(d=>{if(!d.ignoreAgent)return uo(d)&&d._createRunForToolStart(e,t,n,this._parentRunId,this.tags,this.metadata,c),yt(async()=>{var f;try{await((f=d.handleToolStart)==null?void 0:f.call(d,e,t,n,this._parentRunId,this.tags,this.metadata,c))}catch(p){if((d.raiseError?console.error:console.warn)(`Error in handler ${d.constructor.name}, handleToolStart: ${p}`),d.raiseError)throw p}},d.awaitHandlers)})),new ET(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,n=fn(),a=void 0,o=void 0,l=void 0,c=void 0){return await Promise.all(this.handlers.map(d=>{if(!d.ignoreRetriever)return uo(d)&&d._createRunForRetrieverStart(e,t,n,this._parentRunId,this.tags,this.metadata,c),yt(async()=>{var f;try{await((f=d.handleRetrieverStart)==null?void 0:f.call(d,e,t,n,this._parentRunId,this.tags,this.metadata,c))}catch(p){if((d.raiseError?console.error:console.warn)(`Error in handler ${d.constructor.name}, handleRetrieverStart: ${p}`),d.raiseError)throw p}},d.awaitHandlers)})),new xT(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,n,a,o){await Promise.all(this.handlers.map(l=>yt(async()=>{var c;if(!l.ignoreCustomEvent)try{await((c=l.handleCustomEvent)==null?void 0:c.call(l,e,t,n,this.tags,this.metadata))}catch(d){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleCustomEvent: ${d}`),l.raiseError)throw d}},l.awaitHandlers)))}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const n of e)this.addHandler(n,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const n=new pn(this._parentRunId);for(const a of this.handlers){const o=this.inheritableHandlers.includes(a);n.addHandler(a,o)}for(const a of this.tags){const o=this.inheritableTags.includes(a);n.addTags([a],o)}for(const a of Object.keys(this.metadata)){const o=Object.keys(this.inheritableMetadata).includes(a);n.addMetadata({[a]:this.metadata[a]},o)}for(const a of e)n.handlers.filter(o=>o.name==="console_callback_handler").some(o=>o.name===a.name)||n.addHandler(a,t);return n}static fromHandlers(e){class t extends ll{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:fn()}),Object.assign(this,e)}}const n=new this;return n.addHandler(new t),n}static configure(e,t,n,a,o,l,c){return this._configureSync(e,t,n,a,o,l,c)}static _configureSync(e,t,n,a,o,l,c){var g,w;let d;(e||t)&&(Array.isArray(e)||!e?(d=new pn,d.setHandlers((e==null?void 0:e.map(Pc))??[],!0)):d=e,d=d.copy(Array.isArray(t)?t.map(Pc):t==null?void 0:t.handlers,!1));const f=zt("LANGCHAIN_VERBOSE")==="true"||(c==null?void 0:c.verbose),p=((g=Ro.getTraceableRunTree())==null?void 0:g.tracingEnabled)||_T(),y=p||(zt("LANGCHAIN_TRACING")??!1);if(f||y){if(d||(d=new pn),f&&!d.handlers.some(_=>_.name===A_.prototype.name)){const _=new A_;d.addHandler(_,!0)}if(y&&!d.handlers.some(_=>_.name==="langchain_tracer")&&p){const _=new Ro;d.addHandler(_,!0),d._parentRunId=((w=Ro.getTraceableRunTree())==null?void 0:w.id)??d._parentRunId}}return(n||a)&&d&&(d.addTags(n??[]),d.addTags(a??[],!1)),(o||l)&&d&&(d.addMetadata(o??{}),d.addMetadata(l??{},!1)),d}}function Pc(r){return"name"in r?r:ll.fromMethods(r)}class kT{getStore(){}run(e,t){return t()}enterWith(e){}}const CT=new kT,N_=Symbol.for("lc:child_config"),dp=Symbol.for("lc:context_variables");class PT{getInstance(){return qs()??CT}getRunnableConfig(){var t,n;return(n=(t=this.getInstance().getStore())==null?void 0:t.extra)==null?void 0:n[N_]}runWithConfig(e,t,n){var p;const a=pn._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),o=this.getInstance(),l=o.getStore(),c=a==null?void 0:a.getParentRunId(),d=(p=a==null?void 0:a.handlers)==null?void 0:p.find(y=>(y==null?void 0:y.name)==="langchain_tracer");let f;return d&&c?f=d.convertToRunTree(c):n||(f=new cn({name:"<runnable_lambda>",tracingEnabled:!1})),f&&(f.extra={...f.extra,[N_]:e}),l!==void 0&&l[dp]!==void 0&&(f[dp]=l[dp]),o.run(f,t)}initializeGlobalInstance(e){qs()===void 0&&pT(e)}}const Qa=new PT;async function _a(r,e){if(e===void 0)return r;let t;return Promise.race([r.catch(n=>{if(!(e!=null&&e.aborted))throw n}),new Promise((n,a)=>{t=()=>{a(new Error("Aborted"))},e.addEventListener("abort",t),e.aborted&&a(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",t))}class mn extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const t=this.reader.cancel();this.reader.releaseLock(),await t}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const t=e.getReader();return new mn({start(n){return a();function a(){return t.read().then(({done:o,value:l})=>{if(o){n.close();return}return n.enqueue(l),a()})}},cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new mn({async pull(t){const{value:n,done:a}=await e.next();a&&t.close(),t.enqueue(n)},async cancel(t){await e.return(t)}})}}function Sx(r,e=2){const t=Array.from({length:e},()=>[]);return t.map(async function*(a){for(;;)if(a.length===0){const o=await r.next();for(const l of t)l.push(o)}else{if(a[0].done)return;yield a.shift().value}})}function Wn(r,e){if(Array.isArray(r)&&Array.isArray(e))return r.concat(e);if(typeof r=="string"&&typeof e=="string")return r+e;if(typeof r=="number"&&typeof e=="number")return r+e;if("concat"in r&&typeof r.concat=="function")return r.concat(e);if(typeof r=="object"&&typeof e=="object"){const t={...r};for(const[n,a]of Object.entries(e))n in t&&!Array.isArray(t[n])?t[n]=Wn(t[n],a):t[n]=a;return t}else throw new Error(`Cannot concat ${typeof r} and ${typeof e}`)}class mi{constructor(e){var t;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((t=this.config)==null?void 0:t.signal),this.setup=new Promise((n,a)=>{Qa.runWithConfig(e.config,async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(n,a):this.firstResult.then(o=>n(void 0),a)},!0)})}async next(...e){var t;return(t=this.signal)==null||t.throwIfAborted(),this.firstResultUsed?Qa.runWithConfig(this.config,this.signal?async()=>_a(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function RT(r,e,t,n,...a){const o=new mi({generator:e,startSetup:t,signal:n}),l=await o.setup;return{output:r(o,l,...a),setup:l}}class ca{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const t=this.ops.concat(e.ops),n=kc({},t);return new Jo({ops:t,state:n[n.length-1].newDocument})}}class Jo extends ca{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const t=this.ops.concat(e.ops),n=kc(this.state,e.ops);return new Jo({ops:t,state:n[n.length-1].newDocument})}static fromRunLogPatch(e){const t=kc({},e.ops);return new Jo({ops:e.ops,state:t[t.length-1].newDocument})}}const Ex=r=>r.name==="log_stream_tracer";async function $_(r,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:t}=r;if(["retriever","llm","prompt"].includes(r.run_type))return t;if(!(Object.keys(t).length===1&&(t==null?void 0:t.input)===""))return t.input}async function j_(r,e){const{outputs:t}=r;return e==="original"||["retriever","llm","prompt"].includes(r.run_type)?t:t!==void 0&&Object.keys(t).length===1&&(t==null?void 0:t.output)!==void 0?t.output:t}function OT(r){return r!==void 0&&r.message!==void 0}class L_ extends ul{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=mn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const t=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(n=n||t.find(a=>{var o;return(o=this.includeTags)==null?void 0:o.includes(a)})!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(n=n&&t.every(a=>{var o;return!((o=this.excludeTags)!=null&&o.includes(a))})),n}async*tapOutputIterable(e,t){for await(const n of t){if(e!==this.rootId){const a=this.keyMapByRunId[e];a&&await this.writer.write(new ca({ops:[{op:"add",path:`/logs/${a}/streamed_output/-`,value:n}]}))}yield n}}async onRunCreate(e){var a;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new ca({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=t===1?e.name:`${e.name}:${t}`;const n={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(n.inputs=await $_(e,this._schemaFormat)),await this.writer.write(new ca({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:n}]}))}async onRunUpdate(e){try{const t=this.keyMapByRunId[e.id];if(t===void 0)return;const n=[];this._schemaFormat==="streaming_events"&&n.push({op:"replace",path:`/logs/${t}/inputs`,value:await $_(e,this._schemaFormat)}),n.push({op:"add",path:`/logs/${t}/final_output`,value:await j_(e,this._schemaFormat)}),e.end_time!==void 0&&n.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});const a=new ca({ops:n});await this.writer.write(a)}finally{if(e.id===this.rootId){const t=new ca({ops:[{op:"replace",path:"/final_output",value:await j_(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,n){const a=this.keyMapByRunId[e.id];if(a===void 0)return;const o=e.inputs.messages!==void 0;let l;o?OT(n==null?void 0:n.chunk)?l=n==null?void 0:n.chunk:l=new rs({id:`run-${e.id}`,content:t}):l=t;const c=new ca({ops:[{op:"add",path:`/logs/${a}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${a}/streamed_output/-`,value:l}]});await this.writer.write(c)}}const M_="__run";class ri{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new ri({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class ai extends ri{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new ai({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function Hu({name:r,serialized:e}){return r!==void 0?r:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const kx=r=>r.name==="event_stream_tracer";class TT extends ul{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=mn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const t=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(n=n||t.find(a=>{var o;return(o=this.includeTags)==null?void 0:o.includes(a)})!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(n=n&&t.every(a=>{var o;return!((o=this.excludeTags)!=null&&o.includes(a))})),n}async*tapOutputIterable(e,t){const n=await t.next();if(n.done)return;const a=this.runInfoMap.get(e);if(a===void 0){yield n.value;return}function o(c,d){return c==="llm"&&typeof d=="string"?new ri({text:d}):d}let l=this.tappedPromises.get(e);if(l===void 0){let c;l=new Promise(d=>{c=d}),this.tappedPromises.set(e,l);try{const d={event:`on_${a.runType}_stream`,run_id:e,name:a.name,tags:a.tags,metadata:a.metadata,data:{}};await this.send({...d,data:{chunk:o(a.runType,n.value)}},a),yield n.value;for await(const f of t)a.runType!=="tool"&&a.runType!=="retriever"&&await this.send({...d,data:{chunk:o(a.runType,f)}},a),yield f}finally{c()}}else{yield n.value;for await(const c of t)yield c}}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){const n=this.tappedPromises.get(e.run_id);n!==void 0?n.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){var l,c;const t=Hu(e),n=e.inputs.messages!==void 0?"chat_model":"llm",a={tags:e.tags??[],metadata:((l=e.extra)==null?void 0:l.metadata)??{},name:t,runType:n,inputs:e.inputs};this.runInfoMap.set(e.id,a);const o=`on_${n}_start`;await this.send({event:o,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:((c=e.extra)==null?void 0:c.metadata)??{}},a)}async onLLMNewToken(e,t,n){const a=this.runInfoMap.get(e.id);let o,l;if(a===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(a.runType==="chat_model")l="on_chat_model_stream",(n==null?void 0:n.chunk)===void 0?o=new rs({content:t,id:`run-${e.id}`}):o=n.chunk.message;else if(a.runType==="llm")l="on_llm_stream",(n==null?void 0:n.chunk)===void 0?o=new ri({text:t}):o=n.chunk;else throw new Error(`Unexpected run type ${a.runType}`);await this.send({event:l,data:{chunk:o},run_id:e.id,name:a.name,tags:a.tags,metadata:a.metadata},a)}}async onLLMEnd(e){var l,c,d;const t=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let n;if(t===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const a=(l=e.outputs)==null?void 0:l.generations;let o;if(t.runType==="chat_model"){for(const f of a??[]){if(o!==void 0)break;o=(c=f[0])==null?void 0:c.message}n="on_chat_model_end"}else if(t.runType==="llm")o={generations:a==null?void 0:a.map(f=>f.map(p=>({text:p.text,generationInfo:p.generationInfo}))),llmOutput:((d=e.outputs)==null?void 0:d.llmOutput)??{}},n="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);await this.sendEndEvent({event:n,data:{output:o,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){var l,c;const t=Hu(e),n=e.run_type??"chain",a={tags:e.tags??[],metadata:((l=e.extra)==null?void 0:l.metadata)??{},name:t,runType:e.run_type};let o={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(o={},a.inputs={}):e.inputs.input!==void 0?(o.input=e.inputs.input,a.inputs=e.inputs.input):(o.input=e.inputs,a.inputs=e.inputs),this.runInfoMap.set(e.id,a),await this.send({event:`on_${n}_start`,data:o,name:t,tags:e.tags??[],run_id:e.id,metadata:((c=e.extra)==null?void 0:c.metadata)??{}},a)}async onChainEnd(e){var c;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const n=`on_${e.run_type}_end`,a=e.inputs??t.inputs??{},l={output:((c=e.outputs)==null?void 0:c.output)??e.outputs,input:a};a.input&&Object.keys(a).length===1&&(l.input=a.input,t.inputs=a.input),await this.sendEndEvent({event:n,data:l,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){var a,o;const t=Hu(e),n={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,n),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{}},n)}async onToolEnd(e){var a;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const n=((a=e.outputs)==null?void 0:a.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:n,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){var o,l;const t=Hu(e),a={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,a),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:((l=e.extra)==null?void 0:l.metadata)??{}},a)}async onRetrieverEnd(e){var n;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((n=e.outputs)==null?void 0:n.documents)??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,n){const a=this.runInfoMap.get(n);if(a===void 0)throw new Error(`handleCustomEvent: Run ID ${n} not found in run map.`);await this.send({event:"on_custom_event",run_id:n,name:e,tags:a.tags,metadata:a.metadata,data:t},a)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const fp=25;async function Zn(r){return pn._configureSync(r==null?void 0:r.callbacks,void 0,r==null?void 0:r.tags,void 0,r==null?void 0:r.metadata)}function D_(...r){const e={};for(const t of r.filter(n=>!!n))for(const n of Object.keys(t))if(n==="metadata")e[n]={...e[n],...t[n]};else if(n==="tags"){const a=e[n]??[];e[n]=[...new Set(a.concat(t[n]??[]))]}else if(n==="configurable")e[n]={...e[n],...t[n]};else if(n==="timeout")e.timeout===void 0?e.timeout=t.timeout:t.timeout!==void 0&&(e.timeout=Math.min(e.timeout,t.timeout));else if(n==="signal")e.signal===void 0?e.signal=t.signal:t.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,t.signal]):e.signal=t.signal);else if(n==="callbacks"){const a=e.callbacks,o=t.callbacks;if(Array.isArray(o))if(!a)e.callbacks=o;else if(Array.isArray(a))e.callbacks=a.concat(o);else{const l=a.copy();for(const c of o)l.addHandler(Pc(c),!0);e.callbacks=l}else if(o)if(!a)e.callbacks=o;else if(Array.isArray(a)){const l=o.copy();for(const c of a)l.addHandler(Pc(c),!0);e.callbacks=l}else e.callbacks=new pn(o._parentRunId,{handlers:a.handlers.concat(o.handlers),inheritableHandlers:a.inheritableHandlers.concat(o.inheritableHandlers),tags:Array.from(new Set(a.tags.concat(o.tags))),inheritableTags:Array.from(new Set(a.inheritableTags.concat(o.inheritableTags))),metadata:{...a.metadata,...o.metadata}})}else{const a=n;e[a]=t[a]??e[a]}return e}const AT=new Set(["string","number","boolean"]);function Ve(r){var n;const e=Qa.getRunnableConfig();let t={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:a,runName:o,...l}=e;t=Object.entries(l).reduce((c,[d,f])=>(f!==void 0&&(c[d]=f),c),t)}if(r&&(t=Object.entries(r).reduce((a,[o,l])=>(l!==void 0&&(a[o]=l),a),t)),t!=null&&t.configurable)for(const a of Object.keys(t.configurable))AT.has(typeof t.configurable[a])&&!((n=t.metadata)!=null&&n[a])&&(t.metadata||(t.metadata={}),t.metadata[a]=t.configurable[a]);if(t.timeout!==void 0){if(t.timeout<=0)throw new Error("Timeout must be a positive number");const a=AbortSignal.timeout(t.timeout);t.signal!==void 0?"any"in AbortSignal&&(t.signal=AbortSignal.any([t.signal,a])):t.signal=a,delete t.timeout}return t}function jt(r={},{callbacks:e,maxConcurrency:t,recursionLimit:n,runName:a,configurable:o,runId:l}={}){const c=Ve(r);return e!==void 0&&(delete c.runName,c.callbacks=e),n!==void 0&&(c.recursionLimit=n),t!==void 0&&(c.maxConcurrency=t),a!==void 0&&(c.runName=a),o!==void 0&&(c.configurable={...c.configurable,...o}),l!==void 0&&delete c.runId,c}const IT=[400,401,402,403,404,405,406,407,409],NT=r=>{var t,n;if(r.message.startsWith("Cancel")||r.message.startsWith("AbortError")||r.name==="AbortError"||(r==null?void 0:r.code)==="ECONNABORTED")throw r;const e=((t=r==null?void 0:r.response)==null?void 0:t.status)??(r==null?void 0:r.status);if(e&&IT.includes(+e))throw r;if(((n=r==null?void 0:r.error)==null?void 0:n.code)==="insufficient_quota"){const a=new Error(r==null?void 0:r.message);throw a.name="InsufficientQuotaError",a}};class qm{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??NT;const t="default"in $r?$r.default:$r;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>xc(()=>e(...t).catch(n=>{throw n instanceof Error?n:new Error(n)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...n){return e.signal?Promise.race([this.call(t,...n),new Promise((a,o)=>{var l;(l=e.signal)==null||l.addEventListener("abort",()=>{o(new Error("AbortError"))})})]):this.call(t,...n)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}class Cx extends ul{constructor({config:e,onStart:t,onEnd:n,onError:a}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=n,this.argOnError=a}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function Wm(r){return r?r.lc_runnable:!1}class $T{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let n=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const a=e.tags??[];return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(t)),this.includeTags!==void 0&&(n=n||a.some(o=>{var l;return(l=this.includeTags)==null?void 0:l.includes(o)})),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(t)),this.excludeTags!==void 0&&(n=n&&a.every(o=>{var l;return!((l=this.excludeTags)!=null&&l.includes(o))})),n}}const jT=Symbol("Let zodToJsonSchema decide on which parser to use"),LT={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},MT=r=>({...LT,...r}),DT=r=>{const e=MT(r),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,a])=>[a._def,{def:a._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Px(r,e,t,n){n!=null&&n.errorMessages&&t&&(r.errorMessage={...r.errorMessage,[e]:t})}function We(r,e,t,n,a){r[e]=t,Px(r,e,n,a)}function FT(){return{}}function UT(r,e){var n,a,o;const t={type:"array"};return(n=r.type)!=null&&n._def&&((o=(a=r.type)==null?void 0:a._def)==null?void 0:o.typeName)!==H.ZodAny&&(t.items=He(r.type._def,{...e,currentPath:[...e.currentPath,"items"]})),r.minLength&&We(t,"minItems",r.minLength.value,r.minLength.message,e),r.maxLength&&We(t,"maxItems",r.maxLength.value,r.maxLength.message,e),r.exactLength&&(We(t,"minItems",r.exactLength.value,r.exactLength.message,e),We(t,"maxItems",r.exactLength.value,r.exactLength.message,e)),t}function zT(r,e){const t={type:"integer",format:"int64"};if(!r.checks)return t;for(const n of r.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?We(t,"minimum",n.value,n.message,e):We(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),We(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?We(t,"maximum",n.value,n.message,e):We(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),We(t,"maximum",n.value,n.message,e));break;case"multipleOf":We(t,"multipleOf",n.value,n.message,e);break}return t}function BT(){return{type:"boolean"}}function Rx(r,e){return He(r.type._def,e)}const HT=(r,e)=>He(r.innerType._def,e);function Ox(r,e,t){const n=t??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((a,o)=>Ox(r,e,a))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return VT(r,e)}}const VT=(r,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const n of r.checks)switch(n.kind){case"min":We(t,"minimum",n.value,n.message,e);break;case"max":We(t,"maximum",n.value,n.message,e);break}return t};function qT(r,e){return{...He(r.innerType._def,e),default:r.defaultValue()}}function WT(r,e){return e.effectStrategy==="input"?He(r.schema._def,e):{}}function ZT(r){return{type:"string",enum:r.values}}const GT=r=>"type"in r&&r.type==="string"?!1:"allOf"in r;function JT(r,e){const t=[He(r.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),He(r.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(o=>!!o);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return t.forEach(o=>{if(GT(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(n=void 0);else{let l=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:c,...d}=o;l=d}else n=void 0;a.push(l)}}),a.length?{allOf:a,...n}:void 0}function KT(r,e){const t=typeof r.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(r.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[r.value]}:{type:t==="bigint"?"integer":t,const:r.value}}let hp;const Fa={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(hp===void 0&&(hp=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),hp),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function Tx(r,e){const t={type:"string"};function n(a){return e.patternStrategy==="escape"?XT(a):a}if(r.checks)for(const a of r.checks)switch(a.kind){case"min":We(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,a.value):a.value,a.message,e);break;case"max":We(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,a.value):a.value,a.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Ln(t,"email",a.message,e);break;case"format:idn-email":Ln(t,"idn-email",a.message,e);break;case"pattern:zod":Mn(t,Fa.email,a.message,e);break}break;case"url":Ln(t,"uri",a.message,e);break;case"uuid":Ln(t,"uuid",a.message,e);break;case"regex":Mn(t,a.regex,a.message,e);break;case"cuid":Mn(t,Fa.cuid,a.message,e);break;case"cuid2":Mn(t,Fa.cuid2,a.message,e);break;case"startsWith":Mn(t,RegExp(`^${n(a.value)}`),a.message,e);break;case"endsWith":Mn(t,RegExp(`${n(a.value)}$`),a.message,e);break;case"datetime":Ln(t,"date-time",a.message,e);break;case"date":Ln(t,"date",a.message,e);break;case"time":Ln(t,"time",a.message,e);break;case"duration":Ln(t,"duration",a.message,e);break;case"length":We(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,a.value):a.value,a.message,e),We(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,a.value):a.value,a.message,e);break;case"includes":{Mn(t,RegExp(n(a.value)),a.message,e);break}case"ip":{a.version!=="v6"&&Ln(t,"ipv4",a.message,e),a.version!=="v4"&&Ln(t,"ipv6",a.message,e);break}case"emoji":Mn(t,Fa.emoji,a.message,e);break;case"ulid":{Mn(t,Fa.ulid,a.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Ln(t,"binary",a.message,e);break}case"contentEncoding:base64":{We(t,"contentEncoding","base64",a.message,e);break}case"pattern:zod":{Mn(t,Fa.base64,a.message,e);break}}break}case"nanoid":Mn(t,Fa.nanoid,a.message,e)}return t}const XT=r=>Array.from(r).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Ln=(r,e,t,n)=>{var a;r.format||(a=r.anyOf)!=null&&a.some(o=>o.format)?(r.anyOf||(r.anyOf=[]),r.format&&(r.anyOf.push({format:r.format,...r.errorMessage&&n.errorMessages&&{errorMessage:{format:r.errorMessage.format}}}),delete r.format,r.errorMessage&&(delete r.errorMessage.format,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.anyOf.push({format:e,...t&&n.errorMessages&&{errorMessage:{format:t}}})):We(r,"format",e,t,n)},Mn=(r,e,t,n)=>{var a;r.pattern||(a=r.allOf)!=null&&a.some(o=>o.pattern)?(r.allOf||(r.allOf=[]),r.pattern&&(r.allOf.push({pattern:r.pattern,...r.errorMessage&&n.errorMessages&&{errorMessage:{pattern:r.errorMessage.pattern}}}),delete r.pattern,r.errorMessage&&(delete r.errorMessage.pattern,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.allOf.push({pattern:F_(e,n),...t&&n.errorMessages&&{errorMessage:{pattern:t}}})):We(r,"pattern",F_(e,n),t,n)},F_=(r,e)=>{var f;const t=typeof r=="function"?r():r;if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},a=n.i?t.source.toLowerCase():t.source;let o="",l=!1,c=!1,d=!1;for(let p=0;p<a.length;p++){if(l){o+=a[p],l=!1;continue}if(n.i){if(c){if(a[p].match(/[a-z]/)){d?(o+=a[p],o+=`${a[p-2]}-${a[p]}`.toUpperCase(),d=!1):a[p+1]==="-"&&((f=a[p+2])!=null&&f.match(/[a-z]/))?(o+=a[p],d=!0):o+=`${a[p]}${a[p].toUpperCase()}`;continue}}else if(a[p].match(/[a-z]/)){o+=`[${a[p]}${a[p].toUpperCase()}]`;continue}}if(n.m){if(a[p]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[p]==="$"){o+=`($|(?=[\r
]))`;continue}}if(n.s&&a[p]==="."){o+=c?`${a[p]}\r
`:`[${a[p]}\r
]`;continue}o+=a[p],a[p]==="\\"?l=!0:c&&a[p]==="]"?c=!1:!c&&a[p]==="["&&(c=!0)}try{const p=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return o};function Ax(r,e){var n,a,o,l,c,d;if(e.target==="openApi3"&&((n=r.keyType)==null?void 0:n._def.typeName)===H.ZodEnum)return{type:"object",required:r.keyType._def.values,properties:r.keyType._def.values.reduce((f,p)=>({...f,[p]:He(r.valueType._def,{...e,currentPath:[...e.currentPath,"properties",p]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:He(r.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((a=r.keyType)==null?void 0:a._def.typeName)===H.ZodString&&((o=r.keyType._def.checks)!=null&&o.length)){const{type:f,...p}=Tx(r.keyType._def,e);return{...t,propertyNames:p}}else{if(((l=r.keyType)==null?void 0:l._def.typeName)===H.ZodEnum)return{...t,propertyNames:{enum:r.keyType._def.values}};if(((c=r.keyType)==null?void 0:c._def.typeName)===H.ZodBranded&&r.keyType._def.type._def.typeName===H.ZodString&&((d=r.keyType._def.type._def.checks)!=null&&d.length)){const{type:f,...p}=Rx(r.keyType._def,e);return{...t,propertyNames:p}}}return t}function QT(r,e){if(e.mapStrategy==="record")return Ax(r,e);const t=He(r.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=He(r.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,n],minItems:2,maxItems:2}}}function YT(r){const e=r.values,n=Object.keys(r.values).filter(o=>typeof e[e[o]]!="number").map(o=>e[o]),a=Array.from(new Set(n.map(o=>typeof o)));return{type:a.length===1?a[0]==="string"?"string":"number":["string","number"],enum:n}}function eA(){return{not:{}}}function tA(r){return r.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Rc={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function nA(r,e){if(e.target==="openApi3")return U_(r,e);const t=r.options instanceof Map?Array.from(r.options.values()):r.options;if(t.every(n=>n._def.typeName in Rc&&(!n._def.checks||!n._def.checks.length))){const n=t.reduce((a,o)=>{const l=Rc[o._def.typeName];return l&&!a.includes(l)?[...a,l]:a},[]);return{type:n.length>1?n:n[0]}}else if(t.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=t.reduce((a,o)=>{const l=typeof o._def.value;switch(l){case"string":case"number":case"boolean":return[...a,l];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(n.length===t.length){const a=n.filter((o,l,c)=>c.indexOf(o)===l);return{type:a.length>1?a:a[0],enum:t.reduce((o,l)=>o.includes(l._def.value)?o:[...o,l._def.value],[])}}}else if(t.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((n,a)=>[...n,...a._def.values.filter(o=>!n.includes(o))],[])};return U_(r,e)}const U_=(r,e)=>{const t=(r.options instanceof Map?Array.from(r.options.values()):r.options).map((n,a)=>He(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${a}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return t.length?{anyOf:t}:void 0};function rA(r,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(r.innerType._def.typeName)&&(!r.innerType._def.checks||!r.innerType._def.checks.length))return e.target==="openApi3"?{type:Rc[r.innerType._def.typeName],nullable:!0}:{type:[Rc[r.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=He(r.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const t=He(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function aA(r,e){const t={type:"number"};if(!r.checks)return t;for(const n of r.checks)switch(n.kind){case"int":t.type="integer",Px(t,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?We(t,"minimum",n.value,n.message,e):We(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),We(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?We(t,"maximum",n.value,n.message,e):We(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),We(t,"maximum",n.value,n.message,e));break;case"multipleOf":We(t,"multipleOf",n.value,n.message,e);break}return t}function sA(r,e){return e.removeAdditionalStrategy==="strict"?r.catchall._def.typeName==="ZodNever"?r.unknownKeys!=="strict":He(r.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":He(r.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function iA(r,e){const t={type:"object",...Object.entries(r.shape()).reduce((n,[a,o])=>{if(o===void 0||o._def===void 0)return n;const l=He(o._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});return l===void 0?n:{properties:{...n.properties,[a]:l},required:o.isOptional()?n.required:[...n.required,a]}},{properties:{},required:[]}),additionalProperties:sA(r,e)};return t.required.length||delete t.required,t}const oA=(r,e)=>{var n;if(e.currentPath.toString()===((n=e.propertyPath)==null?void 0:n.toString()))return He(r.innerType._def,e);const t=He(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},lA=(r,e)=>{if(e.pipeStrategy==="input")return He(r.in._def,e);if(e.pipeStrategy==="output")return He(r.out._def,e);const t=He(r.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=He(r.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,n].filter(a=>a!==void 0)}};function uA(r,e){return He(r.type._def,e)}function cA(r,e){const n={type:"array",uniqueItems:!0,items:He(r.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return r.minSize&&We(n,"minItems",r.minSize.value,r.minSize.message,e),r.maxSize&&We(n,"maxItems",r.maxSize.value,r.maxSize.message,e),n}function dA(r,e){return r.rest?{type:"array",minItems:r.items.length,items:r.items.map((t,n)=>He(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[]),additionalItems:He(r.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:r.items.length,maxItems:r.items.length,items:r.items.map((t,n)=>He(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[])}}function fA(){return{not:{}}}function hA(){return{}}const pA=(r,e)=>He(r.innerType._def,e);function He(r,e,t=!1){var l;const n=e.seen.get(r);if(e.override){const c=(l=e.override)==null?void 0:l.call(e,r,e,n,t);if(c!==jT)return c}if(n&&!t){const c=mA(n,e);if(c!==void 0)return c}const a={def:r,path:e.currentPath,jsonSchema:void 0};e.seen.set(r,a);const o=yA(r,r.typeName,e);return o&&vA(r,e,o),a.jsonSchema=o,o}const mA=(r,e)=>{switch(e.$refStrategy){case"root":return{$ref:r.path.join("/")};case"relative":return{$ref:gA(e.currentPath,r.path)};case"none":case"seen":return r.path.length<e.currentPath.length&&r.path.every((t,n)=>e.currentPath[n]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},gA=(r,e)=>{let t=0;for(;t<r.length&&t<e.length&&r[t]===e[t];t++);return[(r.length-t).toString(),...e.slice(t)].join("/")},yA=(r,e,t)=>{switch(e){case H.ZodString:return Tx(r,t);case H.ZodNumber:return aA(r,t);case H.ZodObject:return iA(r,t);case H.ZodBigInt:return zT(r,t);case H.ZodBoolean:return BT();case H.ZodDate:return Ox(r,t);case H.ZodUndefined:return fA();case H.ZodNull:return tA(t);case H.ZodArray:return UT(r,t);case H.ZodUnion:case H.ZodDiscriminatedUnion:return nA(r,t);case H.ZodIntersection:return JT(r,t);case H.ZodTuple:return dA(r,t);case H.ZodRecord:return Ax(r,t);case H.ZodLiteral:return KT(r,t);case H.ZodEnum:return ZT(r);case H.ZodNativeEnum:return YT(r);case H.ZodNullable:return rA(r,t);case H.ZodOptional:return oA(r,t);case H.ZodMap:return QT(r,t);case H.ZodSet:return cA(r,t);case H.ZodLazy:return He(r.getter()._def,t);case H.ZodPromise:return uA(r,t);case H.ZodNaN:case H.ZodNever:return eA();case H.ZodEffects:return WT(r,t);case H.ZodAny:return FT();case H.ZodUnknown:return hA();case H.ZodDefault:return qT(r,t);case H.ZodBranded:return Rx(r,t);case H.ZodReadonly:return pA(r,t);case H.ZodCatch:return HT(r,t);case H.ZodPipeline:return lA(r,t);case H.ZodFunction:case H.ZodVoid:case H.ZodSymbol:return;default:return(n=>{})()}},vA=(r,e,t)=>(r.description&&(t.description=r.description,e.markdownDescription&&(t.markdownDescription=r.description)),t),cl=(r,e)=>{const t=DT(e),n=void 0,a=e==null?void 0:e.name,o=He(r._def,t,!1)??{},l=a===void 0?n?{...o,[t.definitionPath]:n}:o:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,a].join("/"),[t.definitionPath]:{...n,[a]:o}};return t.target==="jsonSchema7"?l.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),l};function pp(r){return r.replace(/[^a-zA-Z-_0-9]/g,"_")}const wA=["*","_","`"];function _A(r){let e="";for(const[t,n]of Object.entries(r))e+=`	classDef ${t} ${n};
`;return e}function bA(r,e,t){const{firstNode:n,lastNode:a,nodeColors:o,withStyles:l=!0,curveStyle:c="linear",wrapLabelNWords:d=9}=t??{};let f=l?`%%{init: {'flowchart': {'curve': '${c}'}}}%%
graph TD;
`:`graph TD;
`;if(l){const w="default",_={[w]:"{0}({1})"};n!==void 0&&(_[n]="{0}([{1}]):::first"),a!==void 0&&(_[a]="{0}([{1}]):::last");for(const[S,b]of Object.entries(r)){const k=b.name.split(":").pop()??"";let P=wA.some(j=>k.startsWith(j)&&k.endsWith(j))?`<p>${k}</p>`:k;Object.keys(b.metadata??{}).length&&(P+=`<hr/><small><em>${Object.entries(b.metadata??{}).map(([j,D])=>`${j} = ${D}`).join(`
`)}</em></small>`);const N=(_[S]??_[w]).replace("{0}",pp(S)).replace("{1}",P);f+=`	${N}
`}}const p={};for(const w of e){const _=w.source.split(":"),S=w.target.split(":"),b=_.filter((k,E)=>k===S[E]).join(":");p[b]||(p[b]=[]),p[b].push(w)}const y=new Set;function g(w,_){const S=w.length===1&&w[0].source===w[0].target;if(_&&!S){const b=_.split(":").pop();if(y.has(b))throw new Error(`Found duplicate subgraph '${b}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);y.add(b),f+=`	subgraph ${b}
`}for(const b of w){const{source:k,target:E,data:P,conditional:N}=b;let j="";if(P!==void 0){let D=P;const z=D.split(" ");z.length>d&&(D=Array.from({length:Math.ceil(z.length/d)},(q,K)=>z.slice(K*d,(K+1)*d).join(" ")).join("&nbsp;<br>&nbsp;")),j=N?` -. &nbsp;${D}&nbsp; .-> `:` -- &nbsp;${D}&nbsp; --> `}else j=N?" -.-> ":" --> ";f+=`	${pp(k)}${j}${pp(E)};
`}for(const b in p)b.startsWith(`${_}:`)&&b!==_&&g(p[b],b);_&&!S&&(f+=`	end
`)}g(p[""]??[],"");for(const w in p)!w.includes(":")&&w!==""&&g(p[w],w);return l&&(f+=_A(o??{})),f}async function xA(r,e){let{backgroundColor:t="white"}=e??{};const n=btoa(r);t!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(t)||(t=`!${t}`));const a=`https://mermaid.ink/img/${n}?bgColor=${t}`,o=await fetch(a);if(!o.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${o.status}`,`Status text: ${o.statusText}`].join(`
`));return await o.blob()}function SA(r,e){if(r!==void 0&&!ko(r))return r;if(Wm(e))try{let t=e.getName();return t=t.startsWith("Runnable")?t.slice(8):t,t}catch{return e.getName()}else return e.name??"UnknownSchema"}function EA(r){return Wm(r.data)?{type:"runnable",data:{id:r.data.lc_id,name:r.data.getName()}}:{type:"schema",data:{...cl(r.data.schema),title:r.data.name}}}class ed{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=(e==null?void 0:e.nodes)??this.nodes,this.edges=(e==null?void 0:e.edges)??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((t,n)=>{e[t.id]=ko(t.id)?n:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],...EA(t)})),edges:this.edges.map(t=>{const n={source:e[t.source],target:e[t.target]};return typeof t.data<"u"&&(n.data=t.data),typeof t.conditional<"u"&&(n.conditional=t.conditional),n})}}addNode(e,t,n){if(t!==void 0&&this.nodes[t]!==void 0)throw new Error(`Node with id ${t} already exists`);const a=t??fn(),o={id:a,data:e,name:SA(t,e),metadata:n};return this.nodes[a]=o,o}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,n,a){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[t.id]===void 0)throw new Error(`Target node ${t.id} not in graph`);const o={source:e.id,target:t.id,data:n,conditional:a};return this.edges.push(o),o}firstNode(){return z_(this)}lastNode(){return B_(this)}extend(e,t=""){let n=t;Object.values(e.nodes).map(f=>f.id).every(ko)&&(n="");const o=f=>n?`${n}:${f}`:f;Object.entries(e.nodes).forEach(([f,p])=>{this.nodes[o(f)]={...p,id:o(f)}});const l=e.edges.map(f=>({...f,source:o(f.source),target:o(f.target)}));this.edges=[...this.edges,...l];const c=e.firstNode(),d=e.lastNode();return[c?{id:o(c.id),data:c.data}:void 0,d?{id:o(d.id),data:d.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&z_(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&B_(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(a=>[a.id,a.name])),t=new Map;Object.values(e).forEach(a=>{t.set(a,(t.get(a)||0)+1)});const n=a=>{const o=e[a];return ko(a)&&t.get(o)===1?o:a};return new ed({nodes:Object.fromEntries(Object.entries(this.nodes).map(([a,o])=>[n(a),{...o,id:n(a)}])),edges:this.edges.map(a=>({...a,source:n(a.source),target:n(a.target)}))})}drawMermaid(e){const{withStyles:t,curveStyle:n,nodeColors:a={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:o}=e??{},l=this.reid(),c=l.firstNode(),d=l.lastNode();return bA(l.nodes,l.edges,{firstNode:c==null?void 0:c.id,lastNode:d==null?void 0:d.id,withStyles:t,curveStyle:n,nodeColors:a,wrapLabelNWords:o})}async drawMermaidPng(e){const t=this.drawMermaid(e);return xA(t,{backgroundColor:e==null?void 0:e.backgroundColor})}}function z_(r,e=[]){const t=new Set(r.edges.filter(a=>!e.includes(a.source)).map(a=>a.target)),n=[];for(const a of Object.values(r.nodes))!e.includes(a.id)&&!t.has(a.id)&&n.push(a);return n.length===1?n[0]:void 0}function B_(r,e=[]){const t=new Set(r.edges.filter(a=>!e.includes(a.target)).map(a=>a.source)),n=[];for(const a of Object.values(r.nodes))!e.includes(a.id)&&!t.has(a.id)&&n.push(a);return n.length===1?n[0]:void 0}function kA(r){const e=new TextEncoder,t=new ReadableStream({async start(n){for await(const a of r)n.enqueue(e.encode(`event: data
data: ${JSON.stringify(a)}

`));n.enqueue(e.encode(`event: end

`)),n.close()}});return mn.fromReadableStream(t)}function H_(r){return typeof r=="object"&&r!==null&&typeof r[Symbol.iterator]=="function"&&typeof r.next=="function"}const CA=r=>r!=null&&typeof r=="object"&&"next"in r&&typeof r.next=="function";function Wp(r){return typeof r=="object"&&r!==null&&typeof r[Symbol.asyncIterator]=="function"}function*V_(r,e){for(;;){const{value:t,done:n}=Qa.runWithConfig(r,e.next.bind(e),!0);if(n)break;yield t}}async function*q_(r,e){const t=e[Symbol.asyncIterator]();for(;;){const{value:n,done:a}=await Qa.runWithConfig(r,t.next.bind(e),!0);if(a)break;yield n}}function St(r,e){return r&&!Array.isArray(r)&&!(r instanceof Date)&&typeof r=="object"?r:{[e]:r}}class Et extends Ja{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new Za({bound:this,kwargs:e,config:{}})}map(){return new Oc({bound:this})}withRetry(e){return new PA({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new Za({bound:this,config:e,kwargs:{}})}withFallbacks(e){const t=Array.isArray(e)?e:e.fallbacks;return new OA({runnable:this,fallbacks:t})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(Ve);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const n=Object.fromEntries(Object.entries(e).filter(([a])=>a!=="runId"));return Array.from({length:t},(a,o)=>Ve(o===0?e:n))}return Array.from({length:t},()=>Ve(e))}async batch(e,t,n){var d;const a=this._getOptionsList(t??{},e.length),o=((d=a[0])==null?void 0:d.maxConcurrency)??(n==null?void 0:n.maxConcurrency),l=new qm({maxConcurrency:o,onFailedAttempt:f=>{throw f}}),c=e.map((f,p)=>l.call(async()=>{try{return await this.invoke(f,a[p])}catch(y){if(n!=null&&n.returnExceptions)return y;throw y}}));return Promise.all(c)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){const n=Ve(t),a=new mi({generator:this._streamIterator(e,n),config:n});return await a.setup,mn.fromAsyncGenerator(a)}_separateRunnableConfigFromCallOptions(e){let t;e===void 0?t=Ve(e):t=Ve({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const n={...e};return delete n.callbacks,delete n.tags,delete n.metadata,delete n.runName,delete n.configurable,delete n.recursionLimit,delete n.maxConcurrency,delete n.runId,delete n.timeout,delete n.signal,[t,n]}async _callWithConfig(e,t,n){const a=Ve(n),o=await Zn(a),l=await(o==null?void 0:o.handleChainStart(this.toJSON(),St(t,"input"),a.runId,a==null?void 0:a.runType,void 0,void 0,(a==null?void 0:a.runName)??this.getName()));delete a.runId;let c;try{const d=e.call(this,t,a,l);c=await _a(d,n==null?void 0:n.signal)}catch(d){throw await(l==null?void 0:l.handleChainError(d)),d}return await(l==null?void 0:l.handleChainEnd(St(c,"output"))),c}async _batchWithConfig(e,t,n,a){var f;const o=this._getOptionsList(n??{},t.length),l=await Promise.all(o.map(Zn)),c=await Promise.all(l.map(async(p,y)=>{const g=await(p==null?void 0:p.handleChainStart(this.toJSON(),St(t[y],"input"),o[y].runId,o[y].runType,void 0,void 0,o[y].runName??this.getName()));return delete o[y].runId,g}));let d;try{const p=e.call(this,t,o,c,a);d=await _a(p,(f=o==null?void 0:o[0])==null?void 0:f.signal)}catch(p){throw await Promise.all(c.map(y=>y==null?void 0:y.handleChainError(p))),p}return await Promise.all(c.map(p=>p==null?void 0:p.handleChainEnd(St(d,"output")))),d}async*_transformStreamWithConfig(e,t,n){let a,o=!0,l,c=!0;const d=Ve(n),f=await Zn(d);async function*p(){for await(const g of e){if(o)if(a===void 0)a=g;else try{a=Wn(a,g)}catch{a=void 0,o=!1}yield g}}let y;try{const g=await RT(t.bind(this),p(),async()=>f==null?void 0:f.handleChainStart(this.toJSON(),{input:""},d.runId,d.runType,void 0,void 0,d.runName??this.getName()),n==null?void 0:n.signal,d);delete d.runId,y=g.setup;const w=y==null?void 0:y.handlers.find(kx);let _=g.output;w!==void 0&&y!==void 0&&(_=w.tapOutputIterable(y.runId,_));const S=y==null?void 0:y.handlers.find(Ex);S!==void 0&&y!==void 0&&(_=S.tapOutputIterable(y.runId,_));for await(const b of _)if(yield b,c)if(l===void 0)l=b;else try{l=Wn(l,b)}catch{l=void 0,c=!1}}catch(g){throw await(y==null?void 0:y.handleChainError(g,void 0,void 0,void 0,{inputs:St(a,"input")})),g}await(y==null?void 0:y.handleChainEnd(l??{},void 0,void 0,void 0,{inputs:St(a,"input")}))}getGraph(e){const t=new ed,n=t.addNode({name:`${this.getName()}Input`,schema:Wa.any()}),a=t.addNode(this),o=t.addNode({name:`${this.getName()}Output`,schema:Wa.any()});return t.addEdge(n,a),t.addEdge(a,o),t}pipe(e){return new Ar({first:this,last:Va(e)})}pick(e){return this.pipe(new TA(e))}assign(e){return this.pipe(new Ix(new gi({steps:e})))}async*transform(e,t){let n;for await(const a of e)n===void 0?n=a:n=Wn(n,a);yield*this._streamIterator(n,Ve(t))}async*streamLog(e,t,n){const a=new L_({...n,autoClose:!1,_schemaFormat:"original"}),o=Ve(t);yield*this._streamLog(e,a,o)}async*_streamLog(e,t,n){const{callbacks:a}=n;if(a===void 0)n.callbacks=[t];else if(Array.isArray(a))n.callbacks=a.concat([t]);else{const d=a.copy();d.addHandler(t,!0),n.callbacks=d}const o=this.stream(e,n);async function l(){try{const d=await o;for await(const f of d){const p=new ca({ops:[{op:"add",path:"/streamed_output/-",value:f}]});await t.writer.write(p)}}finally{await t.writer.close()}}const c=l();try{for await(const d of t)yield d}finally{await c}}streamEvents(e,t,n){let a;if(t.version==="v1")a=this._streamEventsV1(e,t,n);else if(t.version==="v2")a=this._streamEventsV2(e,t,n);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return t.encoding==="text/event-stream"?kA(a):mn.fromAsyncGenerator(a)}async*_streamEventsV2(e,t,n){var w;const a=new TT({...n,autoClose:!1}),o=Ve(t),l=o.runId??fn();o.runId=l;const c=o.callbacks;if(c===void 0)o.callbacks=[a];else if(Array.isArray(c))o.callbacks=c.concat(a);else{const _=c.copy();_.addHandler(a,!0),o.callbacks=_}const d=this;async function f(){try{const _=await d.stream(e,o),S=a.tapOutputIterable(l,_);for await(const b of S);}finally{await a.finish()}}const p=f();let y=!1,g;try{for await(const _ of a){if(!y){_.data.input=e,y=!0,g=_.run_id,yield _;continue}_.run_id===g&&_.event.endsWith("_end")&&(w=_.data)!=null&&w.input&&delete _.data.input,yield _}}finally{await p}}async*_streamEventsV1(e,t,n){let a,o=!1;const l=Ve(t),c=l.tags??[],d=l.metadata??{},f=l.runName??this.getName(),p=new L_({...n,autoClose:!1,_schemaFormat:"streaming_events"}),y=new $T({...n}),g=this._streamLog(e,p,l);for await(const _ of g){if(a?a=a.concat(_):a=Jo.fromRunLogPatch(_),a.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!o){o=!0;const E={...a.state},P={run_id:E.id,event:`on_${E.type}_start`,name:f,tags:c,metadata:d,data:{input:e}};y.includeEvent(P,E.type)&&(yield P)}const S=_.ops.filter(E=>E.path.startsWith("/logs/")).map(E=>E.path.split("/")[2]),b=[...new Set(S)];for(const E of b){let P,N={};const j=a.state.logs[E];if(j.end_time===void 0?j.streamed_output.length>0?P="stream":P="start":P="end",P==="start")j.inputs!==void 0&&(N.input=j.inputs);else if(P==="end")j.inputs!==void 0&&(N.input=j.inputs),N.output=j.final_output;else if(P==="stream"){const D=j.streamed_output.length;if(D!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${D} instead. Encountered in: "${j.name}"`);N={chunk:j.streamed_output[0]},j.streamed_output=[]}yield{event:`on_${j.type}_${P}`,name:j.name,run_id:j.id,tags:j.tags,metadata:j.metadata,data:N}}const{state:k}=a;if(k.streamed_output.length>0){const E=k.streamed_output.length;if(E!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${E} instead. Encountered in: "${k.name}"`);const P={chunk:k.streamed_output[0]};k.streamed_output=[];const N={event:`on_${k.type}_stream`,run_id:k.id,tags:c,metadata:d,name:f,data:P};y.includeEvent(N,k.type)&&(yield N)}}const w=a==null?void 0:a.state;if(w!==void 0){const _={event:`on_${w.type}_end`,name:f,run_id:w.id,tags:c,metadata:d,data:{output:w.final_output}};y.includeEvent(_,w.type)&&(yield _)}}static isRunnable(e){return Wm(e)}withListeners({onStart:e,onEnd:t,onError:n}){return new Za({bound:this,config:{},configFactories:[a=>({callbacks:[new Cx({config:a,onStart:e,onEnd:t,onError:n})]})]})}asTool(e){return AA(this,e)}}class Za extends Et{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const t=D_(this.config,...e);return D_(t,...this.configFactories?await Promise.all(this.configFactories.map(async n=>await n(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig(Ve(t),this.kwargs))}async batch(e,t,n){const a=Array.isArray(t)?await Promise.all(t.map(async o=>this._mergeConfig(Ve(o),this.kwargs))):await this._mergeConfig(Ve(t),this.kwargs);return this.bound.batch(e,a,n)}async*_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig(Ve(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig(Ve(t),this.kwargs))}async*transform(e,t){yield*this.bound.transform(e,await this._mergeConfig(Ve(t),this.kwargs))}streamEvents(e,t,n){const a=this,o=async function*(){yield*a.bound.streamEvents(e,{...await a._mergeConfig(Ve(t),a.kwargs),version:t.version},n)};return mn.fromAsyncGenerator(o())}static isRunnableBinding(e){return e.bound&&Et.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:n}){return new Za({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[a=>({callbacks:[new Cx({config:a,onStart:e,onEnd:t,onError:n})]})]})}}class Oc extends Et{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new Oc({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _invoke(e,t,n){return this.bound.batch(e,jt(t,{callbacks:n==null?void 0:n.getChild()}))}withListeners({onStart:e,onEnd:t,onError:n}){return new Oc({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:n})})}}class PA extends Za{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,n){const a=e>1?`retry:attempt:${e}`:void 0;return jt(t,{callbacks:n==null?void 0:n.getChild(a)})}async _invoke(e,t,n){return xc(a=>super.invoke(e,this._patchConfigForRetry(a,t,n)),{onFailedAttempt:a=>this.onFailedAttempt(a,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,n,a){const o={};try{await xc(async l=>{const c=e.map((g,w)=>w).filter(g=>o[g.toString()]===void 0||o[g.toString()]instanceof Error),d=c.map(g=>e[g]),f=c.map(g=>this._patchConfigForRetry(l,t==null?void 0:t[g],n==null?void 0:n[g])),p=await super.batch(d,f,{...a,returnExceptions:!0});let y;for(let g=0;g<p.length;g+=1){const w=p[g],_=c[g];w instanceof Error&&y===void 0&&(y=w,y.input=d[g]),o[_.toString()]=w}if(y)throw y;return p},{onFailedAttempt:l=>this.onFailedAttempt(l,l.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(l){if((a==null?void 0:a.returnExceptions)!==!0)throw l}return Object.keys(o).sort((l,c)=>parseInt(l,10)-parseInt(c,10)).map(l=>o[parseInt(l,10)])}async batch(e,t,n){return this._batchWithConfig(this._batch.bind(this),e,t,n)}}class Ar extends Et{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){var d;const n=Ve(t),a=await Zn(n),o=await(a==null?void 0:a.handleChainStart(this.toJSON(),St(e,"input"),n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));delete n.runId;let l=e,c;try{const f=[this.first,...this.middle];for(let p=0;p<f.length;p+=1){const g=f[p].invoke(l,jt(n,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:`seq:step:${p+1}`)}));l=await _a(g,t==null?void 0:t.signal)}if((d=t==null?void 0:t.signal)!=null&&d.aborted)throw new Error("Aborted");c=await this.last.invoke(l,jt(n,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(f){throw await(o==null?void 0:o.handleChainError(f)),f}return await(o==null?void 0:o.handleChainEnd(St(c,"output"))),c}async batch(e,t,n){var d;const a=this._getOptionsList(t??{},e.length),o=await Promise.all(a.map(Zn)),l=await Promise.all(o.map(async(f,p)=>{const y=await(f==null?void 0:f.handleChainStart(this.toJSON(),St(e[p],"input"),a[p].runId,void 0,void 0,void 0,a[p].runName));return delete a[p].runId,y}));let c=e;try{for(let f=0;f<this.steps.length;f+=1){const y=this.steps[f].batch(c,l.map((g,w)=>{const _=g==null?void 0:g.getChild(this.omitSequenceTags?void 0:`seq:step:${f+1}`);return jt(a[w],{callbacks:_})}),n);c=await _a(y,(d=a[0])==null?void 0:d.signal)}}catch(f){throw await Promise.all(l.map(p=>p==null?void 0:p.handleChainError(f))),f}return await Promise.all(l.map(f=>f==null?void 0:f.handleChainEnd(St(c,"output")))),c}async*_streamIterator(e,t){var y;const n=await Zn(t),{runId:a,...o}=t??{},l=await(n==null?void 0:n.handleChainStart(this.toJSON(),St(e,"input"),a,void 0,void 0,void 0,o==null?void 0:o.runName)),c=[this.first,...this.middle,this.last];let d=!0,f;async function*p(){yield e}try{let g=c[0].transform(p(),jt(o,{callbacks:l==null?void 0:l.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let w=1;w<c.length;w+=1)g=await c[w].transform(g,jt(o,{callbacks:l==null?void 0:l.getChild(this.omitSequenceTags?void 0:`seq:step:${w+1}`)}));for await(const w of g)if((y=t==null?void 0:t.signal)==null||y.throwIfAborted(),yield w,d)if(f===void 0)f=w;else try{f=Wn(f,w)}catch{f=void 0,d=!1}}catch(g){throw await(l==null?void 0:l.handleChainError(g)),g}await(l==null?void 0:l.handleChainEnd(St(f,"output")))}getGraph(e){const t=new ed;let n=null;return this.steps.forEach((a,o)=>{const l=a.getGraph(e);o!==0&&l.trimFirstNode(),o!==this.steps.length-1&&l.trimLastNode(),t.extend(l);const c=l.firstNode();if(!c)throw new Error(`Runnable ${a} has no first node`);n&&t.addEdge(n,c),n=l.lastNode()}),t}pipe(e){return Ar.isRunnableSequence(e)?new Ar({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new Ar({first:this.first,middle:[...this.middle,this.last],last:Va(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&Et.isRunnable(e)}static from([e,...t],n){let a={};return typeof n=="string"?a.name=n:n!==void 0&&(a=n),new Ar({...a,first:Va(e),middle:t.slice(0,-1).map(Va),last:Va(t[t.length-1])})}}class gi extends Et{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[t,n]of Object.entries(e.steps))this.steps[t]=Va(n)}static from(e){return new gi({steps:e})}async invoke(e,t){const n=Ve(t),a=await Zn(n),o=await(a==null?void 0:a.handleChainStart(this.toJSON(),{input:e},n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));delete n.runId;const l={};try{const c=Object.entries(this.steps).map(async([d,f])=>{l[d]=await f.invoke(e,jt(n,{callbacks:o==null?void 0:o.getChild(`map:key:${d}`)}))});await _a(Promise.all(c),t==null?void 0:t.signal)}catch(c){throw await(o==null?void 0:o.handleChainError(c)),c}return await(o==null?void 0:o.handleChainEnd(l)),l}async*_transform(e,t,n){const a={...this.steps},o=Sx(e,Object.keys(a).length),l=new Map(Object.entries(a).map(([c,d],f)=>{const p=d.transform(o[f],jt(n,{callbacks:t==null?void 0:t.getChild(`map:key:${c}`)}));return[c,p.next().then(y=>({key:c,gen:p,result:y}))]}));for(;l.size;){const c=Promise.race(l.values()),{key:d,result:f,gen:p}=await _a(c,n==null?void 0:n.signal);l.delete(d),f.done||(yield{[d]:f.value},l.set(d,p.next().then(y=>({key:d,gen:p,result:y}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}const a=Ve(t),o=new mi({generator:this.transform(n(),a),config:a});return await o.setup,mn.fromAsyncGenerator(o)}}class Zm extends Et{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!Vm(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){const[n]=this._getOptionsList(t??{},1),a=await Zn(n),o=this.func(jt(n,{callbacks:a}),e);return _a(o,n==null?void 0:n.signal)}async*_streamIterator(e,t){var o,l;const[n]=this._getOptionsList(t??{},1),a=await this.invoke(e,t);if(Wp(a)){for await(const c of a)(o=n==null?void 0:n.signal)==null||o.throwIfAborted(),yield c;return}if(CA(a)){for(;;){(l=n==null?void 0:n.signal)==null||l.throwIfAborted();const c=a.next();if(c.done)break;yield c.value}return}yield a}static from(e){return new Zm({func:e})}}function RA(r){if(Vm(r))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class dl extends Et{static lc_name(){return"RunnableLambda"}constructor(e){if(Vm(e.func))return Zm.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),RA(e.func),this.func=e.func}static from(e){return new dl({func:e})}async _invoke(e,t,n){return new Promise((a,o)=>{const l=jt(t,{callbacks:n==null?void 0:n.getChild(),recursionLimit:((t==null?void 0:t.recursionLimit)??fp)-1});Qa.runWithConfig(l,async()=>{var c,d;try{let f=await this.func(e,{...l});if(f&&Et.isRunnable(f)){if((t==null?void 0:t.recursionLimit)===0)throw new Error("Recursion limit reached.");f=await f.invoke(e,{...l,recursionLimit:(l.recursionLimit??fp)-1})}else if(Wp(f)){let p;for await(const y of q_(l,f))if((c=t==null?void 0:t.signal)==null||c.throwIfAborted(),p===void 0)p=y;else try{p=Wn(p,y)}catch{p=y}f=p}else if(H_(f)){let p;for(const y of V_(l,f))if((d=t==null?void 0:t.signal)==null||d.throwIfAborted(),p===void 0)p=y;else try{p=Wn(p,y)}catch{p=y}f=p}a(f)}catch(f){o(f)}})})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async*_transform(e,t,n){var c,d;let a;for await(const f of e)if(a===void 0)a=f;else try{a=Wn(a,f)}catch{a=f}const o=jt(n,{callbacks:t==null?void 0:t.getChild(),recursionLimit:((n==null?void 0:n.recursionLimit)??fp)-1}),l=await new Promise((f,p)=>{Qa.runWithConfig(o,async()=>{try{const y=await this.func(a,{...o,config:o});f(y)}catch(y){p(y)}})});if(l&&Et.isRunnable(l)){if((n==null?void 0:n.recursionLimit)===0)throw new Error("Recursion limit reached.");const f=await l.stream(a,o);for await(const p of f)yield p}else if(Wp(l))for await(const f of q_(o,l))(c=n==null?void 0:n.signal)==null||c.throwIfAborted(),yield f;else if(H_(l))for(const f of V_(o,l))(d=n==null?void 0:n.signal)==null||d.throwIfAborted(),yield f;else yield l}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}const a=Ve(t),o=new mi({generator:this.transform(n(),a),config:a});return await o.setup,mn.fromAsyncGenerator(o)}}class OA extends Et{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){var f;const n=Ve(t),a=await Zn(t),{runId:o,...l}=n,c=await(a==null?void 0:a.handleChainStart(this.toJSON(),St(e,"input"),o,void 0,void 0,void 0,l==null?void 0:l.runName));let d;for(const p of this.runnables()){(f=n==null?void 0:n.signal)==null||f.throwIfAborted();try{const y=await p.invoke(e,jt(l,{callbacks:c==null?void 0:c.getChild()}));return await(c==null?void 0:c.handleChainEnd(St(y,"output"))),y}catch(y){d===void 0&&(d=y)}}throw d===void 0?new Error("No error stored at end of fallback."):(await(c==null?void 0:c.handleChainError(d)),d)}async*_streamIterator(e,t){var y;const n=Ve(t),a=await Zn(t),{runId:o,...l}=n,c=await(a==null?void 0:a.handleChainStart(this.toJSON(),St(e,"input"),o,void 0,void 0,void 0,l==null?void 0:l.runName));let d,f;for(const g of this.runnables()){(y=n==null?void 0:n.signal)==null||y.throwIfAborted();const w=jt(l,{callbacks:c==null?void 0:c.getChild()});try{f=await g.stream(e,w);break}catch(_){d===void 0&&(d=_)}}if(f===void 0){const g=d??new Error("No error stored at end of fallback.");throw await(c==null?void 0:c.handleChainError(g)),g}let p;try{for await(const g of f){yield g;try{p=p===void 0?p:Wn(p,g)}catch{p=void 0}}}catch(g){throw await(c==null?void 0:c.handleChainError(g)),g}await(c==null?void 0:c.handleChainEnd(St(p,"output")))}async batch(e,t,n){var d;if(n!=null&&n.returnExceptions)throw new Error("Not implemented.");const a=this._getOptionsList(t??{},e.length),o=await Promise.all(a.map(f=>Zn(f))),l=await Promise.all(o.map(async(f,p)=>{const y=await(f==null?void 0:f.handleChainStart(this.toJSON(),St(e[p],"input"),a[p].runId,void 0,void 0,void 0,a[p].runName));return delete a[p].runId,y}));let c;for(const f of this.runnables()){(d=a[0].signal)==null||d.throwIfAborted();try{const p=await f.batch(e,l.map((y,g)=>jt(a[g],{callbacks:y==null?void 0:y.getChild()})),n);return await Promise.all(l.map((y,g)=>y==null?void 0:y.handleChainEnd(St(p[g],"output")))),p}catch(p){c===void 0&&(c=p)}}throw c?(await Promise.all(l.map(f=>f==null?void 0:f.handleChainError(c))),c):new Error("No error stored at end of fallbacks.")}}function Va(r){if(typeof r=="function")return new dl({func:r});if(Et.isRunnable(r))return r;if(!Array.isArray(r)&&typeof r=="object"){const e={};for(const[t,n]of Object.entries(r))e[t]=Va(n);return new gi({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class Ix extends Et{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof gi&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){const n=await this.mapper.invoke(e,t);return{...e,...n}}async*_transform(e,t,n){const a=this.mapper.getStepsKeys(),[o,l]=Sx(e),c=this.mapper.transform(l,jt(n,{callbacks:t==null?void 0:t.getChild()})),d=c.next();for await(const f of o){if(typeof f!="object"||Array.isArray(f))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof f}`);const p=Object.fromEntries(Object.entries(f).filter(([y])=>!a.includes(y)));Object.keys(p).length>0&&(yield p)}yield(await d).value;for await(const f of c)yield f}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}const a=Ve(t),o=new mi({generator:this.transform(n(),a),config:a});return await o.setup,mn.fromAsyncGenerator(o)}}class TA extends Et{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const t=this.keys.map(n=>[n,e[n]]).filter(n=>n[1]!==void 0);return t.length===0?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(const t of e){const n=await this._pick(t);n!==void 0&&(yield n)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}const a=Ve(t),o=new mi({generator:this.transform(n(),a),config:a});return await o.setup,mn.fromAsyncGenerator(o)}}class W_ extends Za{constructor(e){const t=Ar.from([dl.from(async n=>{let a;if(X0(n))try{a=await this.schema.parseAsync(n.args)}catch{throw new kP("Received tool input did not match expected schema",JSON.stringify(n.args))}else a=n;return a}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:t,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function AA(r,e){var a;const t=e.name??r.getName(),n=e.description??((a=e.schema)==null?void 0:a.description);return e.schema.constructor===Wa.ZodString?new W_({name:t,description:n,schema:Wa.object({input:Wa.string()}).transform(o=>o.input),bound:r}):new W_({name:t,description:n,schema:e.schema,bound:r})}/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var IA=typeof window=="object"?window:{},Re="0123456789abcdef".split(""),NA=[-2147483648,8388608,32768,128],Dn=[24,16,8,0],bt=[];function Jn(r){r?(bt[0]=bt[16]=bt[1]=bt[2]=bt[3]=bt[4]=bt[5]=bt[6]=bt[7]=bt[8]=bt[9]=bt[10]=bt[11]=bt[12]=bt[13]=bt[14]=bt[15]=0,this.blocks=bt):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Jn.prototype.update=function(r){if(!this.finalized){var e=typeof r!="string";e&&r.constructor===IA.ArrayBuffer&&(r=new Uint8Array(r));for(var t,n=0,a,o=r.length||0,l=this.blocks;n<o;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),e)for(a=this.start;n<o&&a<64;++n)l[a>>2]|=r[n]<<Dn[a++&3];else for(a=this.start;n<o&&a<64;++n)t=r.charCodeAt(n),t<128?l[a>>2]|=t<<Dn[a++&3]:t<2048?(l[a>>2]|=(192|t>>6)<<Dn[a++&3],l[a>>2]|=(128|t&63)<<Dn[a++&3]):t<55296||t>=57344?(l[a>>2]|=(224|t>>12)<<Dn[a++&3],l[a>>2]|=(128|t>>6&63)<<Dn[a++&3],l[a>>2]|=(128|t&63)<<Dn[a++&3]):(t=65536+((t&1023)<<10|r.charCodeAt(++n)&1023),l[a>>2]|=(240|t>>18)<<Dn[a++&3],l[a>>2]|=(128|t>>12&63)<<Dn[a++&3],l[a>>2]|=(128|t>>6&63)<<Dn[a++&3],l[a>>2]|=(128|t&63)<<Dn[a++&3]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=l[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Jn.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var r=this.blocks,e=this.lastByteIndex;r[16]=this.block,r[e>>2]|=NA[e&3],this.block=r[16],e>=56&&(this.hashed||this.hash(),r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),r[14]=this.hBytes<<3|this.bytes>>>29,r[15]=this.bytes<<3,this.hash()}};Jn.prototype.hash=function(){var r=this.h0,e=this.h1,t=this.h2,n=this.h3,a=this.h4,o,l,c,d=this.blocks;for(l=16;l<80;++l)c=d[l-3]^d[l-8]^d[l-14]^d[l-16],d[l]=c<<1|c>>>31;for(l=0;l<20;l+=5)o=e&t|~e&n,c=r<<5|r>>>27,a=c+o+a+1518500249+d[l]<<0,e=e<<30|e>>>2,o=r&e|~r&t,c=a<<5|a>>>27,n=c+o+n+1518500249+d[l+1]<<0,r=r<<30|r>>>2,o=a&r|~a&e,c=n<<5|n>>>27,t=c+o+t+1518500249+d[l+2]<<0,a=a<<30|a>>>2,o=n&a|~n&r,c=t<<5|t>>>27,e=c+o+e+1518500249+d[l+3]<<0,n=n<<30|n>>>2,o=t&n|~t&a,c=e<<5|e>>>27,r=c+o+r+1518500249+d[l+4]<<0,t=t<<30|t>>>2;for(;l<40;l+=5)o=e^t^n,c=r<<5|r>>>27,a=c+o+a+1859775393+d[l]<<0,e=e<<30|e>>>2,o=r^e^t,c=a<<5|a>>>27,n=c+o+n+1859775393+d[l+1]<<0,r=r<<30|r>>>2,o=a^r^e,c=n<<5|n>>>27,t=c+o+t+1859775393+d[l+2]<<0,a=a<<30|a>>>2,o=n^a^r,c=t<<5|t>>>27,e=c+o+e+1859775393+d[l+3]<<0,n=n<<30|n>>>2,o=t^n^a,c=e<<5|e>>>27,r=c+o+r+1859775393+d[l+4]<<0,t=t<<30|t>>>2;for(;l<60;l+=5)o=e&t|e&n|t&n,c=r<<5|r>>>27,a=c+o+a-1894007588+d[l]<<0,e=e<<30|e>>>2,o=r&e|r&t|e&t,c=a<<5|a>>>27,n=c+o+n-1894007588+d[l+1]<<0,r=r<<30|r>>>2,o=a&r|a&e|r&e,c=n<<5|n>>>27,t=c+o+t-1894007588+d[l+2]<<0,a=a<<30|a>>>2,o=n&a|n&r|a&r,c=t<<5|t>>>27,e=c+o+e-1894007588+d[l+3]<<0,n=n<<30|n>>>2,o=t&n|t&a|n&a,c=e<<5|e>>>27,r=c+o+r-1894007588+d[l+4]<<0,t=t<<30|t>>>2;for(;l<80;l+=5)o=e^t^n,c=r<<5|r>>>27,a=c+o+a-899497514+d[l]<<0,e=e<<30|e>>>2,o=r^e^t,c=a<<5|a>>>27,n=c+o+n-899497514+d[l+1]<<0,r=r<<30|r>>>2,o=a^r^e,c=n<<5|n>>>27,t=c+o+t-899497514+d[l+2]<<0,a=a<<30|a>>>2,o=n^a^r,c=t<<5|t>>>27,e=c+o+e-899497514+d[l+3]<<0,n=n<<30|n>>>2,o=t^n^a,c=e<<5|e>>>27,r=c+o+r-899497514+d[l+4]<<0,t=t<<30|t>>>2;this.h0=this.h0+r<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+n<<0,this.h4=this.h4+a<<0};Jn.prototype.hex=function(){this.finalize();var r=this.h0,e=this.h1,t=this.h2,n=this.h3,a=this.h4;return Re[r>>28&15]+Re[r>>24&15]+Re[r>>20&15]+Re[r>>16&15]+Re[r>>12&15]+Re[r>>8&15]+Re[r>>4&15]+Re[r&15]+Re[e>>28&15]+Re[e>>24&15]+Re[e>>20&15]+Re[e>>16&15]+Re[e>>12&15]+Re[e>>8&15]+Re[e>>4&15]+Re[e&15]+Re[t>>28&15]+Re[t>>24&15]+Re[t>>20&15]+Re[t>>16&15]+Re[t>>12&15]+Re[t>>8&15]+Re[t>>4&15]+Re[t&15]+Re[n>>28&15]+Re[n>>24&15]+Re[n>>20&15]+Re[n>>16&15]+Re[n>>12&15]+Re[n>>8&15]+Re[n>>4&15]+Re[n&15]+Re[a>>28&15]+Re[a>>24&15]+Re[a>>20&15]+Re[a>>16&15]+Re[a>>12&15]+Re[a>>8&15]+Re[a>>4&15]+Re[a&15]};Jn.prototype.toString=Jn.prototype.hex;Jn.prototype.digest=function(){this.finalize();var r=this.h0,e=this.h1,t=this.h2,n=this.h3,a=this.h4;return[r>>24&255,r>>16&255,r>>8&255,r&255,e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,a>>24&255,a>>16&255,a>>8&255,a&255]};Jn.prototype.array=Jn.prototype.digest;Jn.prototype.arrayBuffer=function(){this.finalize();var r=new ArrayBuffer(20),e=new DataView(r);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),r};const $A=r=>new Jn(!0).update(r).hex(),Z_=(...r)=>$A(r.join("_"));class jA{}const LA=new Map;class Gm extends jA{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(Z_(e,t))??null)}async update(e,t,n){this.cache.set(Z_(e,t),n)}static global(){return new Gm(LA)}}class Nx extends Ja{}class MA extends Nx{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new sl(this.value)]}}class DA extends Nx{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return Q0(this.messages)}toChatMessages(){return this.messages}}var co={},G_;function FA(){if(G_)return co;G_=1,co.byteLength=c,co.toByteArray=f,co.fromByteArray=g;for(var r=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=n.length;a<o;++a)r[a]=n[a],e[n.charCodeAt(a)]=a;e[45]=62,e[95]=63;function l(w){var _=w.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var S=w.indexOf("=");S===-1&&(S=_);var b=S===_?0:4-S%4;return[S,b]}function c(w){var _=l(w),S=_[0],b=_[1];return(S+b)*3/4-b}function d(w,_,S){return(_+S)*3/4-S}function f(w){var _,S=l(w),b=S[0],k=S[1],E=new t(d(w,b,k)),P=0,N=k>0?b-4:b,j;for(j=0;j<N;j+=4)_=e[w.charCodeAt(j)]<<18|e[w.charCodeAt(j+1)]<<12|e[w.charCodeAt(j+2)]<<6|e[w.charCodeAt(j+3)],E[P++]=_>>16&255,E[P++]=_>>8&255,E[P++]=_&255;return k===2&&(_=e[w.charCodeAt(j)]<<2|e[w.charCodeAt(j+1)]>>4,E[P++]=_&255),k===1&&(_=e[w.charCodeAt(j)]<<10|e[w.charCodeAt(j+1)]<<4|e[w.charCodeAt(j+2)]>>2,E[P++]=_>>8&255,E[P++]=_&255),E}function p(w){return r[w>>18&63]+r[w>>12&63]+r[w>>6&63]+r[w&63]}function y(w,_,S){for(var b,k=[],E=_;E<S;E+=3)b=(w[E]<<16&16711680)+(w[E+1]<<8&65280)+(w[E+2]&255),k.push(p(b));return k.join("")}function g(w){for(var _,S=w.length,b=S%3,k=[],E=16383,P=0,N=S-b;P<N;P+=E)k.push(y(w,P,P+E>N?N:P+E));return b===1?(_=w[S-1],k.push(r[_>>2]+r[_<<4&63]+"==")):b===2&&(_=(w[S-2]<<8)+w[S-1],k.push(r[_>>10]+r[_>>4&63]+r[_<<2&63]+"=")),k.join("")}return co}var UA=FA();const zA=Ya(UA);var BA=Object.defineProperty,HA=(r,e,t)=>e in r?BA(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,VA=(r,e,t)=>(HA(r,e+"",t),t);function qA(r,e){let t=Array.from({length:r.length},(n,a)=>({start:a,end:a+1}));for(;t.length>1;){let n=null;for(let a=0;a<t.length-1;a++){const o=r.slice(t[a].start,t[a+1].end),l=e.get(o.join(","));l!=null&&(n==null||l<n[0])&&(n=[l,a])}if(n!=null){const a=n[1];t[a]={start:t[a].start,end:t[a+1].end},t.splice(a+1,1)}else break}return t}function WA(r,e){return r.length===1?[e.get(r.join(","))]:qA(r,e).map(t=>e.get(r.slice(t.start,t.end).join(","))).filter(t=>t!=null)}function ZA(r){return r.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var Zp=class{constructor(r,e){Sr(this,"specialTokens");Sr(this,"inverseSpecialTokens");Sr(this,"patStr");Sr(this,"textEncoder",new TextEncoder);Sr(this,"textDecoder",new TextDecoder("utf-8"));Sr(this,"rankMap",new Map);Sr(this,"textMap",new Map);this.patStr=r.pat_str;const t=r.bpe_ranks.split(`
`).filter(Boolean).reduce((n,a)=>{const[o,l,...c]=a.split(" "),d=Number.parseInt(l,10);return c.forEach((f,p)=>n[f]=d+p),n},{});for(const[n,a]of Object.entries(t)){const o=zA.toByteArray(n);this.rankMap.set(o.join(","),a),this.textMap.set(a,o)}this.specialTokens={...r.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((n,[a,o])=>(n[o]=this.textEncoder.encode(a),n),{})}encode(r,e=[],t="all"){const n=new RegExp(this.patStr,"ug"),a=Zp.specialTokenRegex(Object.keys(this.specialTokens)),o=[],l=new Set(e==="all"?Object.keys(this.specialTokens):e),c=new Set(t==="all"?Object.keys(this.specialTokens).filter(f=>!l.has(f)):t);if(c.size>0){const f=Zp.specialTokenRegex([...c]),p=r.match(f);if(p!=null)throw new Error(`The text contains a special token that is not allowed: ${p[0]}`)}let d=0;for(;;){let f=null,p=d;for(;a.lastIndex=p,f=a.exec(r),!(f==null||l.has(f[0]));)p=f.index+1;const y=(f==null?void 0:f.index)??r.length;for(const w of r.substring(d,y).matchAll(n)){const _=this.textEncoder.encode(w[0]),S=this.rankMap.get(_.join(","));if(S!=null){o.push(S);continue}o.push(...WA(_,this.rankMap))}if(f==null)break;let g=this.specialTokens[f[0]];o.push(g),d=f.index+f[0].length}return o}decode(r){const e=[];let t=0;for(let o=0;o<r.length;++o){const l=r[o],c=this.textMap.get(l)??this.inverseSpecialTokens[l];c!=null&&(e.push(c),t+=c.length)}const n=new Uint8Array(t);let a=0;for(const o of e)n.set(o,a),a+=o.length;return this.textDecoder.decode(n)}},$x=Zp;VA($x,"specialTokenRegex",r=>new RegExp(r.map(e=>ZA(e)).join("|"),"g"));function GA(r){switch(r){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}const Vu={},JA=new qm({});async function KA(r){return r in Vu||(Vu[r]=JA.fetch(`https://tiktoken.pages.dev/js/${r}.json`).then(e=>e.json()).then(e=>new $x(e)).catch(e=>{throw delete Vu[r],e})),await Vu[r]}async function XA(r){return KA(GA(r))}const QA=r=>r.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":r.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":r.startsWith("gpt-4-32k")?"gpt-4-32k":r.startsWith("gpt-4-")?"gpt-4":r.startsWith("gpt-4o")?"gpt-4o":r;function YA(r){return typeof r!="object"||!r?!1:!!("type"in r&&r.type==="function"&&"function"in r&&typeof r.function=="object"&&r.function&&"name"in r.function&&"parameters"in r.function)}const eI=()=>!1;class tI extends Et{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??eI(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class nI extends tI{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...n}){const{cache:a,...o}=n;super({callbacks:e??t,...o}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof a=="object"?this.cache=a:a?this.cache=Gm.global():this.cache=void 0,this.caller=new qm(n??{})}async getNumTokens(e){if(typeof e!="string")return 0;let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await XA("modelName"in this?QA(this.modelName):"gpt2")}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}if(this._encoding)try{t=this._encoding.encode(e).length}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}return t}static _convertInputToPromptValue(e){return typeof e=="string"?new MA(e):Array.isArray(e)?new DA(e.map(_o)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){const n={...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()};return Object.entries(n).filter(([l,c])=>c!==void 0).map(([l,c])=>`${l}:${JSON.stringify(c)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}class Tc extends Et{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,t){const n=Ve(t);return this.func&&await this.func(e,n),this._callWithConfig(a=>Promise.resolve(a),e,n)}async*transform(e,t){const n=Ve(t);let a,o=!0;for await(const l of this._transformStreamWithConfig(e,c=>c,n))if(yield l,o)if(a===void 0)a=l;else try{a=Wn(a,l)}catch{a=void 0,o=!1}this.func&&a!==void 0&&await this.func(a,n)}static assign(e){return new Ix(new gi({steps:e}))}}function jx(r){return typeof(r==null?void 0:r.parse)=="function"}class da extends nI{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(e){const[t,n]=super._separateRunnableConfigFromCallOptions(e);return n.signal=t.signal,[t,n]}async invoke(e,t){const n=da._convertInputToPromptValue(e);return(await this.generatePrompt([n],t,t==null?void 0:t.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,t,n){throw new Error("Not implemented.")}async*_streamIterator(e,t){var n;if(this._streamResponseChunks===da.prototype._streamResponseChunks)yield this.invoke(e,t);else{const o=da._convertInputToPromptValue(e).toChatMessages(),[l,c]=this._separateRunnableConfigFromCallOptionsCompat(t),d={...l.metadata,...this.getLsParams(c)},f=await pn.configure(l.callbacks,this.callbacks,l.tags,this.tags,d,this.metadata,{verbose:this.verbose}),p={options:c,invocation_params:this==null?void 0:this.invocationParams(c),batch_size:1},y=await(f==null?void 0:f.handleChatModelStart(this.toJSON(),[o],l.runId,void 0,p,void 0,void 0,l.runName));let g,w;try{for await(const _ of this._streamResponseChunks(o,c,y==null?void 0:y[0])){if(_.message.id==null){const S=(n=y==null?void 0:y.at(0))==null?void 0:n.runId;S!=null&&_.message._updateId(`run-${S}`)}_.message.response_metadata={..._.generationInfo,..._.message.response_metadata},yield _.message,g?g=g.concat(_):g=_,mw(_.message)&&_.message.usage_metadata!==void 0&&(w={tokenUsage:{promptTokens:_.message.usage_metadata.input_tokens,completionTokens:_.message.usage_metadata.output_tokens,totalTokens:_.message.usage_metadata.total_tokens}})}}catch(_){throw await Promise.all((y??[]).map(S=>S==null?void 0:S.handleLLMError(_))),_}await Promise.all((y??[]).map(_=>_==null?void 0:_.handleLLMEnd({generations:[[g]],llmOutput:w})))}}getLsParams(e){const t=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:t}}async _generateUncached(e,t,n){var w,_;const a=e.map(S=>S.map(_o)),o={...n.metadata,...this.getLsParams(t)},l=await pn.configure(n.callbacks,this.callbacks,n.tags,this.tags,o,this.metadata,{verbose:this.verbose}),c={options:t,invocation_params:this==null?void 0:this.invocationParams(t),batch_size:1},d=await(l==null?void 0:l.handleChatModelStart(this.toJSON(),a,n.runId,void 0,c,void 0,void 0,n.runName)),f=[],p=[];if(!!(d!=null&&d[0].handlers.find(S=>kx(S)||Ex(S)))&&a.length===1&&this._streamResponseChunks!==da.prototype._streamResponseChunks)try{const S=await this._streamResponseChunks(a[0],t,d==null?void 0:d[0]);let b,k;for await(const E of S){if(E.message.id==null){const P=(w=d==null?void 0:d.at(0))==null?void 0:w.runId;P!=null&&E.message._updateId(`run-${P}`)}b===void 0?b=E:b=Wn(b,E),mw(E.message)&&E.message.usage_metadata!==void 0&&(k={tokenUsage:{promptTokens:E.message.usage_metadata.input_tokens,completionTokens:E.message.usage_metadata.output_tokens,totalTokens:E.message.usage_metadata.total_tokens}})}if(b===void 0)throw new Error("Received empty response from chat model call.");f.push([b]),await(d==null?void 0:d[0].handleLLMEnd({generations:f,llmOutput:k}))}catch(S){throw await(d==null?void 0:d[0].handleLLMError(S)),S}else{const S=await Promise.allSettled(a.map((b,k)=>this._generate(b,{...t,promptIndex:k},d==null?void 0:d[k])));await Promise.all(S.map(async(b,k)=>{var E,P,N;if(b.status==="fulfilled"){const j=b.value;for(const D of j.generations){if(D.message.id==null){const z=(E=d==null?void 0:d.at(0))==null?void 0:E.runId;z!=null&&D.message._updateId(`run-${z}`)}D.message.response_metadata={...D.generationInfo,...D.message.response_metadata}}return j.generations.length===1&&(j.generations[0].message.response_metadata={...j.llmOutput,...j.generations[0].message.response_metadata}),f[k]=j.generations,p[k]=j.llmOutput,(P=d==null?void 0:d[k])==null?void 0:P.handleLLMEnd({generations:[j.generations],llmOutput:j.llmOutput})}else return await((N=d==null?void 0:d[k])==null?void 0:N.handleLLMError(b.reason)),Promise.reject(b.reason)}))}const g={generations:f,llmOutput:p.length?(_=this._combineLLMOutput)==null?void 0:_.call(this,...p):void 0};return Object.defineProperty(g,M_,{value:d?{runIds:d==null?void 0:d.map(S=>S.runId)}:void 0,configurable:!0}),g}async _generateCached({messages:e,cache:t,llmStringKey:n,parsedOptions:a,handledOptions:o}){const l=e.map(b=>b.map(_o)),c={...o.metadata,...this.getLsParams(a)},d=await pn.configure(o.callbacks,this.callbacks,o.tags,this.tags,c,this.metadata,{verbose:this.verbose}),f={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1,cached:!0},p=await(d==null?void 0:d.handleChatModelStart(this.toJSON(),l,o.runId,void 0,f,void 0,void 0,o.runName)),y=[],w=(await Promise.allSettled(l.map(async(b,k)=>{const E=da._convertInputToPromptValue(b).toString(),P=await t.lookup(E,n);return P==null&&y.push(k),P}))).map((b,k)=>({result:b,runManager:p==null?void 0:p[k]})).filter(({result:b})=>b.status==="fulfilled"&&b.value!=null||b.status==="rejected"),_=[];await Promise.all(w.map(async({result:b,runManager:k},E)=>{if(b.status==="fulfilled"){const P=b.value;return _[E]=P,P.length&&await(k==null?void 0:k.handleLLMNewToken(P[0].text)),k==null?void 0:k.handleLLMEnd({generations:[P]})}else return await(k==null?void 0:k.handleLLMError(b.reason)),Promise.reject(b.reason)}));const S={generations:_,missingPromptIndices:y};return Object.defineProperty(S,M_,{value:p?{runIds:p==null?void 0:p.map(b=>b.runId)}:void 0,configurable:!0}),S}async generate(e,t,n){let a;Array.isArray(t)?a={stop:t}:a=t;const o=e.map(w=>w.map(_o)),[l,c]=this._separateRunnableConfigFromCallOptionsCompat(a);if(l.callbacks=l.callbacks??n,!this.cache)return this._generateUncached(o,c,l);const{cache:d}=this,f=this._getSerializedCacheKeyParametersForCall(c),{generations:p,missingPromptIndices:y}=await this._generateCached({messages:o,cache:d,llmStringKey:f,parsedOptions:c,handledOptions:l});let g={};if(y.length>0){const w=await this._generateUncached(y.map(_=>o[_]),c,l);await Promise.all(w.generations.map(async(_,S)=>{const b=y[S];p[b]=_;const k=da._convertInputToPromptValue(o[b]).toString();return d.update(k,f,_)})),g=w.llmOutput??{}}return{generations:p,llmOutput:g}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,n){const a=e.map(o=>o.toChatMessages());return this.generate(a,t,n)}async call(e,t,n){return(await this.generate([e.map(_o)],t,n)).generations[0][0].message}async callPrompt(e,t,n){const a=e.toChatMessages();return this.call(a,t,n)}async predictMessages(e,t,n){return this.call(e,t,n)}async predict(e,t,n){const a=new sl(e),o=await this.call([a],t,n);if(typeof o.content!="string")throw new Error("Cannot use predict when output is not a string.");return o.content}withStructuredOutput(e,t){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(t!=null&&t.strict)throw new Error('"strict" mode is not supported for this model by default.');const n=e,a=t==null?void 0:t.name,o=n.description??"A function available to call.",l=t==null?void 0:t.method,c=t==null?void 0:t.includeRaw;if(l==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let d=a??"extract",f;jx(n)?f=[{type:"function",function:{name:d,description:o,parameters:cl(n)}}]:("name"in n&&(d=n.name),f=[{type:"function",function:{name:d,description:o,parameters:n}}]);const p=this.bindTools(f),y=dl.from(S=>{if(!S.tool_calls||S.tool_calls.length===0)throw new Error("No tool calls found in the response.");const b=S.tool_calls.find(k=>k.name===d);if(!b)throw new Error(`No tool call found with name ${d}.`);return b.args});if(!c)return p.pipe(y).withConfig({runName:"StructuredOutput"});const g=Tc.assign({parsed:(S,b)=>y.invoke(S.raw,b)}),w=Tc.assign({parsed:()=>null}),_=g.withFallbacks({fallbacks:[w]});return Ar.from([{raw:p},_]).withConfig({runName:"StructuredOutputRunnable"})}}class rI extends Et{parseResultWithPrompt(e,t,n){return this.parseResult(e,n)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return typeof e=="string"?this._callWithConfig(async(n,a)=>this.parseResult([{text:n}],a==null?void 0:a.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(n,a)=>this.parseResult([{message:n,text:this._baseMessageToString(n)}],a==null?void 0:a.callbacks),e,{...t,runType:"parser"})}}class Lx extends rI{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,n){return this.parse(e,n)}_type(){throw new Error("_type not implemented")}}class Jm extends Error{constructor(e,t,n,a=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=t,this.observation=n,this.sendToLLM=a,a&&(n===void 0||t===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");K0(this,"OUTPUT_PARSING_FAILURE")}}function Gp(r,e){const t=typeof r;if(t!==typeof e)return!1;if(Array.isArray(r)){if(!Array.isArray(e))return!1;const n=r.length;if(n!==e.length)return!1;for(let a=0;a<n;a++)if(!Gp(r[a],e[a]))return!1;return!0}if(t==="object"){if(!r||!e)return r===e;const n=Object.keys(r),a=Object.keys(e);if(n.length!==a.length)return!1;for(const l of n)if(!Gp(r[l],e[l]))return!1;return!0}return r===e}class aI extends Lx{async*_transform(e){for await(const t of e)typeof t=="string"?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async*transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}}class Mx extends aI{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let t,n;for await(const a of e){if(typeof a!="string"&&typeof a.content!="string")throw new Error("Cannot handle non-string output.");let o;if(xP(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new ai({message:a,text:a.content})}else if($m(a)){if(typeof a.content!="string")throw new Error("Cannot handle non-string message output.");o=new ai({message:RP(a),text:a.content})}else o=new ri({text:a});n===void 0?n=o:n=n.concat(o);const l=await this.parsePartialResult([n]);l!=null&&!Gp(l,t)&&(this.diff?yield this._diff(t,l):yield l,t=l)}}getFormatInstructions(){return""}}class J_ extends Lx{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const t=Wa.object(Object.fromEntries(Object.entries(e).map(([n,a])=>[n,Wa.string().describe(a)])));return new this(t)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(cl(this.schema))}
\`\`\`
`}async parse(e){try{const n=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(a,o)=>`"${o.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(t){throw new Jm(`Failed to parse. Text: "${e}". Error: ${t}`,e)}}}class K_ extends Mx{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,t){if(t)return e?aT(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return dw(e[0].text)}async parse(e){return dw(e,JSON.parse)}getFormatInstructions(){return""}}function Dx(r,e){if(r.function===void 0)return;let t;if(e!=null&&e.partial)try{t=Nm(r.function.arguments??"{}")}catch{return}else try{t=JSON.parse(r.function.arguments)}catch(a){throw new Jm([`Function "${r.function.name}" arguments:`,"",r.function.arguments,"","are not valid JSON.",`Error: ${a.message}`].join(`
`))}const n={name:r.function.name,args:t,type:"tool_call"};return e!=null&&e.returnId&&(n.id=r.id),n}function sI(r){if(r.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:r.id,type:"function",function:{name:r.name,arguments:JSON.stringify(r.args)}}}function iI(r,e){var t,n;return{name:(t=r.function)==null?void 0:t.name,args:(n=r.function)==null?void 0:n.arguments,id:r.id,error:e,type:"invalid_tool_call"}}class oI extends Mx{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(e==null?void 0:e.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,t=!0){var l;const n=e[0].message;let a;if(Lm(n)&&((l=n.tool_calls)!=null&&l.length)?a=n.tool_calls.map(c=>{const{id:d,...f}=c;return this.returnId?{id:d,...f}:f}):n.additional_kwargs.tool_calls!==void 0&&(a=JSON.parse(JSON.stringify(n.additional_kwargs.tool_calls)).map(d=>Dx(d,{returnId:this.returnId,partial:t}))),!a)return[];const o=[];for(const c of a)if(c!==void 0){const d={type:c.name,args:c.args,id:c.id};o.push(d)}return o}}class X_ extends oI{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const t=await this.zodSchema.safeParseAsync(e);if(t.success)return t.data;throw new Jm(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error.errors)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const n=(await super.parsePartialResult(e)).filter(o=>o.type===this.keyName);let a=n;if(n.length)return this.returnId||(a=n.map(o=>o.args)),this.returnSingle?a[0]:a}async parseResult(e){const n=(await super.parsePartialResult(e,!1)).filter(l=>l.type===this.keyName);let a=n;return n.length?(this.returnId||(a=n.map(l=>l.args)),this.returnSingle?this._validateResult(a[0]):await Promise.all(a.map(l=>this._validateResult(l)))):void 0}}const lI=Symbol("Let zodToJsonSchema decide on which parser to use"),Q_={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},uI=r=>typeof r=="string"?{...Q_,basePath:["#"],definitions:{},name:r}:{...Q_,basePath:["#"],definitions:{},...r},Jp=r=>"_def"in r?r._def:r;function cI(r){if(!r)return!0;for(const e in r)return!1;return!0}const dI=r=>{const e=uI(r),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([n,a])=>[Jp(a),{def:Jp(a),path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Fx(r,e,t,n){n!=null&&n.errorMessages&&t&&(r.errorMessage={...r.errorMessage,[e]:t})}function Ze(r,e,t,n,a){r[e]=t,Fx(r,e,n,a)}function fI(){return{}}function hI(r,e){var n,a;const t={type:"array"};return((a=(n=r.type)==null?void 0:n._def)==null?void 0:a.typeName)!==H.ZodAny&&(t.items=Be(r.type._def,{...e,currentPath:[...e.currentPath,"items"]})),r.minLength&&Ze(t,"minItems",r.minLength.value,r.minLength.message,e),r.maxLength&&Ze(t,"maxItems",r.maxLength.value,r.maxLength.message,e),r.exactLength&&(Ze(t,"minItems",r.exactLength.value,r.exactLength.message,e),Ze(t,"maxItems",r.exactLength.value,r.exactLength.message,e)),t}function pI(r,e){const t={type:"integer",format:"int64"};if(!r.checks)return t;for(const n of r.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?Ze(t,"minimum",n.value,n.message,e):Ze(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),Ze(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?Ze(t,"maximum",n.value,n.message,e):Ze(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),Ze(t,"maximum",n.value,n.message,e));break;case"multipleOf":Ze(t,"multipleOf",n.value,n.message,e);break}return t}function mI(){return{type:"boolean"}}function gI(r,e){return Be(r.type._def,e)}const yI=(r,e)=>Be(r.innerType._def,e);function Ux(r,e,t){const n=t??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((a,o)=>Ux(r,e,a))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return vI(r,e)}}const vI=(r,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const n of r.checks)switch(n.kind){case"min":Ze(t,"minimum",n.value,n.message,e);break;case"max":Ze(t,"maximum",n.value,n.message,e);break}return t};function wI(r,e){return{...Be(r.innerType._def,e),default:r.defaultValue()}}function _I(r,e,t){return e.effectStrategy==="input"?Be(r.schema._def,e,t):{}}function bI(r){return{type:"string",enum:[...r.values]}}const xI=r=>"type"in r&&r.type==="string"?!1:"allOf"in r;function SI(r,e){const t=[Be(r.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Be(r.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(o=>!!o);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const a=[];return t.forEach(o=>{if(xI(o))a.push(...o.allOf),o.unevaluatedProperties===void 0&&(n=void 0);else{let l=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:c,...d}=o;l=d}else n=void 0;a.push(l)}}),a.length?{allOf:a,...n}:void 0}function EI(r,e){const t=typeof r.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(r.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[r.value]}:{type:t==="bigint"?"integer":t,const:r.value}}let mp;const Ua={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(mp===void 0&&(mp=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),mp),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function zx(r,e){const t={type:"string"};function n(a){return e.patternStrategy==="escape"?kI(a):a}if(r.checks)for(const a of r.checks)switch(a.kind){case"min":Ze(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,a.value):a.value,a.message,e);break;case"max":Ze(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,a.value):a.value,a.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Fn(t,"email",a.message,e);break;case"format:idn-email":Fn(t,"idn-email",a.message,e);break;case"pattern:zod":Un(t,Ua.email,a.message,e);break}break;case"url":Fn(t,"uri",a.message,e);break;case"uuid":Fn(t,"uuid",a.message,e);break;case"regex":Un(t,a.regex,a.message,e);break;case"cuid":Un(t,Ua.cuid,a.message,e);break;case"cuid2":Un(t,Ua.cuid2,a.message,e);break;case"startsWith":Un(t,RegExp(`^${n(a.value)}`),a.message,e);break;case"endsWith":Un(t,RegExp(`${n(a.value)}$`),a.message,e);break;case"datetime":Fn(t,"date-time",a.message,e);break;case"date":Fn(t,"date",a.message,e);break;case"time":Fn(t,"time",a.message,e);break;case"duration":Fn(t,"duration",a.message,e);break;case"length":Ze(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,a.value):a.value,a.message,e),Ze(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,a.value):a.value,a.message,e);break;case"includes":{Un(t,RegExp(n(a.value)),a.message,e);break}case"ip":{a.version!=="v6"&&Fn(t,"ipv4",a.message,e),a.version!=="v4"&&Fn(t,"ipv6",a.message,e);break}case"emoji":Un(t,Ua.emoji,a.message,e);break;case"ulid":{Un(t,Ua.ulid,a.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Fn(t,"binary",a.message,e);break}case"contentEncoding:base64":{Ze(t,"contentEncoding","base64",a.message,e);break}case"pattern:zod":{Un(t,Ua.base64,a.message,e);break}}break}case"nanoid":Un(t,Ua.nanoid,a.message,e)}return t}const kI=r=>Array.from(r).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Fn=(r,e,t,n)=>{var a;r.format||(a=r.anyOf)!=null&&a.some(o=>o.format)?(r.anyOf||(r.anyOf=[]),r.format&&(r.anyOf.push({format:r.format,...r.errorMessage&&n.errorMessages&&{errorMessage:{format:r.errorMessage.format}}}),delete r.format,r.errorMessage&&(delete r.errorMessage.format,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.anyOf.push({format:e,...t&&n.errorMessages&&{errorMessage:{format:t}}})):Ze(r,"format",e,t,n)},Un=(r,e,t,n)=>{var a;r.pattern||(a=r.allOf)!=null&&a.some(o=>o.pattern)?(r.allOf||(r.allOf=[]),r.pattern&&(r.allOf.push({pattern:r.pattern,...r.errorMessage&&n.errorMessages&&{errorMessage:{pattern:r.errorMessage.pattern}}}),delete r.pattern,r.errorMessage&&(delete r.errorMessage.pattern,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.allOf.push({pattern:Y_(e,n),...t&&n.errorMessages&&{errorMessage:{pattern:t}}})):Ze(r,"pattern",Y_(e,n),t,n)},Y_=(r,e)=>{var f;const t=typeof r=="function"?r():r;if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},a=n.i?t.source.toLowerCase():t.source;let o="",l=!1,c=!1,d=!1;for(let p=0;p<a.length;p++){if(l){o+=a[p],l=!1;continue}if(n.i){if(c){if(a[p].match(/[a-z]/)){d?(o+=a[p],o+=`${a[p-2]}-${a[p]}`.toUpperCase(),d=!1):a[p+1]==="-"&&((f=a[p+2])!=null&&f.match(/[a-z]/))?(o+=a[p],d=!0):o+=`${a[p]}${a[p].toUpperCase()}`;continue}}else if(a[p].match(/[a-z]/)){o+=`[${a[p]}${a[p].toUpperCase()}]`;continue}}if(n.m){if(a[p]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(a[p]==="$"){o+=`($|(?=[\r
]))`;continue}}if(n.s&&a[p]==="."){o+=c?`${a[p]}\r
`:`[${a[p]}\r
]`;continue}o+=a[p],a[p]==="\\"?l=!0:c&&a[p]==="]"?c=!1:!c&&a[p]==="["&&(c=!0)}try{const p=new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return o};function Bx(r,e){var n,a,o,l;if(e.target==="openApi3"&&((n=r.keyType)==null?void 0:n._def.typeName)===H.ZodEnum)return{type:"object",required:r.keyType._def.values,properties:r.keyType._def.values.reduce((c,d)=>({...c,[d]:Be(r.valueType._def,{...e,currentPath:[...e.currentPath,"properties",d]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:Be(r.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((a=r.keyType)==null?void 0:a._def.typeName)===H.ZodString&&((o=r.keyType._def.checks)!=null&&o.length)){const c=Object.entries(zx(r.keyType._def,e)).reduce((d,[f,p])=>f==="type"?d:{...d,[f]:p},{});return{...t,propertyNames:c}}else if(((l=r.keyType)==null?void 0:l._def.typeName)===H.ZodEnum)return{...t,propertyNames:{enum:r.keyType._def.values}};return t}function CI(r,e){if(e.mapStrategy==="record")return Bx(r,e);const t=Be(r.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=Be(r.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,n],minItems:2,maxItems:2}}}function PI(r){const e=r.values,n=Object.keys(r.values).filter(o=>typeof e[e[o]]!="number").map(o=>e[o]),a=Array.from(new Set(n.map(o=>typeof o)));return{type:a.length===1?a[0]==="string"?"string":"number":["string","number"],enum:n}}function RI(){return{not:{}}}function OI(r){return r.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Ac={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function TI(r,e){if(e.target==="openApi3")return eb(r,e);const t=r.options instanceof Map?Array.from(r.options.values()):r.options;if(t.every(n=>n._def.typeName in Ac&&(!n._def.checks||!n._def.checks.length))){const n=t.reduce((a,o)=>{const l=Ac[o._def.typeName];return l&&!a.includes(l)?[...a,l]:a},[]);return{type:n.length>1?n:n[0]}}else if(t.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=t.reduce((a,o)=>{const l=typeof o._def.value;switch(l){case"string":case"number":case"boolean":return[...a,l];case"bigint":return[...a,"integer"];case"object":if(o._def.value===null)return[...a,"null"];case"symbol":case"undefined":case"function":default:return a}},[]);if(n.length===t.length){const a=n.filter((o,l,c)=>c.indexOf(o)===l);return{type:a.length>1?a:a[0],enum:t.reduce((o,l)=>o.includes(l._def.value)?o:[...o,l._def.value],[])}}}else if(t.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((n,a)=>[...n,...a._def.values.filter(o=>!n.includes(o))],[])};return eb(r,e)}const eb=(r,e)=>{const t=(r.options instanceof Map?Array.from(r.options.values()):r.options).map((n,a)=>Be(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${a}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return t.length?{anyOf:t}:void 0};function AI(r,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(r.innerType._def.typeName)&&(!r.innerType._def.checks||!r.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:Ac[r.innerType._def.typeName],nullable:!0}:{type:[Ac[r.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=Be(r.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const t=Be(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function II(r,e){const t={type:"number"};if(!r.checks)return t;for(const n of r.checks)switch(n.kind){case"int":t.type="integer",Fx(t,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?Ze(t,"minimum",n.value,n.message,e):Ze(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),Ze(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?Ze(t,"maximum",n.value,n.message,e):Ze(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),Ze(t,"maximum",n.value,n.message,e));break;case"multipleOf":Ze(t,"multipleOf",n.value,n.message,e);break}return t}function NI(r,e){return e.removeAdditionalStrategy==="strict"?r.catchall._def.typeName==="ZodNever"?r.unknownKeys!=="strict":Be(r.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":Be(r.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function $I(r,e){const t={type:"object",...Object.entries(r.shape()).reduce((n,[a,o])=>{if(o===void 0||o._def===void 0)return n;const l=Be(o._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});return l===void 0?n:{properties:{...n.properties,[a]:l},required:o.isOptional()&&!e.openaiStrictMode?n.required:[...n.required,a]}},{properties:{},required:[]}),additionalProperties:NI(r,e)};return t.required.length||delete t.required,t}const jI=(r,e)=>{var n;if(e.currentPath.toString()===((n=e.propertyPath)==null?void 0:n.toString()))return Be(r.innerType._def,e);const t=Be(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},LI=(r,e)=>{if(e.pipeStrategy==="input")return Be(r.in._def,e);if(e.pipeStrategy==="output")return Be(r.out._def,e);const t=Be(r.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=Be(r.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,n].filter(a=>a!==void 0)}};function MI(r,e){return Be(r.type._def,e)}function DI(r,e){const n={type:"array",uniqueItems:!0,items:Be(r.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return r.minSize&&Ze(n,"minItems",r.minSize.value,r.minSize.message,e),r.maxSize&&Ze(n,"maxItems",r.maxSize.value,r.maxSize.message,e),n}function FI(r,e){return r.rest?{type:"array",minItems:r.items.length,items:r.items.map((t,n)=>Be(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[]),additionalItems:Be(r.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:r.items.length,maxItems:r.items.length,items:r.items.map((t,n)=>Be(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[])}}function UI(){return{not:{}}}function zI(){return{}}const BI=(r,e)=>Be(r.innerType._def,e);function Be(r,e,t=!1){var l;const n=e.seen.get(r);if(e.override){const c=(l=e.override)==null?void 0:l.call(e,r,e,n,t);if(c!==lI)return c}if(n&&!t){const c=HI(n,e);if(c!==void 0)return"$ref"in c&&e.seenRefs.add(c.$ref),c}const a={def:r,path:e.currentPath,jsonSchema:void 0};e.seen.set(r,a);const o=qI(r,r.typeName,e,t);return o&&WI(r,e,o),a.jsonSchema=o,o}const HI=(r,e)=>{switch(e.$refStrategy){case"root":return{$ref:r.path.join("/")};case"extract-to-root":const t=r.path.slice(e.basePath.length+1).join("_");return t!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[t]=r.def),{$ref:[...e.basePath,e.definitionPath,t].join("/")};case"relative":return{$ref:VI(e.currentPath,r.path)};case"none":case"seen":return r.path.length<e.currentPath.length&&r.path.every((n,a)=>e.currentPath[a]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},VI=(r,e)=>{let t=0;for(;t<r.length&&t<e.length&&r[t]===e[t];t++);return[(r.length-t).toString(),...e.slice(t)].join("/")},qI=(r,e,t,n)=>{switch(e){case H.ZodString:return zx(r,t);case H.ZodNumber:return II(r,t);case H.ZodObject:return $I(r,t);case H.ZodBigInt:return pI(r,t);case H.ZodBoolean:return mI();case H.ZodDate:return Ux(r,t);case H.ZodUndefined:return UI();case H.ZodNull:return OI(t);case H.ZodArray:return hI(r,t);case H.ZodUnion:case H.ZodDiscriminatedUnion:return TI(r,t);case H.ZodIntersection:return SI(r,t);case H.ZodTuple:return FI(r,t);case H.ZodRecord:return Bx(r,t);case H.ZodLiteral:return EI(r,t);case H.ZodEnum:return bI(r);case H.ZodNativeEnum:return PI(r);case H.ZodNullable:return AI(r,t);case H.ZodOptional:return jI(r,t);case H.ZodMap:return CI(r,t);case H.ZodSet:return DI(r,t);case H.ZodLazy:return Be(r.getter()._def,t);case H.ZodPromise:return MI(r,t);case H.ZodNaN:case H.ZodNever:return RI();case H.ZodEffects:return _I(r,t,n);case H.ZodAny:return fI();case H.ZodUnknown:return zI();case H.ZodDefault:return wI(r,t);case H.ZodBranded:return gI(r,t);case H.ZodReadonly:return BI(r,t);case H.ZodCatch:return yI(r,t);case H.ZodPipeline:return LI(r,t);case H.ZodFunction:case H.ZodVoid:case H.ZodSymbol:return;default:return(a=>{})()}},WI=(r,e,t)=>(r.description&&(t.description=r.description,e.markdownDescription&&(t.markdownDescription=r.description)),t),ZI=(r,e)=>{const t=dI(e),n=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,a=Be(r._def,n===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,n]},!1)??{},o=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;o!==void 0&&(a.title=o);const l=(()=>{if(cI(t.definitions))return;const d={},f=new Set;for(let p=0;p<500;p++){const y=Object.entries(t.definitions).filter(([g])=>!f.has(g));if(y.length===0)break;for(const[g,w]of y)d[g]=Be(Jp(w),{...t,currentPath:[...t.basePath,t.definitionPath,g]},!0)??{},f.add(g)}return d})(),c=n===void 0?l?{...a,[t.definitionPath]:l}:a:t.nameStrategy==="duplicate-ref"?{...a,...l||t.seenRefs.size?{[t.definitionPath]:{...l,...t.seenRefs.size?{[n]:a}:void 0}}:void 0}:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,n].join("/"),[t.definitionPath]:{...l,[n]:a}};return t.target==="jsonSchema7"?c.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(c.$schema="https://json-schema.org/draft/2019-09/schema#"),c};function Hx(r,e){return ZI(r,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function GI(r,e,t){return XC({type:"json_schema",json_schema:{...t,name:e,strict:!0,schema:Hx(r,{name:e})}},n=>r.parse(JSON.parse(n)))}function JI(r){return QC({type:"function",function:{name:r.name,parameters:Hx(r.parameters,{name:r.name}),strict:!0,...r.description?{description:r.description}:void 0}},{callback:r.function,parser:e=>r.parameters.parse(JSON.parse(e))})}function KI(r){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:t,azureOpenAIApiKey:n,azureOpenAIBasePath:a,baseURL:o,azureADTokenProvider:l,azureOpenAIEndpoint:c}=r;if((n||l)&&a&&e)return`${a}/${e}`;if((n||l)&&c&&e)return`${c}/openai/deployments/${e}`;if(n||l){if(!t)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${t}.openai.azure.com/openai/deployments/${e}`}return o}function XI(r,e){const t=typeof e=="number"?void 0:e;return{name:r.name,description:r.description,parameters:cl(r.schema),...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}}function QI(r){return r!==void 0&&Array.isArray(r.lc_namespace)}function YI(r){return r!==void 0&&Et.isRunnable(r)&&"lc_name"in r.constructor&&typeof r.constructor.lc_name=="function"&&r.constructor.lc_name()==="RunnableToolLike"}function eN(r){return!!r&&typeof r=="object"&&"name"in r&&"schema"in r&&jx(r.schema)}function tN(r){return eN(r)||YI(r)||QI(r)}function qu(r,e){return r.lc_error_code=e,r.message=`${r.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,r}function tb(r){let e;return r.constructor.name===Dc.name?(e=new Error(r.message),e.name="TimeoutError"):r.constructor.name===Pn.name?(e=new Error(r.message),e.name="AbortError"):r.status===400&&r.message.includes("tool_calls")?e=qu(r,"INVALID_TOOL_RESULTS"):r.status===401?e=qu(r,"MODEL_AUTHENTICATION"):r.status===429?e=qu(r,"MODEL_RATE_LIMIT"):r.status===404?e=qu(r,"MODEL_NOT_FOUND"):e=r,e}function nN(r){if(r)return r==="any"||r==="required"?"required":r==="auto"?"auto":r==="none"?"none":typeof r=="string"?{type:"function",function:{name:r}}:r}function rN(r){return r.anyOf!==void 0&&Array.isArray(r.anyOf)}function aN(r){const e=["namespace functions {",""];for(const t of r)t.description&&e.push(`// ${t.description}`),Object.keys(t.parameters.properties??{}).length>0?(e.push(`type ${t.name} = (_: {`),e.push(Vx(t.parameters,0)),e.push("}) => any;")):e.push(`type ${t.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function Vx(r,e){var n;const t=[];for(const[a,o]of Object.entries(r.properties??{}))o.description&&e<2&&t.push(`// ${o.description}`),(n=r.required)!=null&&n.includes(a)?t.push(`${a}: ${Ic(o,e)},`):t.push(`${a}?: ${Ic(o,e)},`);return t.map(a=>" ".repeat(e)+a).join(`
`)}function Ic(r,e){if(rN(r))return r.anyOf.map(t=>Ic(t,e)).join(" | ");switch(r.type){case"string":return r.enum?r.enum.map(t=>`"${t}"`).join(" | "):"string";case"number":return r.enum?r.enum.map(t=>`${t}`).join(" | "):"number";case"integer":return r.enum?r.enum.map(t=>`${t}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",Vx(r,e+2),"}"].join(`
`);case"array":return r.items?`${Ic(r.items,e)}[]`:"any[]";default:return""}}function sN(r,e){let t;if(tN(r)){const n=JI({name:r.name,parameters:r.schema,description:r.description});n.function.parameters?t={type:n.type,function:{name:n.function.name,description:n.function.description,parameters:n.function.parameters,...(e==null?void 0:e.strict)!==void 0?{strict:e.strict}:{}}}:t={type:"function",function:XI(r,e)}}else t=r;return(e==null?void 0:e.strict)!==void 0&&(t.function.strict=e.strict),t}function iN(r){return r.role!=="system"&&r.role!=="assistant"&&r.role!=="user"&&r.role!=="function"&&r.role!=="tool"&&console.warn(`Unknown message role: ${r.role}`),r.role}function qx(r){const e=r._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!al.isInstance(r))throw new Error("Invalid generic chat message");return iN(r)}default:throw new Error(`Unknown message type: ${e}`)}}function oN(r,e,t){const n=r.tool_calls;switch(r.role){case"assistant":{const a=[],o=[];for(const d of n??[])try{a.push(Dx(d,{returnId:!0}))}catch(f){o.push(iI(d,f.message))}const l={function_call:r.function_call,tool_calls:n};t!==void 0&&(l.__raw_response=e);let c;return e.system_fingerprint&&(c={usage:{...e.usage},system_fingerprint:e.system_fingerprint}),r.audio&&(l.audio=r.audio),new No({content:r.content||"",tool_calls:a,invalid_tool_calls:o,additional_kwargs:l,response_metadata:c,id:e.id})}default:return new al(r.content||"",r.role??"unknown")}}function lN(r,e,t,n){var d,f;const a=r.role??t,o=r.content??"";let l;r.function_call?l={function_call:r.function_call}:r.tool_calls?l={tool_calls:r.tool_calls}:l={},n&&(l.__raw_response=e),r.audio&&(l.audio={...r.audio,index:e.choices[0].index});const c={usage:{...e.usage}};if(a==="user")return new qc({content:o,response_metadata:c});if(a==="assistant"){const p=[];if(Array.isArray(r.tool_calls))for(const y of r.tool_calls)p.push({name:(d=y.function)==null?void 0:d.name,args:(f=y.function)==null?void 0:f.arguments,id:y.id,index:y.index,type:"tool_call_chunk"});return new rs({content:o,tool_call_chunks:p,additional_kwargs:l,id:e.id,response_metadata:c})}else return a==="system"?new Wc({content:o,response_metadata:c}):a==="function"?new Vc({content:o,additional_kwargs:l,name:r.name,response_metadata:c}):a==="tool"?new jm({content:o,additional_kwargs:l,tool_call_id:r.tool_call_id,response_metadata:c}):new Hc({content:o,role:a,response_metadata:c})}function nb(r){return r.flatMap(e=>{var n;const t={role:qx(e),content:e.content};if(e.name!=null&&(t.name=e.name),e.additional_kwargs.function_call!=null&&(t.function_call=e.additional_kwargs.function_call,t.content=null),Lm(e)&&((n=e.tool_calls)!=null&&n.length)?(t.tool_calls=e.tool_calls.map(sI),t.content=null):(e.additional_kwargs.tool_calls!=null&&(t.tool_calls=e.additional_kwargs.tool_calls),e.tool_call_id!=null&&(t.tool_call_id=e.tool_call_id)),e.additional_kwargs.audio&&typeof e.additional_kwargs.audio=="object"&&"id"in e.additional_kwargs.audio){const a={role:"assistant",audio:{id:e.additional_kwargs.audio.id}};return[t,a]}return t})}function rb(r,e){return YA(r)?(e==null?void 0:e.strict)!==void 0?{...r,function:{...r.function,strict:e.strict}}:r:sN(r,e)}class uN extends da{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,t){var n,a,o,l,c,d,f,p,y;if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.openAIApiKey)??((n=e==null?void 0:e.configuration)==null?void 0:n.apiKey)??zt("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??zt("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(e==null?void 0:e.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??zt("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(e==null?void 0:e.azureOpenAIApiDeploymentName)??zt("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??zt("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??zt("AZURE_OPENAI_BASE_PATH"),this.organization=((a=e==null?void 0:e.configuration)==null?void 0:a.organization)??zt("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=(e==null?void 0:e.azureOpenAIEndpoint)??zt("AZURE_OPENAI_ENDPOINT"),this.modelName=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.maxTokens=e==null?void 0:e.maxTokens,this.logprobs=e==null?void 0:e.logprobs,this.topLogprobs=e==null?void 0:e.topLogprobs,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.stop=(e==null?void 0:e.stopSequences)??(e==null?void 0:e.stop),this.stopSequences=this==null?void 0:this.stop,this.user=e==null?void 0:e.user,this.__includeRawResponse=e==null?void 0:e.__includeRawResponse,this.audio=e==null?void 0:e.audio,this.modalities=e==null?void 0:e.modalities,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const g=this.azureOpenAIBasePath.split("/openai/deployments/");if(g.length===2){const[,w]=g;this.azureOpenAIApiDeploymentName=w}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.streaming=(e==null?void 0:e.streaming)??!1,this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(t==null?void 0:t.basePath)??((o=e==null?void 0:e.configuration)==null?void 0:o.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((l=t==null?void 0:t.baseOptions)==null?void 0:l.headers)??((d=(c=e==null?void 0:e.configuration)==null?void 0:c.baseOptions)==null?void 0:d.headers),defaultQuery:((f=t==null?void 0:t.baseOptions)==null?void 0:f.params)??((y=(p=e==null?void 0:e.configuration)==null?void 0:p.baseOptions)==null?void 0:y.params),...t,...e==null?void 0:e.configuration},(e==null?void 0:e.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling)}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??void 0,ls_max_tokens:t.max_tokens??void 0,ls_stop:e.stop}}bindTools(e,t){let n;return(t==null?void 0:t.strict)!==void 0?n=t.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling),this.bind({tools:e.map(a=>rb(a,{strict:n})),...t})}createResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&Wu(e.json_schema.schema)?GI(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}invocationParams(e,t){var l;let n;(e==null?void 0:e.strict)!==void 0?n=e.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling);let a={};(e==null?void 0:e.stream_options)!==void 0?a={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||t!=null&&t.streaming)&&(a={stream_options:{include_usage:!0}});const o={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:e==null?void 0:e.functions,function_call:e==null?void 0:e.function_call,tools:(l=e==null?void 0:e.tools)!=null&&l.length?e.tools.map(c=>rb(c,{strict:n})):void 0,tool_choice:nN(e==null?void 0:e.tool_choice),response_format:this.createResponseFormat(e==null?void 0:e.response_format),seed:e==null?void 0:e.seed,...a,parallel_tool_calls:e==null?void 0:e.parallel_tool_calls,...this.audio||e!=null&&e.audio?{audio:this.audio||(e==null?void 0:e.audio)}:{},...this.modalities||e!=null&&e.modalities?{modalities:this.modalities||(e==null?void 0:e.modalities)}:{},...this.modelKwargs};return(e==null?void 0:e.prediction)!==void 0&&(o.prediction=e.prediction),o}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,t,n){var f,p,y,g,w,_,S,b,k,E;const a=nb(e),o={...this.invocationParams(t,{streaming:!0}),messages:a,stream:!0};let l;const c=await this.completionWithRetry(o,t);let d;for await(const P of c){const N=(f=P==null?void 0:P.choices)==null?void 0:f[0];if(P.usage&&(d=P.usage),!N)continue;const{delta:j}=N;if(!j)continue;const D=lN(j,P,l,this.__includeRawResponse);l=j.role??l;const z={prompt:t.promptIndex??0,completion:N.index??0};if(typeof D.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const q={...z};N.finish_reason!=null&&(q.finish_reason=N.finish_reason,q.system_fingerprint=P.system_fingerprint),this.logprobs&&(q.logprobs=N.logprobs);const K=new ai({message:D,text:D.content,generationInfo:q});yield K,await(n==null?void 0:n.handleLLMNewToken(K.text??"",z,void 0,void 0,void 0,{chunk:K}))}if(d){const P={...((p=d.prompt_tokens_details)==null?void 0:p.audio_tokens)!==null&&{audio:(y=d.prompt_tokens_details)==null?void 0:y.audio_tokens},...((g=d.prompt_tokens_details)==null?void 0:g.cached_tokens)!==null&&{cache_read:(w=d.prompt_tokens_details)==null?void 0:w.cached_tokens}},N={...((_=d.completion_tokens_details)==null?void 0:_.audio_tokens)!==null&&{audio:(S=d.completion_tokens_details)==null?void 0:S.audio_tokens},...((b=d.completion_tokens_details)==null?void 0:b.reasoning_tokens)!==null&&{reasoning:(k=d.completion_tokens_details)==null?void 0:k.reasoning_tokens}};yield new ai({message:new rs({content:"",response_metadata:{usage:{...d}},usage_metadata:{input_tokens:d.prompt_tokens,output_tokens:d.completion_tokens,total_tokens:d.total_tokens,...Object.keys(P).length>0&&{input_token_details:P},...Object.keys(N).length>0&&{output_token_details:N}}}),text:""})}if((E=t.signal)!=null&&E.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(e,t,n){var c,d;const a={},o=this.invocationParams(t),l=nb(e);if(o.stream){const f=this._streamResponseChunks(e,t,n),p={};for await(const b of f){b.message.response_metadata={...b.generationInfo,...b.message.response_metadata};const k=((c=b.generationInfo)==null?void 0:c.completion)??0;p[k]===void 0?p[k]=b:p[k]=p[k].concat(b)}const y=Object.entries(p).sort(([b],[k])=>parseInt(b,10)-parseInt(k,10)).map(([b,k])=>k),{functions:g,function_call:w}=this.invocationParams(t),_=await this.getEstimatedTokenCountFromPrompt(e,g,w),S=await this.getNumTokensFromGenerations(y);return a.input_tokens=_,a.output_tokens=S,a.total_tokens=_+S,{generations:y,llmOutput:{estimatedTokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}else{let f;t.response_format&&t.response_format.type==="json_schema"?f=await this.betaParsedCompletionWithRetry({...o,stream:!1,messages:l},{signal:t==null?void 0:t.signal,...t==null?void 0:t.options}):f=await this.completionWithRetry({...o,stream:!1,messages:l},{signal:t==null?void 0:t.signal,...t==null?void 0:t.options});const{completion_tokens:p,prompt_tokens:y,total_tokens:g,prompt_tokens_details:w,completion_tokens_details:_}=(f==null?void 0:f.usage)??{};p&&(a.output_tokens=(a.output_tokens??0)+p),y&&(a.input_tokens=(a.input_tokens??0)+y),g&&(a.total_tokens=(a.total_tokens??0)+g),((w==null?void 0:w.audio_tokens)!==null||(w==null?void 0:w.cached_tokens)!==null)&&(a.input_token_details={...(w==null?void 0:w.audio_tokens)!==null&&{audio:w==null?void 0:w.audio_tokens},...(w==null?void 0:w.cached_tokens)!==null&&{cache_read:w==null?void 0:w.cached_tokens}}),((_==null?void 0:_.audio_tokens)!==null||(_==null?void 0:_.reasoning_tokens)!==null)&&(a.output_token_details={...(_==null?void 0:_.audio_tokens)!==null&&{audio:_==null?void 0:_.audio_tokens},...(_==null?void 0:_.reasoning_tokens)!==null&&{reasoning:_==null?void 0:_.reasoning_tokens}});const S=[];for(const b of(f==null?void 0:f.choices)??[]){const E={text:((d=b.message)==null?void 0:d.content)??"",message:oN(b.message??{role:"assistant"},f,this.__includeRawResponse)};E.generationInfo={...b.finish_reason?{finish_reason:b.finish_reason}:{},...b.logprobs?{logprobs:b.logprobs}:{}},Lm(E.message)&&(E.message.usage_metadata=a),E.message=new No({...E.message}),S.push(E)}return{generations:S,llmOutput:{tokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(e,t,n){let a=(await this.getNumTokensFromMessages(e)).totalCount;if(t&&n!=="auto"){const o=aN(t);a+=await this.getNumTokens(o),a+=9}return t&&e.find(o=>o._getType()==="system")&&(a-=4),n==="none"?a+=1:typeof n=="object"&&(a+=await this.getNumTokens(n.name)+4),a}async getNumTokensFromGenerations(e){return(await Promise.all(e.map(async n=>{var a;return(a=n.message.additional_kwargs)!=null&&a.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)}))).reduce((n,a)=>n+a,0)}async getNumTokensFromMessages(e){let t=0,n=0,a=0;this.model==="gpt-3.5-turbo-0301"?(n=4,a=-1):(n=3,a=1);const o=await Promise.all(e.map(async l=>{var g,w,_,S,b,k;const c=await this.getNumTokens(l.content),d=await this.getNumTokens(qx(l)),f=l.name!==void 0?a+await this.getNumTokens(l.name):0;let p=c+n+d+f;const y=l;if(y._getType()==="function"&&(p-=2),(g=y.additional_kwargs)!=null&&g.function_call&&(p+=3),(w=y==null?void 0:y.additional_kwargs.function_call)!=null&&w.name&&(p+=await this.getNumTokens((_=y.additional_kwargs.function_call)==null?void 0:_.name)),(S=y.additional_kwargs.function_call)!=null&&S.arguments)try{p+=await this.getNumTokens(JSON.stringify(JSON.parse((b=y.additional_kwargs.function_call)==null?void 0:b.arguments)))}catch(E){console.error("Error parsing function arguments",E,JSON.stringify(y.additional_kwargs.function_call)),p+=await this.getNumTokens((k=y.additional_kwargs.function_call)==null?void 0:k.arguments)}return t+=p,p}));return t+=3,{totalCount:t,countPerMessage:o}}async completionWithRetry(e,t){const n=this._getClientOptions(t);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,n)}catch(a){throw tb(a)}})}async betaParsedCompletionWithRetry(e,t){const n=this._getClientOptions(t);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(e,n)}catch(a){throw tb(a)}})}_getClientOptions(e){if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},a=KI(n),o={...this.clientConfig,baseURL:a,timeout:this.timeout,maxRetries:0};o.baseURL||delete o.baseURL,this.client=new De(o)}const t={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.query={"api-version":this.azureOpenAIApiVersion,...t.query}),t}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((t,n)=>(n&&n.tokenUsage&&(t.tokenUsage.completionTokens+=n.tokenUsage.completionTokens??0,t.tokenUsage.promptTokens+=n.tokenUsage.promptTokens??0,t.tokenUsage.totalTokens+=n.tokenUsage.totalTokens??0),t),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,t){let n,a,o,l;cN(e)?(n=e.schema,a=e.name,o=e.method,l=e.includeRaw):(n=e,a=t==null?void 0:t.name,o=t==null?void 0:t.method,l=t==null?void 0:t.includeRaw);let c,d;if((t==null?void 0:t.strict)!==void 0&&o==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(o==="jsonMode")c=this.bind({response_format:{type:"json_object"}}),Wu(n)?d=J_.fromZodSchema(n):d=new K_;else if(o==="jsonSchema")c=this.bind({response_format:{type:"json_schema",json_schema:{name:a??"extract",description:n.description,schema:n,strict:t==null?void 0:t.strict}}}),Wu(n)?d=J_.fromZodSchema(n):d=new K_;else{let g=a??"extract";if(Wu(n)){const w=cl(n);c=this.bind({tools:[{type:"function",function:{name:g,description:w.description,parameters:w}}],tool_choice:{type:"function",function:{name:g}},...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}),d=new X_({returnSingle:!0,keyName:g,zodSchema:n})}else{let w;typeof n.name=="string"&&typeof n.parameters=="object"&&n.parameters!=null?(w=n,g=n.name):(g=n.title??g,w={name:g,description:n.description??"",parameters:n}),c=this.bind({tools:[{type:"function",function:w}],tool_choice:{type:"function",function:{name:g}},...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}),d=new X_({returnSingle:!0,keyName:g})}}if(!l)return c.pipe(d);const f=Tc.assign({parsed:(g,w)=>d.invoke(g.raw,w)}),p=Tc.assign({parsed:()=>null}),y=f.withFallbacks({fallbacks:[p]});return Ar.from([{raw:c},y])}}function Wu(r){return typeof(r==null?void 0:r.parse)=="function"}function cN(r){return r!==void 0&&typeof r.schema=="object"}class dN{constructor(e,t,n,a,o,l){Sr(this,"model");this.model=new uN({openAIApiKey:e,modelName:t,temperature:n,presencePenalty:a,frequencyPenalty:o,topP:l})}async generateResponse(e,t){try{const n=[new J0(e),...t.map(o=>{switch(o.role){case"user":return new sl(o.content);case"assistant":return new No(o.content);default:throw new Error(`Unknown message role: ${o.role}`)}})];return(await this.model.invoke(n)).content.toString()}catch(n){throw console.error("Error generating response:",n),n}}}function fN(){const[r,e]=R.useState(""),[t,n]=R.useState([]),[a,o]=R.useState(null),[l,c]=R.useState(""),[d,f]=R.useState(Au.experts[0]),p=R.useRef(null),y=R.useRef(null),g=R.useRef(null),w=5*60*1e3;R.useEffect(()=>{const E=localStorage.getItem("chats"),P=localStorage.getItem("openai_api_key"),N=localStorage.getItem("selected_expert_id");if(E&&n(JSON.parse(E)),P&&c(P),N){const j=Au.experts.find(D=>D.id===N);j&&f(j)}},[]),R.useEffect(()=>{l&&d&&(g.current=new dN(l,d.model,d.temperature,d.presence_penalty,d.frequency_penalty,d.top_p))},[l,d]),R.useEffect(()=>{const E=async()=>{if(a&&!a.problemResolved&&Date.now()-a.lastActivity>=w){const N={role:"assistant",content:"Я заметил, что прошло некоторое время с нашего последнего взаимодействия. Удалось ли решить вашу проблему? Если нет, я готов продолжить помогать.",timestamp:Date.now()},j={...a,messages:[...a.messages,N]};n(D=>{const z=D.map(q=>q.id===a.id?j:q);return localStorage.setItem("chats",JSON.stringify(z)),z}),o(j)}};return y.current&&clearTimeout(y.current),a&&!a.problemResolved&&(y.current=setTimeout(E,w)),()=>{y.current&&clearTimeout(y.current)}},[a,w]);const _=()=>{if(!d)return;const E={id:Date.now().toString(),expertId:d.id,messages:[],createdAt:new Date().toISOString(),title:`Чат с ${d.name} ${new Date().toLocaleString()}`,lastActivity:Date.now(),problemResolved:!1};n(P=>{const N=[E,...P];return localStorage.setItem("chats",JSON.stringify(N)),N}),o(E)},S=E=>{const P=Au.experts.find(N=>N.id===E);P&&(f(P),localStorage.setItem("selected_expert_id",P.id),o(null))},b=async E=>{if(!a)return;const P={role:"user",content:E?"Да, моя проблема решена. Спасибо!":"Нет, мне всё ещё нужна помощь.",timestamp:Date.now()},N={...a,messages:[...a.messages,P],lastActivity:Date.now(),problemResolved:E};if(n(j=>{const D=j.map(z=>z.id===a.id?N:z);return localStorage.setItem("chats",JSON.stringify(D)),D}),o(N),!E){const j={role:"assistant",content:"Понятно. Давайте продолжим работу над вашей проблемой. Что именно осталось нерешённым?",timestamp:Date.now()},D={...N,messages:[...N.messages,j]};n(z=>{const q=z.map(K=>K.id===a.id?D:K);return localStorage.setItem("chats",JSON.stringify(q)),q}),o(D)}};R.useEffect(()=>{p.current&&(p.current.style.height="auto",p.current.style.height=p.current.scrollHeight+"px")},[r]);const k=async()=>{if(!r.trim()||!l||!d||!g.current)return;const E=a?{...a,lastActivity:Date.now()}:{id:Date.now().toString(),expertId:d.id,messages:[],createdAt:new Date().toISOString(),title:`Чат с ${d.name} ${new Date().toLocaleString()}`,lastActivity:Date.now(),problemResolved:!1},P={role:"user",content:r,timestamp:Date.now()};E.messages=[...E.messages,P];try{a?(n(z=>{const q=z.map(K=>K.id===a.id?E:K);return localStorage.setItem("chats",JSON.stringify(q)),q}),o(E)):(n(z=>{const q=[E,...z];return localStorage.setItem("chats",JSON.stringify(q)),q}),o(E));const j={role:"assistant",content:await g.current.generateResponse(d.systemPrompt,E.messages),timestamp:Date.now()},D={...E,messages:[...E.messages,j],lastActivity:Date.now()};n(z=>{const q=z.map(K=>K.id===D.id?D:K);return localStorage.setItem("chats",JSON.stringify(q)),q}),o(D)}catch(N){console.error("Error:",N)}e("")};return l?I.jsxs("div",{className:"flex h-screen",children:[I.jsxs("div",{className:"w-64 bg-gray-100 border-r border-gray-200 p-4",children:[I.jsx("div",{className:"mb-4",children:I.jsx("select",{value:d.id,onChange:E=>S(E.target.value),className:"w-full p-2 border rounded",children:Au.experts.map(E=>I.jsx("option",{value:E.id,children:E.name},E.id))})}),I.jsx("button",{onClick:_,className:"w-full bg-blue-500 text-white rounded-lg px-4 py-2 mb-4 hover:bg-blue-600",children:"Новый чат"}),I.jsx(lc,{className:"h-[calc(100vh-200px)]",children:I.jsx("div",{className:"space-y-2",children:t.filter(E=>E.expertId===d.id).map(E=>I.jsxs("div",{onClick:()=>o(E),className:`p-2 rounded-lg cursor-pointer ${(a==null?void 0:a.id)===E.id?"bg-blue-100":"hover:bg-gray-200"}`,children:[I.jsx("div",{className:"text-sm font-medium truncate",children:E.title}),I.jsx("div",{className:"text-xs text-gray-500",children:new Date(E.createdAt).toLocaleDateString()}),E.problemResolved&&I.jsx("div",{className:"text-xs text-green-500",children:"Решено ✓"})]},E.id))})})]}),I.jsxs("div",{className:"flex-1 flex flex-col",children:[I.jsx(lc,{className:"flex-1 p-4",children:I.jsx("div",{className:"space-y-4",children:a==null?void 0:a.messages.map((E,P)=>I.jsx("div",{className:E.role==="user"?"flex justify-end":"flex justify-start",children:I.jsxs("div",{className:`p-4 rounded-lg relative max-w-[80%] ${E.role==="user"?"bg-blue-100":"bg-gray-100"}`,children:[I.jsx("div",{className:"mb-1",children:E.content}),I.jsx("div",{className:"text-xs text-gray-500 mt-1 text-right",children:E.timestamp?new Date(E.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}),E.role==="assistant"&&E.content.includes("Удалось ли решить вашу проблему?")&&!a.problemResolved&&I.jsxs("div",{className:"mt-2 flex space-x-2",children:[I.jsx("button",{onClick:()=>b(!0),className:"px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"Да, решено"}),I.jsx("button",{onClick:()=>b(!1),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Нет, нужна помощь"})]})]})},P))})}),I.jsx("div",{className:"border-t border-gray-200 p-4",children:I.jsxs("div",{className:"flex space-x-4",children:[I.jsx("textarea",{ref:p,value:r,onChange:E=>e(E.target.value),onKeyDown:E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),k())},placeholder:"Введите сообщение...",className:"flex-1 resize-none border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:1}),I.jsx("button",{onClick:k,className:"bg-blue-500 text-white rounded-lg px-6 py-2 hover:bg-blue-600",children:"Отправить"})]})})]})]}):I.jsx("div",{className:"flex items-center justify-center h-screen",children:I.jsxs("div",{className:"w-96 p-6 bg-white rounded-lg shadow-lg",children:[I.jsx("h2",{className:"text-xl font-bold mb-4",children:"Введите API ключ OpenAI"}),I.jsx("input",{type:"password",value:l,onChange:E=>{c(E.target.value),localStorage.setItem("openai_api_key",E.target.value)},placeholder:"sk-...",className:"w-full p-2 border rounded mb-4"})]})})}function Wx(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var a=r.length;for(e=0;e<a;e++)r[e]&&(t=Wx(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Zx(){for(var r,e,t=0,n="",a=arguments.length;t<a;t++)(r=arguments[t])&&(e=Wx(r))&&(n&&(n+=" "),n+=e);return n}const Km="-",hN=r=>{const e=mN(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:l=>{const c=l.split(Km);return c[0]===""&&c.length!==1&&c.shift(),Gx(c,e)||pN(l)},getConflictingClassGroupIds:(l,c)=>{const d=t[l]||[];return c&&n[l]?[...d,...n[l]]:d}}},Gx=(r,e)=>{var l;if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),a=n?Gx(r.slice(1),n):void 0;if(a)return a;if(e.validators.length===0)return;const o=r.join(Km);return(l=e.validators.find(({validator:c})=>c(o)))==null?void 0:l.classGroupId},ab=/^\[(.+)\]$/,pN=r=>{if(ab.test(r)){const e=ab.exec(r)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},mN=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return yN(Object.entries(r.classGroups),t).forEach(([o,l])=>{Kp(l,n,o,e)}),n},Kp=(r,e,t,n)=>{r.forEach(a=>{if(typeof a=="string"){const o=a===""?e:sb(e,a);o.classGroupId=t;return}if(typeof a=="function"){if(gN(a)){Kp(a(n),e,t,n);return}e.validators.push({validator:a,classGroupId:t});return}Object.entries(a).forEach(([o,l])=>{Kp(l,sb(e,o),t,n)})})},sb=(r,e)=>{let t=r;return e.split(Km).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},gN=r=>r.isThemeGetter,yN=(r,e)=>e?r.map(([t,n])=>{const a=n.map(o=>typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([l,c])=>[e+l,c])):o);return[t,a]}):r,vN=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const a=(o,l)=>{t.set(o,l),e++,e>r&&(e=0,n=t,t=new Map)};return{get(o){let l=t.get(o);if(l!==void 0)return l;if((l=n.get(o))!==void 0)return a(o,l),l},set(o,l){t.has(o)?t.set(o,l):a(o,l)}}},Jx="!",wN=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,a=e[0],o=e.length,l=c=>{const d=[];let f=0,p=0,y;for(let b=0;b<c.length;b++){let k=c[b];if(f===0){if(k===a&&(n||c.slice(b,b+o)===e)){d.push(c.slice(p,b)),p=b+o;continue}if(k==="/"){y=b;continue}}k==="["?f++:k==="]"&&f--}const g=d.length===0?c:c.substring(p),w=g.startsWith(Jx),_=w?g.substring(1):g,S=y&&y>p?y-p:void 0;return{modifiers:d,hasImportantModifier:w,baseClassName:_,maybePostfixModifierPosition:S}};return t?c=>t({className:c,parseClassName:l}):l},_N=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},bN=r=>({cache:vN(r.cacheSize),parseClassName:wN(r),...hN(r)}),xN=/\s+/,SN=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:a}=e,o=[],l=r.trim().split(xN);let c="";for(let d=l.length-1;d>=0;d-=1){const f=l[d],{modifiers:p,hasImportantModifier:y,baseClassName:g,maybePostfixModifierPosition:w}=t(f);let _=!!w,S=n(_?g.substring(0,w):g);if(!S){if(!_){c=f+(c.length>0?" "+c:c);continue}if(S=n(g),!S){c=f+(c.length>0?" "+c:c);continue}_=!1}const b=_N(p).join(":"),k=y?b+Jx:b,E=k+S;if(o.includes(E))continue;o.push(E);const P=a(S,_);for(let N=0;N<P.length;++N){const j=P[N];o.push(k+j)}c=f+(c.length>0?" "+c:c)}return c};function EN(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=Kx(e))&&(n&&(n+=" "),n+=t);return n}const Kx=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=Kx(r[n]))&&(t&&(t+=" "),t+=e);return t};function kN(r,...e){let t,n,a,o=l;function l(d){const f=e.reduce((p,y)=>y(p),r());return t=bN(f),n=t.cache.get,a=t.cache.set,o=c,c(d)}function c(d){const f=n(d);if(f)return f;const p=SN(d,t);return a(d,p),p}return function(){return o(EN.apply(null,arguments))}}const et=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},Xx=/^\[(?:([a-z-]+):)?(.+)\]$/i,CN=/^\d+\/\d+$/,PN=new Set(["px","full","screen"]),RN=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ON=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,TN=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,AN=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,IN=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Cr=r=>Xs(r)||PN.has(r)||CN.test(r),la=r=>yi(r,"length",UN),Xs=r=>!!r&&!Number.isNaN(Number(r)),gp=r=>yi(r,"number",Xs),fo=r=>!!r&&Number.isInteger(Number(r)),NN=r=>r.endsWith("%")&&Xs(r.slice(0,-1)),Pe=r=>Xx.test(r),ua=r=>RN.test(r),$N=new Set(["length","size","percentage"]),jN=r=>yi(r,$N,Qx),LN=r=>yi(r,"position",Qx),MN=new Set(["image","url"]),DN=r=>yi(r,MN,BN),FN=r=>yi(r,"",zN),ho=()=>!0,yi=(r,e,t)=>{const n=Xx.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},UN=r=>ON.test(r)&&!TN.test(r),Qx=()=>!1,zN=r=>AN.test(r),BN=r=>IN.test(r),HN=()=>{const r=et("colors"),e=et("spacing"),t=et("blur"),n=et("brightness"),a=et("borderColor"),o=et("borderRadius"),l=et("borderSpacing"),c=et("borderWidth"),d=et("contrast"),f=et("grayscale"),p=et("hueRotate"),y=et("invert"),g=et("gap"),w=et("gradientColorStops"),_=et("gradientColorStopPositions"),S=et("inset"),b=et("margin"),k=et("opacity"),E=et("padding"),P=et("saturate"),N=et("scale"),j=et("sepia"),D=et("skew"),z=et("space"),q=et("translate"),K=()=>["auto","contain","none"],oe=()=>["auto","hidden","clip","visible","scroll"],he=()=>["auto",Pe,e],me=()=>[Pe,e],Ue=()=>["",Cr,la],Y=()=>["auto",Xs,Pe],G=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ne=()=>["solid","dashed","dotted","double","none"],Q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],B=()=>["start","end","center","between","around","evenly","stretch"],F=()=>["","0",Pe],V=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>[Xs,Pe];return{cacheSize:500,separator:":",theme:{colors:[ho],spacing:[Cr,la],blur:["none","",ua,Pe],brightness:O(),borderColor:[r],borderRadius:["none","","full",ua,Pe],borderSpacing:me(),borderWidth:Ue(),contrast:O(),grayscale:F(),hueRotate:O(),invert:F(),gap:me(),gradientColorStops:[r],gradientColorStopPositions:[NN,la],inset:he(),margin:he(),opacity:O(),padding:me(),saturate:O(),scale:O(),sepia:F(),skew:O(),space:me(),translate:me()},classGroups:{aspect:[{aspect:["auto","square","video",Pe]}],container:["container"],columns:[{columns:[ua]}],"break-after":[{"break-after":V()}],"break-before":[{"break-before":V()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...G(),Pe]}],overflow:[{overflow:oe()}],"overflow-x":[{"overflow-x":oe()}],"overflow-y":[{"overflow-y":oe()}],overscroll:[{overscroll:K()}],"overscroll-x":[{"overscroll-x":K()}],"overscroll-y":[{"overscroll-y":K()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[S]}],"inset-x":[{"inset-x":[S]}],"inset-y":[{"inset-y":[S]}],start:[{start:[S]}],end:[{end:[S]}],top:[{top:[S]}],right:[{right:[S]}],bottom:[{bottom:[S]}],left:[{left:[S]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",fo,Pe]}],basis:[{basis:he()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Pe]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",fo,Pe]}],"grid-cols":[{"grid-cols":[ho]}],"col-start-end":[{col:["auto",{span:["full",fo,Pe]},Pe]}],"col-start":[{"col-start":Y()}],"col-end":[{"col-end":Y()}],"grid-rows":[{"grid-rows":[ho]}],"row-start-end":[{row:["auto",{span:[fo,Pe]},Pe]}],"row-start":[{"row-start":Y()}],"row-end":[{"row-end":Y()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Pe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Pe]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...B()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...B(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...B(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[E]}],px:[{px:[E]}],py:[{py:[E]}],ps:[{ps:[E]}],pe:[{pe:[E]}],pt:[{pt:[E]}],pr:[{pr:[E]}],pb:[{pb:[E]}],pl:[{pl:[E]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[z]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[z]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Pe,e]}],"min-w":[{"min-w":[Pe,e,"min","max","fit"]}],"max-w":[{"max-w":[Pe,e,"none","full","min","max","fit","prose",{screen:[ua]},ua]}],h:[{h:[Pe,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Pe,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Pe,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Pe,e,"auto","min","max","fit"]}],"font-size":[{text:["base",ua,la]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",gp]}],"font-family":[{font:[ho]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Pe]}],"line-clamp":[{"line-clamp":["none",Xs,gp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Cr,Pe]}],"list-image":[{"list-image":["none",Pe]}],"list-style-type":[{list:["none","disc","decimal",Pe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[k]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[k]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ne(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Cr,la]}],"underline-offset":[{"underline-offset":["auto",Cr,Pe]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:me()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Pe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Pe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[k]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...G(),LN]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",jN]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},DN]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[_]}],"gradient-via-pos":[{via:[_]}],"gradient-to-pos":[{to:[_]}],"gradient-from":[{from:[w]}],"gradient-via":[{via:[w]}],"gradient-to":[{to:[w]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[k]}],"border-style":[{border:[...ne(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[k]}],"divide-style":[{divide:ne()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...ne()]}],"outline-offset":[{"outline-offset":[Cr,Pe]}],"outline-w":[{outline:[Cr,la]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:Ue()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[k]}],"ring-offset-w":[{"ring-offset":[Cr,la]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",ua,FN]}],"shadow-color":[{shadow:[ho]}],opacity:[{opacity:[k]}],"mix-blend":[{"mix-blend":[...Q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Q()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",ua,Pe]}],grayscale:[{grayscale:[f]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[y]}],saturate:[{saturate:[P]}],sepia:[{sepia:[j]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[f]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[y]}],"backdrop-opacity":[{"backdrop-opacity":[k]}],"backdrop-saturate":[{"backdrop-saturate":[P]}],"backdrop-sepia":[{"backdrop-sepia":[j]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Pe]}],duration:[{duration:O()}],ease:[{ease:["linear","in","out","in-out",Pe]}],delay:[{delay:O()}],animate:[{animate:["none","spin","ping","pulse","bounce",Pe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[fo,Pe]}],"translate-x":[{"translate-x":[q]}],"translate-y":[{"translate-y":[q]}],"skew-x":[{"skew-x":[D]}],"skew-y":[{"skew-y":[D]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Pe]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Pe]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":me()}],"scroll-mx":[{"scroll-mx":me()}],"scroll-my":[{"scroll-my":me()}],"scroll-ms":[{"scroll-ms":me()}],"scroll-me":[{"scroll-me":me()}],"scroll-mt":[{"scroll-mt":me()}],"scroll-mr":[{"scroll-mr":me()}],"scroll-mb":[{"scroll-mb":me()}],"scroll-ml":[{"scroll-ml":me()}],"scroll-p":[{"scroll-p":me()}],"scroll-px":[{"scroll-px":me()}],"scroll-py":[{"scroll-py":me()}],"scroll-ps":[{"scroll-ps":me()}],"scroll-pe":[{"scroll-pe":me()}],"scroll-pt":[{"scroll-pt":me()}],"scroll-pr":[{"scroll-pr":me()}],"scroll-pb":[{"scroll-pb":me()}],"scroll-pl":[{"scroll-pl":me()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Pe]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Cr,la,gp]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},VN=kN(HN);function gn(...r){return VN(Zx(r))}const ib=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,ob=Zx,qN=(r,e)=>t=>{var n;if((e==null?void 0:e.variants)==null)return ob(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:a,defaultVariants:o}=e,l=Object.keys(a).map(f=>{const p=t==null?void 0:t[f],y=o==null?void 0:o[f];if(p===null)return null;const g=ib(p)||ib(y);return a[f][g]}),c=t&&Object.entries(t).reduce((f,p)=>{let[y,g]=p;return g===void 0||(f[y]=g),f},{}),d=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((f,p)=>{let{class:y,className:g,...w}=p;return Object.entries(w).every(_=>{let[S,b]=_;return Array.isArray(b)?b.includes({...o,...c}[S]):{...o,...c}[S]===b})?[...f,y,g]:f},[]);return ob(r,l,d,t==null?void 0:t.class,t==null?void 0:t.className)},WN=qN("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),rc=R.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...a},o)=>{const l=n?im:"button";return I.jsx(l,{className:gn(WN({variant:e,size:t,className:r})),ref:o,...a})});rc.displayName="Button";const Or=R.forwardRef(({className:r,type:e,...t},n)=>I.jsx("input",{type:e,className:gn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:n,...t}));Or.displayName="Input";const Xp=R.forwardRef(({className:r,...e},t)=>I.jsx("textarea",{className:gn("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...e}));Xp.displayName="Textarea";const Qp=R.forwardRef(({className:r,children:e,...t},n)=>I.jsxs(Fb,{ref:n,className:gn("relative overflow-hidden",r),...t,children:[I.jsx(lC,{className:"h-full w-full rounded-[inherit]",children:e}),I.jsx(Yx,{}),I.jsx(uC,{})]}));Qp.displayName=Fb.displayName;const Yx=R.forwardRef(({className:r,orientation:e="vertical",...t},n)=>I.jsx(lm,{ref:n,orientation:e,className:gn("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...t,children:I.jsx($b,{className:"relative flex-1 rounded-full bg-border"})}));Yx.displayName=lm.displayName;function ZN({prop:r,defaultProp:e,onChange:t=()=>{}}){const[n,a]=GN({defaultProp:e,onChange:t}),o=r!==void 0,l=o?r:n,c=Tr(t),d=R.useCallback(f=>{if(o){const y=typeof f=="function"?f(r):f;y!==r&&c(y)}else a(f)},[o,r,a,c]);return[l,d]}function GN({defaultProp:r,onChange:e}){const t=R.useState(r),[n]=t,a=R.useRef(n),o=Tr(e);return R.useEffect(()=>{a.current!==n&&(o(n),a.current=n)},[n,a,o]),t}function JN(r){const e=R.useRef({value:r,previous:r});return R.useMemo(()=>(e.current.value!==r&&(e.current.previous=e.current.value,e.current.value=r),e.current.previous),[r])}function KN(r){const[e,t]=R.useState(void 0);return oc(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let l,c;if("borderBoxSize"in o){const d=o.borderBoxSize,f=Array.isArray(d)?d[0]:d;l=f.inlineSize,c=f.blockSize}else l=r.offsetWidth,c=r.offsetHeight;t({width:l,height:c})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var Xm="Checkbox",[XN,tj]=Pb(Xm),[QN,YN]=XN(Xm),eS=R.forwardRef((r,e)=>{const{__scopeCheckbox:t,name:n,checked:a,defaultChecked:o,required:l,disabled:c,value:d="on",onCheckedChange:f,form:p,...y}=r,[g,w]=R.useState(null),_=xa(e,N=>w(N)),S=R.useRef(!1),b=g?p||!!g.closest("form"):!0,[k=!1,E]=ZN({prop:a,defaultProp:o,onChange:f}),P=R.useRef(k);return R.useEffect(()=>{const N=g==null?void 0:g.form;if(N){const j=()=>E(P.current);return N.addEventListener("reset",j),()=>N.removeEventListener("reset",j)}},[g,E]),I.jsxs(QN,{scope:t,state:k,disabled:c,children:[I.jsx(ts.button,{type:"button",role:"checkbox","aria-checked":pa(k)?"mixed":k,"aria-required":l,"data-state":rS(k),"data-disabled":c?"":void 0,disabled:c,value:d,...y,ref:_,onKeyDown:Nr(r.onKeyDown,N=>{N.key==="Enter"&&N.preventDefault()}),onClick:Nr(r.onClick,N=>{E(j=>pa(j)?!0:!j),b&&(S.current=N.isPropagationStopped(),S.current||N.stopPropagation())})}),b&&I.jsx(e$,{control:g,bubbles:!S.current,name:n,value:d,checked:k,required:l,disabled:c,form:p,style:{transform:"translateX(-100%)"},defaultChecked:pa(o)?!1:o})]})});eS.displayName=Xm;var tS="CheckboxIndicator",nS=R.forwardRef((r,e)=>{const{__scopeCheckbox:t,forceMount:n,...a}=r,o=YN(tS,t);return I.jsx(oi,{present:n||pa(o.state)||o.state===!0,children:I.jsx(ts.span,{"data-state":rS(o.state),"data-disabled":o.disabled?"":void 0,...a,ref:e,style:{pointerEvents:"none",...r.style}})})});nS.displayName=tS;var e$=r=>{const{control:e,checked:t,bubbles:n=!0,defaultChecked:a,...o}=r,l=R.useRef(null),c=JN(t),d=KN(e);R.useEffect(()=>{const p=l.current,y=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(y,"checked").set;if(c!==t&&w){const _=new Event("click",{bubbles:n});p.indeterminate=pa(t),w.call(p,pa(t)?!1:t),p.dispatchEvent(_)}},[c,t,n]);const f=R.useRef(pa(t)?!1:t);return I.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??f.current,...o,tabIndex:-1,ref:l,style:{...r.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function pa(r){return r==="indeterminate"}function rS(r){return pa(r)?"indeterminate":r?"checked":"unchecked"}var aS=eS,t$=nS;/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n$=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sS=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var r$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a$=R.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:l,...c},d)=>R.createElement("svg",{ref:d,...r$,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:sS("lucide",a),...c},[...l.map(([f,p])=>R.createElement(f,p)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fl=(r,e)=>{const t=R.forwardRef(({className:n,...a},o)=>R.createElement(a$,{ref:o,iconNode:e,className:sS(`lucide-${n$(r)}`,n),...a}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s$=fl("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i$=fl("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o$=fl("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l$=fl("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=fl("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),ac=R.forwardRef(({className:r,...e},t)=>I.jsx(aS,{ref:t,className:gn("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...e,children:I.jsx(t$,{className:gn("flex items-center justify-center text-current"),children:I.jsx(s$,{className:"h-4 w-4"})})}));ac.displayName=aS.displayName;const iS=R.forwardRef(({className:r,...e},t)=>I.jsx("div",{ref:t,className:gn("rounded-lg border bg-card text-card-foreground shadow-sm",r),...e}));iS.displayName="Card";const u$=R.forwardRef(({className:r,...e},t)=>I.jsx("div",{ref:t,className:gn("flex flex-col space-y-1.5 p-6",r),...e}));u$.displayName="CardHeader";const c$=R.forwardRef(({className:r,...e},t)=>I.jsx("h3",{ref:t,className:gn("text-2xl font-semibold leading-none tracking-tight",r),...e}));c$.displayName="CardTitle";const d$=R.forwardRef(({className:r,...e},t)=>I.jsx("p",{ref:t,className:gn("text-sm text-muted-foreground",r),...e}));d$.displayName="CardDescription";const f$=R.forwardRef(({className:r,...e},t)=>I.jsx("div",{ref:t,className:gn("p-6 pt-0",r),...e}));f$.displayName="CardContent";const h$=R.forwardRef(({className:r,...e},t)=>I.jsx("div",{ref:t,className:gn("flex items-center p-6 pt-0",r),...e}));h$.displayName="CardFooter";var p$=r=>{switch(r){case"success":return y$;case"info":return w$;case"warning":return v$;case"error":return _$;default:return null}},m$=Array(12).fill(0),g$=({visible:r,className:e})=>ae.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":r},ae.createElement("div",{className:"sonner-spinner"},m$.map((t,n)=>ae.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),y$=ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ae.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),v$=ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ae.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),w$=ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ae.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),_$=ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ae.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),b$=ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ae.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ae.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),x$=()=>{let[r,e]=ae.useState(document.hidden);return ae.useEffect(()=>{let t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),r},Yp=1,S$=class{constructor(){this.subscribe=r=>(this.subscribers.push(r),()=>{let e=this.subscribers.indexOf(r);this.subscribers.splice(e,1)}),this.publish=r=>{this.subscribers.forEach(e=>e(r))},this.addToast=r=>{this.publish(r),this.toasts=[...this.toasts,r]},this.create=r=>{var e;let{message:t,...n}=r,a=typeof(r==null?void 0:r.id)=="number"||((e=r.id)==null?void 0:e.length)>0?r.id:Yp++,o=this.toasts.find(c=>c.id===a),l=r.dismissible===void 0?!0:r.dismissible;return o?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...r,id:a,title:t}),{...c,...r,id:a,dismissible:l,title:t}):c):this.addToast({title:t,...n,dismissible:l,id:a}),a},this.dismiss=r=>(r||this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:r,dismiss:!0})),r),this.message=(r,e)=>this.create({...e,message:r}),this.error=(r,e)=>this.create({...e,message:r,type:"error"}),this.success=(r,e)=>this.create({...e,type:"success",message:r}),this.info=(r,e)=>this.create({...e,type:"info",message:r}),this.warning=(r,e)=>this.create({...e,type:"warning",message:r}),this.loading=(r,e)=>this.create({...e,type:"loading",message:r}),this.promise=(r,e)=>{if(!e)return;let t;e.loading!==void 0&&(t=this.create({...e,promise:r,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let n=r instanceof Promise?r:r(),a=t!==void 0,o,l=n.then(async d=>{if(o=["resolve",d],ae.isValidElement(d))a=!1,this.create({id:t,type:"default",message:d});else if(k$(d)&&!d.ok){a=!1;let f=typeof e.error=="function"?await e.error(`HTTP error! status: ${d.status}`):e.error,p=typeof e.description=="function"?await e.description(`HTTP error! status: ${d.status}`):e.description;this.create({id:t,type:"error",message:f,description:p})}else if(e.success!==void 0){a=!1;let f=typeof e.success=="function"?await e.success(d):e.success,p=typeof e.description=="function"?await e.description(d):e.description;this.create({id:t,type:"success",message:f,description:p})}}).catch(async d=>{if(o=["reject",d],e.error!==void 0){a=!1;let f=typeof e.error=="function"?await e.error(d):e.error,p=typeof e.description=="function"?await e.description(d):e.description;this.create({id:t,type:"error",message:f,description:p})}}).finally(()=>{var d;a&&(this.dismiss(t),t=void 0),(d=e.finally)==null||d.call(e)}),c=()=>new Promise((d,f)=>l.then(()=>o[0]==="reject"?f(o[1]):d(o[1])).catch(f));return typeof t!="string"&&typeof t!="number"?{unwrap:c}:Object.assign(t,{unwrap:c})},this.custom=(r,e)=>{let t=(e==null?void 0:e.id)||Yp++;return this.create({jsx:r(t),id:t,...e}),t},this.subscribers=[],this.toasts=[]}},dn=new S$,E$=(r,e)=>{let t=(e==null?void 0:e.id)||Yp++;return dn.addToast({title:r,...e,id:t}),t},k$=r=>r&&typeof r=="object"&&"ok"in r&&typeof r.ok=="boolean"&&"status"in r&&typeof r.status=="number",C$=E$,P$=()=>dn.toasts,yp=Object.assign(C$,{success:dn.success,info:dn.info,warning:dn.warning,error:dn.error,custom:dn.custom,message:dn.message,promise:dn.promise,dismiss:dn.dismiss,loading:dn.loading},{getHistory:P$});function R$(r,{insertAt:e}={}){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=r:n.appendChild(document.createTextNode(r))}R$(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Zu(r){return r.label!==void 0}var O$=3,T$="32px",ub=4e3,A$=356,I$=14,N$=20,$$=200;function j$(...r){return r.filter(Boolean).join(" ")}var L$=r=>{var e,t,n,a,o,l,c,d,f,p,y;let{invert:g,toast:w,unstyled:_,interacting:S,setHeights:b,visibleToasts:k,heights:E,index:P,toasts:N,expanded:j,removeToast:D,defaultRichColors:z,closeButton:q,style:K,cancelButtonStyle:oe,actionButtonStyle:he,className:me="",descriptionClassName:Ue="",duration:Y,position:G,gap:ne,loadingIcon:Q,expandByDefault:B,classNames:F,icons:V,closeButtonAriaLabel:O="Close toast",pauseWhenPageIsHidden:$,cn:J}=r,[re,ie]=ae.useState(!1),[xe,ve]=ae.useState(!1),[Ie,Le]=ae.useState(!1),[nt,yn]=ae.useState(!1),[hl,Sa]=ae.useState(!1),[vi,as]=ae.useState(0),[pl,ss]=ae.useState(0),Ea=ae.useRef(w.duration||Y||ub),is=ae.useRef(null),tn=ae.useRef(null),Mr=P===0,wi=P+1<=k,Mt=w.type,pr=w.dismissible!==!1,ml=w.className||"",gl=w.descriptionClassName||"",Dr=ae.useMemo(()=>E.findIndex(Se=>Se.toastId===w.id)||0,[E,w.id]),os=ae.useMemo(()=>{var Se;return(Se=w.closeButton)!=null?Se:q},[w.closeButton,q]);ae.useMemo(()=>w.duration||Y||ub,[w.duration,Y]);let ls=ae.useRef(0),vn=ae.useRef(0),Fr=ae.useRef(0),us=ae.useRef(null),[yl,vl]=G.split("-"),wl=ae.useMemo(()=>E.reduce((Se,je,Ke)=>Ke>=Dr?Se:Se+je.height,0),[E,Dr]),cs=x$(),_i=w.invert||g,ka=Mt==="loading";vn.current=ae.useMemo(()=>Dr*ne+wl,[Dr,wl]),ae.useEffect(()=>{ie(!0)},[]),ae.useEffect(()=>{let Se=tn.current;if(Se){let je=Se.getBoundingClientRect().height;return ss(je),b(Ke=>[{toastId:w.id,height:je,position:w.position},...Ke]),()=>b(Ke=>Ke.filter(qt=>qt.toastId!==w.id))}},[b,w.id]),ae.useLayoutEffect(()=>{if(!re)return;let Se=tn.current,je=Se.style.height;Se.style.height="auto";let Ke=Se.getBoundingClientRect().height;Se.style.height=je,ss(Ke),b(qt=>qt.find(nn=>nn.toastId===w.id)?qt.map(nn=>nn.toastId===w.id?{...nn,height:Ke}:nn):[{toastId:w.id,height:Ke,position:w.position},...qt])},[re,w.title,w.description,b,w.id]);let wn=ae.useCallback(()=>{ve(!0),as(vn.current),b(Se=>Se.filter(je=>je.toastId!==w.id)),setTimeout(()=>{D(w)},$$)},[w,D,b,vn]);ae.useEffect(()=>{if(w.promise&&Mt==="loading"||w.duration===1/0||w.type==="loading")return;let Se;return j||S||$&&cs?(()=>{if(Fr.current<ls.current){let je=new Date().getTime()-ls.current;Ea.current=Ea.current-je}Fr.current=new Date().getTime()})():Ea.current!==1/0&&(ls.current=new Date().getTime(),Se=setTimeout(()=>{var je;(je=w.onAutoClose)==null||je.call(w,w),wn()},Ea.current)),()=>clearTimeout(Se)},[j,S,w,Mt,$,cs,wn]),ae.useEffect(()=>{w.delete&&wn()},[wn,w.delete]);function bi(){var Se,je,Ke;return V!=null&&V.loading?ae.createElement("div",{className:J(F==null?void 0:F.loader,(Se=w==null?void 0:w.classNames)==null?void 0:Se.loader,"sonner-loader"),"data-visible":Mt==="loading"},V.loading):Q?ae.createElement("div",{className:J(F==null?void 0:F.loader,(je=w==null?void 0:w.classNames)==null?void 0:je.loader,"sonner-loader"),"data-visible":Mt==="loading"},Q):ae.createElement(g$,{className:J(F==null?void 0:F.loader,(Ke=w==null?void 0:w.classNames)==null?void 0:Ke.loader),visible:Mt==="loading"})}return ae.createElement("li",{tabIndex:0,ref:tn,className:J(me,ml,F==null?void 0:F.toast,(e=w==null?void 0:w.classNames)==null?void 0:e.toast,F==null?void 0:F.default,F==null?void 0:F[Mt],(t=w==null?void 0:w.classNames)==null?void 0:t[Mt]),"data-sonner-toast":"","data-rich-colors":(n=w.richColors)!=null?n:z,"data-styled":!(w.jsx||w.unstyled||_),"data-mounted":re,"data-promise":!!w.promise,"data-swiped":hl,"data-removed":xe,"data-visible":wi,"data-y-position":yl,"data-x-position":vl,"data-index":P,"data-front":Mr,"data-swiping":Ie,"data-dismissible":pr,"data-type":Mt,"data-invert":_i,"data-swipe-out":nt,"data-expanded":!!(j||B&&re),style:{"--index":P,"--toasts-before":P,"--z-index":N.length-P,"--offset":`${xe?vi:vn.current}px`,"--initial-height":B?"auto":`${pl}px`,...K,...w.style},onPointerDown:Se=>{ka||!pr||(is.current=new Date,as(vn.current),Se.target.setPointerCapture(Se.pointerId),Se.target.tagName!=="BUTTON"&&(Le(!0),us.current={x:Se.clientX,y:Se.clientY}))},onPointerUp:()=>{var Se,je,Ke,qt;if(nt||!pr)return;us.current=null;let nn=Number(((Se=tn.current)==null?void 0:Se.style.getPropertyValue("--swipe-amount").replace("px",""))||0),ds=new Date().getTime()-((je=is.current)==null?void 0:je.getTime()),_l=Math.abs(nn)/ds;if(Math.abs(nn)>=N$||_l>.11){as(vn.current),(Ke=w.onDismiss)==null||Ke.call(w,w),wn(),yn(!0),Sa(!1);return}(qt=tn.current)==null||qt.style.setProperty("--swipe-amount","0px"),Le(!1)},onPointerMove:Se=>{var je,Ke,qt;if(!us.current||!pr)return;let nn=Se.clientY-us.current.y,ds=((je=window.getSelection())==null?void 0:je.toString().length)>0;Number(((Ke=tn.current)==null?void 0:Ke.style.getPropertyValue("--swipe-amount").replace("px",""))||0)>0&&Sa(!0),!ds&&((qt=tn.current)==null||qt.style.setProperty("--swipe-amount",`${Math.max(0,nn)}px`))}},os&&!w.jsx?ae.createElement("button",{"aria-label":O,"data-disabled":ka,"data-close-button":!0,onClick:ka||!pr?()=>{}:()=>{var Se;wn(),(Se=w.onDismiss)==null||Se.call(w,w)},className:J(F==null?void 0:F.closeButton,(a=w==null?void 0:w.classNames)==null?void 0:a.closeButton)},(o=V==null?void 0:V.close)!=null?o:b$):null,w.jsx||ae.isValidElement(w.title)?w.jsx?w.jsx:typeof w.title=="function"?w.title():w.title:ae.createElement(ae.Fragment,null,Mt||w.icon||w.promise?ae.createElement("div",{"data-icon":"",className:J(F==null?void 0:F.icon,(l=w==null?void 0:w.classNames)==null?void 0:l.icon)},w.promise||w.type==="loading"&&!w.icon?w.icon||bi():null,w.type!=="loading"?w.icon||(V==null?void 0:V[Mt])||p$(Mt):null):null,ae.createElement("div",{"data-content":"",className:J(F==null?void 0:F.content,(c=w==null?void 0:w.classNames)==null?void 0:c.content)},ae.createElement("div",{"data-title":"",className:J(F==null?void 0:F.title,(d=w==null?void 0:w.classNames)==null?void 0:d.title)},typeof w.title=="function"?w.title():w.title),w.description?ae.createElement("div",{"data-description":"",className:J(Ue,gl,F==null?void 0:F.description,(f=w==null?void 0:w.classNames)==null?void 0:f.description)},typeof w.description=="function"?w.description():w.description):null),ae.isValidElement(w.cancel)?w.cancel:w.cancel&&Zu(w.cancel)?ae.createElement("button",{"data-button":!0,"data-cancel":!0,style:w.cancelButtonStyle||oe,onClick:Se=>{var je,Ke;Zu(w.cancel)&&pr&&((Ke=(je=w.cancel).onClick)==null||Ke.call(je,Se),wn())},className:J(F==null?void 0:F.cancelButton,(p=w==null?void 0:w.classNames)==null?void 0:p.cancelButton)},w.cancel.label):null,ae.isValidElement(w.action)?w.action:w.action&&Zu(w.action)?ae.createElement("button",{"data-button":!0,"data-action":!0,style:w.actionButtonStyle||he,onClick:Se=>{var je,Ke;Zu(w.action)&&((Ke=(je=w.action).onClick)==null||Ke.call(je,Se),!Se.defaultPrevented&&wn())},className:J(F==null?void 0:F.actionButton,(y=w==null?void 0:w.classNames)==null?void 0:y.actionButton)},w.action.label):null))};function cb(){if(typeof window>"u"||typeof document>"u")return"ltr";let r=document.documentElement.getAttribute("dir");return r==="auto"||!r?window.getComputedStyle(document.documentElement).direction:r}R.forwardRef(function(r,e){let{invert:t,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:o,closeButton:l,className:c,offset:d,theme:f="light",richColors:p,duration:y,style:g,visibleToasts:w=O$,toastOptions:_,dir:S=cb(),gap:b=I$,loadingIcon:k,icons:E,containerAriaLabel:P="Notifications",pauseWhenPageIsHidden:N,cn:j=j$}=r,[D,z]=ae.useState([]),q=ae.useMemo(()=>Array.from(new Set([n].concat(D.filter($=>$.position).map($=>$.position)))),[D,n]),[K,oe]=ae.useState([]),[he,me]=ae.useState(!1),[Ue,Y]=ae.useState(!1),[G,ne]=ae.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Q=ae.useRef(null),B=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),F=ae.useRef(null),V=ae.useRef(!1),O=ae.useCallback($=>{z(J=>{var re;return(re=J.find(ie=>ie.id===$.id))!=null&&re.delete||dn.dismiss($.id),J.filter(({id:ie})=>ie!==$.id)})},[]);return ae.useEffect(()=>dn.subscribe($=>{if($.dismiss){z(J=>J.map(re=>re.id===$.id?{...re,delete:!0}:re));return}setTimeout(()=>{Mk.flushSync(()=>{z(J=>{let re=J.findIndex(ie=>ie.id===$.id);return re!==-1?[...J.slice(0,re),{...J[re],...$},...J.slice(re+1)]:[$,...J]})})})}),[]),ae.useEffect(()=>{if(f!=="system"){ne(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ne("dark"):ne("light")),typeof window>"u")return;let $=window.matchMedia("(prefers-color-scheme: dark)");try{$.addEventListener("change",({matches:J})=>{ne(J?"dark":"light")})}catch{$.addListener(({matches:re})=>{try{ne(re?"dark":"light")}catch(ie){console.error(ie)}})}},[f]),ae.useEffect(()=>{D.length<=1&&me(!1)},[D]),ae.useEffect(()=>{let $=J=>{var re,ie;a.every(xe=>J[xe]||J.code===xe)&&(me(!0),(re=Q.current)==null||re.focus()),J.code==="Escape"&&(document.activeElement===Q.current||(ie=Q.current)!=null&&ie.contains(document.activeElement))&&me(!1)};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[a]),ae.useEffect(()=>{if(Q.current)return()=>{F.current&&(F.current.focus({preventScroll:!0}),F.current=null,V.current=!1)}},[Q.current]),ae.createElement("section",{"aria-label":`${P} ${B}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false"},q.map(($,J)=>{var re;let[ie,xe]=$.split("-");return D.length?ae.createElement("ol",{key:$,dir:S==="auto"?cb():S,tabIndex:-1,ref:Q,className:c,"data-sonner-toaster":!0,"data-theme":G,"data-y-position":ie,"data-lifted":he&&D.length>1&&!o,"data-x-position":xe,style:{"--front-toast-height":`${((re=K[0])==null?void 0:re.height)||0}px`,"--offset":typeof d=="number"?`${d}px`:d||T$,"--width":`${A$}px`,"--gap":`${b}px`,...g},onBlur:ve=>{V.current&&!ve.currentTarget.contains(ve.relatedTarget)&&(V.current=!1,F.current&&(F.current.focus({preventScroll:!0}),F.current=null))},onFocus:ve=>{ve.target instanceof HTMLElement&&ve.target.dataset.dismissible==="false"||V.current||(V.current=!0,F.current=ve.relatedTarget)},onMouseEnter:()=>me(!0),onMouseMove:()=>me(!0),onMouseLeave:()=>{Ue||me(!1)},onPointerDown:ve=>{ve.target instanceof HTMLElement&&ve.target.dataset.dismissible==="false"||Y(!0)},onPointerUp:()=>Y(!1)},D.filter(ve=>!ve.position&&J===0||ve.position===$).map((ve,Ie)=>{var Le,nt;return ae.createElement(L$,{key:ve.id,icons:E,index:Ie,toast:ve,defaultRichColors:p,duration:(Le=_==null?void 0:_.duration)!=null?Le:y,className:_==null?void 0:_.className,descriptionClassName:_==null?void 0:_.descriptionClassName,invert:t,visibleToasts:w,closeButton:(nt=_==null?void 0:_.closeButton)!=null?nt:l,interacting:Ue,position:$,style:_==null?void 0:_.style,unstyled:_==null?void 0:_.unstyled,classNames:_==null?void 0:_.classNames,cancelButtonStyle:_==null?void 0:_.cancelButtonStyle,actionButtonStyle:_==null?void 0:_.actionButtonStyle,removeToast:O,toasts:D.filter(yn=>yn.position==ve.position),heights:K.filter(yn=>yn.position==ve.position),setHeights:oe,expandByDefault:o,gap:b,loadingIcon:k,expanded:he,pauseWhenPageIsHidden:N,cn:j})})):null}))});function M$(){const[r,e]=R.useState({id:"",model:"gpt-4o-mini",temperature:.7,presence_penalty:.6,frequency_penalty:.5,top_p:.9,name:"",description:"",systemPrompt:"",capabilities:{webBrowsing:!1,imageGeneration:!1,codeInterpreter:!1}}),[t,n]=R.useState([]),[a,o]=R.useState([]),[l,c]=R.useState("");R.useEffect(()=>{fetch("/config/experts.json").then(g=>g.json()).then(g=>{if(g.experts&&g.experts.length>0){const w=g.experts[0];e(_=>({..._,...w,capabilities:{..._.capabilities,...w.capabilities||{}}}))}}).catch(g=>{console.error("Error loading experts config:",g)})},[]);const d=g=>{g.target.files&&n(Array.from(g.target.files))},f=g=>{n(t.filter((w,_)=>_!==g))},p=()=>{if(l.trim()){const g={role:"user",content:l.trim()};o([...a,g]),c(""),setTimeout(()=>{const w={role:"assistant",content:`This is a simulated response from ${r.name||"the assistant"}.`};o(_=>[..._,w])},1e3)}},y=async()=>{try{(await fetch("/api/saveConfig",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({expert:r})})).ok?yp.success("Конфигурация сохранена"):yp.error("Ошибка при сохранении")}catch(g){console.error("Error saving config:",g),yp.error("Ошибка при сохранении")}};return I.jsxs("div",{className:"flex h-screen bg-background",children:[I.jsx("div",{className:"w-1/2 border-r",children:I.jsx(Qp,{className:"h-full px-6 py-4",children:I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"flex justify-between items-center",children:[I.jsx("div",{className:"w-20 h-20 bg-blue-500 rounded-full flex items-center justify-center",children:I.jsx(lb,{className:"w-10 h-10 text-white"})}),I.jsx(rc,{onClick:y,children:"Сохранить конфигурацию"})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsx("h2",{className:"text-lg font-semibold",children:"Конфигурация"}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("label",{className:"text-sm font-medium",children:"Имя"}),I.jsx(Or,{value:r.name,onChange:g=>e({...r,name:g.target.value}),placeholder:"Название вашего GPT"})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("label",{className:"text-sm font-medium",children:"Описание"}),I.jsx(Xp,{value:r.description,onChange:g=>e({...r,description:g.target.value}),placeholder:"Краткое описание возможностей вашего GPT",rows:3})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("label",{className:"text-sm font-medium",children:"Системный промпт"}),I.jsx(Xp,{value:r.systemPrompt,onChange:g=>e({...r,systemPrompt:g.target.value}),placeholder:"Системный промпт для вашего GPT",rows:6})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("label",{className:"text-sm font-medium",children:"Параметры модели"}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"text-xs text-muted-foreground",children:"Модель"}),I.jsx(Or,{value:r.model,onChange:g=>e({...r,model:g.target.value}),placeholder:"Название модели"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"text-xs text-muted-foreground",children:"Temperature"}),I.jsx(Or,{type:"number",value:r.temperature,onChange:g=>e({...r,temperature:parseFloat(g.target.value)}),placeholder:"0 - 1",min:"0",max:"1",step:"0.1"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"text-xs text-muted-foreground",children:"Presence Penalty"}),I.jsx(Or,{type:"number",value:r.presence_penalty,onChange:g=>e({...r,presence_penalty:parseFloat(g.target.value)}),placeholder:"0 - 1",min:"0",max:"1",step:"0.1"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"text-xs text-muted-foreground",children:"Frequency Penalty"}),I.jsx(Or,{type:"number",value:r.frequency_penalty,onChange:g=>e({...r,frequency_penalty:parseFloat(g.target.value)}),placeholder:"0 - 1",min:"0",max:"1",step:"0.1"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"text-xs text-muted-foreground",children:"Top P"}),I.jsx(Or,{type:"number",value:r.top_p,onChange:g=>e({...r,top_p:parseFloat(g.target.value)}),placeholder:"0 - 1",min:"0",max:"1",step:"0.1"})]})]})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("label",{className:"text-sm font-medium",children:"Знания"}),I.jsx("p",{className:"text-sm text-muted-foreground",children:"Если вы загружаете файлы в разделе «Знания», обсуждения с вашим GPT могут включать в себя содержимое файлов."}),I.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[t.map((g,w)=>I.jsxs("div",{className:"flex items-center justify-between bg-muted p-2 rounded",children:[I.jsx("span",{className:"text-sm truncate",children:g.name}),I.jsx(rc,{type:"button",variant:"ghost",size:"sm",onClick:()=>f(w),children:I.jsx(l$,{className:"h-4 w-4"})})]},w)),I.jsx("div",{className:"flex justify-center",children:I.jsxs("label",{className:"cursor-pointer",children:[I.jsx(Or,{type:"file",className:"hidden",onChange:d,multiple:!0}),I.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground",children:[I.jsx(o$,{className:"h-4 w-4"}),I.jsx("span",{children:"Загрузить файлы"})]})]})})]})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("label",{className:"text-sm font-medium",children:"Возможности"}),I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx(ac,{id:"webBrowsing",checked:r.capabilities.webBrowsing,onCheckedChange:g=>e({...r,capabilities:{...r.capabilities,webBrowsing:g}})}),I.jsx("div",{className:"grid gap-1.5 leading-none",children:I.jsx("label",{htmlFor:"webBrowsing",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Поиск в сети"})})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx(ac,{id:"imageGeneration",checked:r.capabilities.imageGeneration,onCheckedChange:g=>e({...r,capabilities:{...r.capabilities,imageGeneration:g}})}),I.jsx("div",{className:"grid gap-1.5 leading-none",children:I.jsx("label",{htmlFor:"imageGeneration",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Генерация изображений DALL-E"})})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx(ac,{id:"codeInterpreter",checked:r.capabilities.codeInterpreter,onCheckedChange:g=>e({...r,capabilities:{...r.capabilities,codeInterpreter:g}})}),I.jsx("div",{className:"grid gap-1.5 leading-none",children:I.jsx("label",{htmlFor:"codeInterpreter",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Интерпретатор кода и анализ данных"})})]})]})]})]})]})})}),I.jsxs("div",{className:"w-1/2 bg-zinc-900 flex flex-col",children:[I.jsx("div",{className:"p-4 border-b border-zinc-800",children:I.jsx("h2",{className:"text-lg font-semibold text-white",children:"Предварительный просмотр"})}),I.jsx("div",{className:"flex-1 p-4 flex flex-col",children:I.jsxs(iS,{className:"flex-1 bg-zinc-800 border-zinc-700 flex flex-col",children:[I.jsxs("div",{className:"p-4 border-b border-zinc-700 flex items-center gap-3",children:[I.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center",children:I.jsx(lb,{className:"w-5 h-5 text-white"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"font-semibold text-white",children:r.name||"Название GPT"}),I.jsx("p",{className:"text-sm text-zinc-400",children:r.description||"Описание вашего GPT"})]})]}),I.jsx(Qp,{className:"flex-1 p-4",children:I.jsx("div",{className:"space-y-4",children:a.map((g,w)=>I.jsx("div",{className:`flex ${g.role==="user"?"justify-end":"justify-start"}`,children:I.jsx("div",{className:`rounded-lg px-4 py-2 max-w-[80%] ${g.role==="user"?"bg-blue-500 text-white":"bg-zinc-700 text-zinc-100"}`,children:g.content})},w))})}),I.jsx("div",{className:"p-4 border-t border-zinc-700",children:I.jsxs("div",{className:"flex gap-2",children:[I.jsx(Or,{value:l,onChange:g=>c(g.target.value),placeholder:"Введите сообщение...",className:"flex-1 bg-zinc-700 border-zinc-600 text-white",onKeyPress:g=>{g.key==="Enter"&&p()}}),I.jsx(rc,{onClick:p,size:"icon",children:I.jsx(i$,{className:"h-4 w-4"})})]})})]})})]})]})}function D$(){return I.jsx(M$,{})}function F$(){return I.jsx(Ck,{children:I.jsxs("div",{className:"min-h-screen bg-background",children:[I.jsx("nav",{className:"border-b p-4",children:I.jsxs("div",{className:"container mx-auto flex justify-between items-center",children:[I.jsx(ic,{to:"/",className:"text-xl font-bold",children:"LibreExpert"}),I.jsx(ic,{to:"/settings",className:"text-sm text-muted-foreground hover:text-foreground",children:"Настройки"})]})}),I.jsxs(nk,{children:[I.jsx(wp,{path:"/",element:I.jsx(fN,{})}),I.jsx(wp,{path:"/settings",element:I.jsx(D$,{})})]})]})})}c1.createRoot(document.getElementById("root")).render(I.jsx(R.StrictMode,{children:I.jsx(F$,{})}));
